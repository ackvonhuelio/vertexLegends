<!DOCTYPE html>
<!--Credit to vexcess for pjs in html -->



<html>

<head>
	<meta charset="utf-8">
	<title>Vertex Legends</title>
	<style>
		body {
			/*gets ride of scroll bars*/
			overflow: hidden;
			/*makes the canvas flush with the edge of the screen*/
			margin: 0%;

			
			font-size: 30px;

			background-color: white;

			text-align: center;
		}
	</style>
</head>

<body>
	<script id="PJS_code" type="data" data-width="window.innerWidth" data-height="window.innerHeight">
	
		console.clear();
{


var clicked = false;
var held = false;
var db = !true;



var accessibilityPrompt = false;
if(width===600 && height===600){
accessibilityPrompt = true;
}
var accessibilityScene = 'initial';

if(width < 600 || height < 600){
    throw {message:'The minimum width and height for this game are 600x600.'};
}

var monospace = createFont('monospace');
function quadAlt(q,w,e,r,t,y,u,i,logoCount){
quad(q+logoCount,w-logoCount,e-logoCount,r-logoCount,t+logoCount,y+logoCount,u+logoCount,i-logoCount);
}
function quadAlt2(q,w,e,r,t,y,u,i,logoCount){
quad(q-logoCount,w-logoCount,e+logoCount,r-logoCount,t-logoCount,y+logoCount,u-logoCount,i-logoCount);
}
function logo(x,y,s,c){
pushMatrix();
translate(x,y);
scale(s);
scale(1,-1);
noStroke();
fill(209, 52, 52);
pushMatrix();
translate(0,-160);
rotate(-6+c/10);
translate(0,160);
quadAlt(0,-160,150,160,100,230,-50,-90,c);
quadAlt(100,230,15,130,104,140,150,160,c);
popMatrix();
pushMatrix();
translate(0,-160);
rotate(6-c/10);
translate(0,160);
quadAlt2(0,-160,-150,160,-100,230,50,-90,c);
quadAlt2(-100,230,-15,130,-104,140,-150,160,c);
popMatrix();



popMatrix();
}
textFont(monospace);
function accessibilityPage(){
background(130, 130, 130);
logo(width/2,height/2,1,0);
noStroke();
fill(130,130,130,150);
rect(-100,-100,width+200,height+200);
switch(accessibilityScene){

case 'initial':
{
fill(0,0,0);
textAlign(CENTER,BASELINE);
textSize(40);
text('Wait! Before you play:',width/2,60);
textSize(30);
text('This game has been designed\nto be playable with a variety\nof different canvas sizes.',width/2,160);
textSize(20);
text('A larger canvas typically\nresults in a much more\nenjoyable experience.',width/2,300);
textSize(47);
text('Switch canvas sizes?',width/2,435);

stroke(0,0,0);

if(mouseX > width/2-250 && mouseX < width/2-50 && mouseY > 480 && mouseY < 570){
strokeWeight(6);
fill(219, 219, 219);
cursor(HAND);
if(clicked){
accessibilityScene = 'option';
}
}else{
strokeWeight(5);
fill(168, 168, 168);
}
rect(width/2-250,480,200,90,2);


if(mouseX > width/2+50 && mouseX < width/2+250 && mouseY > 480 && mouseY < 570){
strokeWeight(6);
fill(219, 219, 219);
cursor(HAND);
if(clicked){
accessibilityPrompt = false;
}
}else{
strokeWeight(5);
fill(168, 168, 168);
}
rect(width/2+50,480,200,90,2);

noStroke();

fill(0,0,0);
textSize(47);
text('Yes',width/2-150,545);
text('No',width/2+150,545);
}
break;
case 'option':
{
fill(0,0,0);
textAlign(CENTER,BASELINE);
textSize(40);
text('Options for Canvas:',width/2,100);
textSize(20);
text('Click Fullscreen for the link to the\nfullscreen github version of this game',width/2,200);
textSize(20);
text('Click Custom for instructions\non how to alter your canvas using the URL',width/2,300);
textSize(47);
text('Switch canvas sizes?',width/2,435);

stroke(0,0,0);

if(mouseX > width/2-250 && mouseX < width/2-50 && mouseY > 480 && mouseY < 570){
strokeWeight(6);
fill(219, 219, 219);
cursor(HAND);
if(clicked){
println('FULLSCREEN GITHUB LINK:\n\nhttps://ackvonhuelio.github.io/ackyoubetterupdatethislinksoon\n\n');
}
}else{
strokeWeight(5);
fill(168, 168, 168);
}
rect(width/2-250,480,200,90,2);


if(mouseX > width/2+50 && mouseX < width/2+250 && mouseY > 480 && mouseY < 570){
strokeWeight(6);
fill(219, 219, 219);
cursor(HAND);
if(clicked){
println('HOW TO ADD CUSTOM CANVAS SIZE:\n\nadd ?width=NUMBER&height=NUMBER&editor=no to the end of the URL for this website.\nReplace NUMBER with your custom canvas sizes.\n(minimum 600x600)\n\n');
}
}else{
strokeWeight(5);
fill(168, 168, 168);
}
rect(width/2+50,480,200,90,2);

noStroke();

fill(0,0,0);
textSize(28);
text('Fullscreen',width/2-150,538);
text('Custom',width/2+150,538);
}
break;
}
}



// WASD to move, space to attack, numbers for weapons

// change for different controls
var keyBinds = {
    upDir:87,
    leftDir:65,
    downDir:83,
    rightDir:68,
    weapons:[49,50,51,52,53,54],
    autopilot:79,
    //powers:[90,88,67,86,66,78,77],
    togglePowerUp:81,
    togglePowerDown:69,
    
    
    attack:32,
    usePower:"click",
    
};


// Decrease if loading crashes your computer
var loadRep = 10;

// increase if pathfinding crashes the game
var pathfindingInt = 100;


// (function() {return this;})().LoopProtector.prototype.leave = function() {};



var scene = 'home';
var getActualMouse;
var standardAiOff = 17;
var bg;
var gameSet;
function effect(){}
function worty(x,y,size,angle,emotion){
        pushMatrix();
        translate(x,y);
        scale(size/3);
        rotate(angle);
        noStroke();
        fill(100,100,100,150);
        ellipse(0,250-200,195,20);
        fill(21, 207, 0);
        ellipse(26.7,200-200,90,90);
        arc(197-170,246-200,200,182,-180,-90);
        fill(0, 0, 0);
        ellipse(179-170,169-200,10,10);
        ellipse(229-170,170-200,10,10);
        fill(21,207,0);
        stroke(0, 0, 0);
        strokeWeight(1);
        arc(223-170,242-200,70,15,-60,161);
        fill(157, 255, 0);
        noStroke();
        ellipse(204-170,210-200,84,70);
        rect(162-170,205-200,84,41,5);
        fill(21,207,0);
        strokeWeight(1);
        stroke(0,0,0);
        arc(118-170,229-200,70,50,-80,14);
        arc(140-170,244-200,70,20,-110,185);
        strokeWeight(10);
        if(emotion === 0){
            line(170-170,155-200,185-170,155-200);
            line(225-170,155-200,235-170,155-200);
            strokeWeight(1);
            stroke(0, 0, 0);
            arc(179-170,167-200,15,10,-180,0);
            arc(229-170,168-200,15,10,-180,0);
            strokeWeight(1);
            noFill();
            arc(204-170,186-200,60,20,-180,0);
        }
        if(emotion === 1){
            line(170-170,155-200,185-165,155-198);
            line(225-175,155-198,235-170,155-200);
            strokeWeight(1);
            stroke(0, 0, 0);
            arc(179-170,167-200,15,10,-180,20);
            arc(229-170,168-200,15,10,-200,0);
            strokeWeight(1);
            noFill();
            arc(204-168,186-196,60,30,-180,0);
        }
        if(emotion === 2){
            strokeWeight(10);
            line(170-170,155-200,185-170,155-210);
            line(225-170,155-210,235-170,155-200);
            strokeWeight(1);
            noFill();
            arc(204-170,186-200,60,20,-180,0);
        }
        if(emotion === 3){
            strokeWeight(10);
            line(170-170,155-200,185-170,155-200);
            line(225-170,155-200,235-170,155-200);
            strokeWeight(1);
            stroke(0, 0, 0);
            arc(179-170,167-198,15,10,-180,0);
            arc(229-170,168-198,15,10,-180,0);
            strokeWeight(1);
            fill(242, 242, 242);
            arc(205-171,186-211,64,36,0,180);
            line(62,-17,6,-17);
        }
        if(emotion === 5){
            strokeWeight(10);
            line(170-170,152,185-169,159);
            line(225-173,159,235-170,152);
            strokeWeight(1);
            stroke(0, 0, 0);
            arc(179-170,167-198,15,10,-180,0);
            arc(229-170,168-198,15,10,-180,0);
            strokeWeight(1);
            fill(242, 242, 242);
            arc(205-171,186-211,64,36,0,180);
            line(62,-17,6,-17);
                   
        }
        
        popMatrix();
 
 }
function doPlayerGraphics(){}
function cycle(n,e,p){

if(round(((frameCount+p+e.rand)/n)*n)/n === round((round((frameCount+p+e.rand)/n))*n)/n){
return true;
}
}
function choice(e) {
    return arguments[floor(random(0, arguments.length))];
}
var weapons = [
    ['iron sword',
    {
    anim: 'thrust',
    damage: 44,
    cooldown: 30,
    reach: 43,
    sweep: 30,
    knockback: 8.5,
    abilities: [],
    swingDuration: 0,
    aiDist: 43 + standardAiOff,
    hbDis: {x:14,y:558,rot:-15},
    }],
    ['iron greatsword',
    {
    anim: 'sweep',
    damage: 30,
    cooldown: 120,
    reach: 150,
    sweep: 90,
    knockback: 15,
    abilities: [],
    slow: 0.7,
    delay: [30,0.25],
    swingDuration: 5,
    swingMod:-90,
    invert:true,
    aiDist: 150 + standardAiOff,
    idealDist: 50,
    hbDis: {x:20,y:570,rot:-107,scale:0.35},
    textDis: {x:0,y:-4},
    }],
    ['iron dagger',
    {
    anim: 'sweep',
    damage: 20,
    cooldown: 70,
    reach: 33,
    sweep: 0,
    sweepMod: 30,
    knockback: 5,
    swingStill: true,
    abilities: ['dart','stun 1','continuous'],
    swingDuration: 1,
    aiDist: 133+standardAiOff,
    idealDist:133,
    hbDis: {x:14,y:558,rot:-15},
    }],
    ['geist dagger',
    {
    anim: 'sweep',
    damage: 20,
    cooldown: 70,
    reach: 33,
    sweep: 0,
    sweepMod: 30,
    knockback: 5,
    abilities: ['dart','geist','continuous'],
    swingDuration: 1,
    aiDist: 133+standardAiOff,
    hbDis: {x:14,y:558,rot:-15},
    }],
    ['iron spear',
    {
    anim: 'thrust',
    damage: 30,
    cooldown: 50,
    reach: 98,
    sweep: 14,
    knockback:7,
    abilities: [],
    swingDuration: 0,
    aiDist: 98+standardAiOff,
    idealDist: 60,
    hbDis: {x:-3,y:563,rot:-15,scale:0.8},
    }],
    ['iron axe',
    {
    anim: 'sweep',
    damage: 30,
    cooldown: 80,
    reach: 68,
    sweep: 90,
    knockback:11,
    abilities: [ ],
    delay: [10,0.3],
    swingDuration: 10,
    swingMod:90,
    aiDist: 60+standardAiOff,
    hbDis: {x:30,y:573,rot:40,scale:0.7},
    }],
    ['digital smasher',
    {
    anim: 'sweep',
    damage: 30,
    cooldown: 80,
    reach: 68,
    sweep: 90,
    knockback:11,
    abilities: ['stun 1'],
    delay: [10,0.3],
    swingDuration: 10,
    swingMod:90,
    aiDist: 60+standardAiOff,
    hbDis: {x:30,y:573,rot:40,scale:0.7},
    }],
    ['heavy axe',
    {
    anim: 'sweep',
    damage: 30,
    cooldown: 280,
    reach: 68,
    sweep: 360,
    knockback:15,
    abilities: ['fling'],
    delay: [40,0.25],
    swingDuration: 35,
    swingMod:90,
    aiDist: 168+standardAiOff,
    hbDis: {x:30,y:573,rot:40,scale:0.7},
    }],
    ['iron katana',
    {
    anim: 'sweep',
    damage: 15,
    cooldown: 60,
    reach: 60,
    sweep: 75,
    knockback: 4.5,
    swingDuration: 15,
    abilities: ['fling2'],
    aiDist: 100+standardAiOff,
    hbDis: {x:0,y:560,rot:-15},
    }],
    ['geist katana',
    {
    anim: 'sweep',
    damage: 15,
    cooldown: 70,
    reach: 60,
    sweep: 40,
    knockback: 4.5,
    swingDuration: 15,
    aiDist: 100+standardAiOff,
    abilities: ['geist','fling2'],
    hbDis: {x:0,y:560,rot:-15},
    }],
    ['wooden recurve bow',
    {
    anim: 'twang',
    altAnim: 'twang',
    damage: 30,
    cooldown: 60,
    reach: 0,
    sweep: 0,
    sweepMod:0,
    knockback: 5,
    chargeSpeed:0.5,
    windResistance:0.4,
    projSpeed:8,
    noStall:false,
    rebound:false,
    chargeFactor:1.5,
    useSlow:0.2,
    changeRot:0.1,
    abilities: ['charge arrow','continuous'],
    swingDuration: 1,
    aiDist: 250 + standardAiOff,
    idealDist: 250,
    hbDis: {x:43,y:575,rot:-80},
    textDis: {x:0,y:-5},
    }],
    ['boomerang',
    {
    anim: 'throw right',
    damage: 30,
    cooldown: 100,
    reach: 0,
    sweep: 0,
    sweepMod:0,
    knockback: 8,
    windResistance:0.4,
    useSlow:0.2,
    changeRot:0.01,
    projSpeed:15,
    noStall:true,
    rebound:true,
    spin:10,
    size:30,
    abilities: ['arrow'],
    type:'boomerang',
    swingDuration: 1,
    aiDist: 250 + standardAiOff,
    idealDist: 250,
    hbDis: {x:36,y:581,rot:-90},
    textDis: {x:0,y:-5},
    }],
    ['fwoggy blaster',
    {
    anim: 'frequency twang',
    damage: 30,
    cooldown: 220,
    reach: 0,
    sweep: 0,
    sweepMod:0,
    knockback: 2.5,
    useSlow:0.2,
    changeRot:0.15,
    windResistance:0.5,
    projSpeed:12,
    noStall:true,
    rebound:false,
    chargeFactor:1.5,
    frequency:10,
    delay: [50,0.4],
    abilities: ['beam','continuous'],
    type: 'frog pellet',
    swingDuration: 1,
    aiDist: 250 + standardAiOff,
    idealDist: 250,
    hbDis: {x:42,y:583,rot:-80},
    textDis: {x:0,y:0},
    }],
    ['lazer beam',
    {
    anim: 'firebreath',
    damage: 7,
    cooldown: 100,
    reach: 0,
    sweep: 0,
    sweepMod:0,
    knockback: 0,
    useSlow:0.2,
    changeRot:0.005,
    windResistance:0,
    projSpeed:8,
    noStall:false,
    rebound:false,
    chargeFactor:1.5,
    frequency:3,
    delay: [50,0.4],
    abilities: ['beam','continuous'],
    type: 'lazer',
    swingDuration: 1,
    aiDist: 250 + standardAiOff,
    idealDist: 250,
    hbDis: {x:42,y:583,rot:-80},
    textDis: {x:0,y:0},
    }],
    ];
var people = [
    {
    name:'ack',
    looks:{
    color:color(0, 255, 251),
    },
    health:1000,
    speed:3,
    acceleration:0.2,
    size:1,
    weapons:['lazer beam','iron dagger','iron greatsword','iron spear','boomerang','wooden recurve bow',],
    powers:['dash','halt','lazer cross','wall of flames'],
    },
    {
    name:'Fastrack',
    looks:{
    color:color(255, 149, 0),
    hat:function(){
    noStroke();
    fill(255, 0, 0);
    rect(-10,-5,17,10);
    triangle(2,-10,13,0,2,10);
    },
    handR:function(){
    noStroke();
    fill(255, 0, 0,100);
    ellipse(0,0,15,15);
    },
    handL:function(){
    noStroke();
    fill(255, 0, 0,100);
    ellipse(0,0,15,15);
    },
    effects:function(x,y){
    if(frameCount/10 === round(frameCount/10)){
    var poof = new effect(x+15,y-10,random(2,7),choice(color(245, 10, 10),color(255, 111, 0)),random(0,255),random(2,5));
 var poof = new effect(x+15,y+10,random(2,7),choice(color(245, 10, 10),color(255, 111, 0)),random(0,255),random(2,5));
    }
    },
    },
    health:1000,
    speed:4,
    acceleration:0.2,
    size:0.85,
    weapons:['iron katana','iron dagger','heavy axe'],
    powers:['dash','halt','gravity bomb','blink'],
    },
    {
    name:'Worty Frowlg',
    looks:{
    color:color(21, 207, 0),
    hat:function(e){
    if(!e.brows||!e.curBrows){
    e.brows = [[{x:0,y:0},{x:0,y:0}],[{x:0,y:0},{x:0,y:0}],0];
    e.curBrows = [[{x:0,y:0},{x:0,y:0}],[{x:0,y:0},{x:0,y:0}],0];
    
    }
    for(var i = 0; i < 2; i++){
    for(var q = 0; q < 2; q++){
    e.curBrows[i][q].x = lerp(e.curBrows[i][q].x,e.brows[i][q].x,0.3);
    e.curBrows[i][q].y = lerp(e.curBrows[i][q].y,e.brows[i][q].y,0.3);
    }
    }
    
    stroke(0,0,0);
    strokeWeight(2);
    fill(157, 255, 0);
    arc(10,0,10,23,-90,90);
    fill(255, 255, 255);
    switch(e.browState){
    case 'angry attack':
    noFill();
    arc(12,0,10,15,120,240);
    fill(0,0,0);
    noStroke();
    arc(4,-6,4,4,-90,90);
    arc(4,6,4,4,-90,90);
    break;
    case 'sad':
    noFill();
    arc(12,0,10,15,120,240);
    fill(0,0,0);
    noStroke();
    arc(4,-6,4,4,0,360);
    arc(4,6,4,4,0,360);
    break;
    default:
    arc(7,0,10,15,-90,90);
    fill(0,0,0);
    noStroke();
    arc(4,-6,4,4,-90,90);
    arc(4,6,4,4,-90,90);
    break;
    }
    stroke(0,0,0);
    strokeWeight(4);
    line(1+e.curBrows[0][0].x,-8+e.curBrows[0][0].y,1+e.curBrows[0][1].x,-4+e.curBrows[0][1].y);
    line(1+e.curBrows[1][0].x,8+e.curBrows[1][0].y,1+e.curBrows[1][1].x,4+e.curBrows[1][1].y);
    
    if(e.trueAttacking && e.use.anim === 'sweep' && e.use.sweep > 0){
    e.brows[0] = [{x:0,y:0},{x:2,y:0}];
    e.brows[1] = [{x:0,y:0},{x:2,y:0}];
    e.browState = 'angry attack';
    }else if(e.browState === 'sad'){
    e.brows[0] = [{x:0,y:0},{x:-2,y:0}];
    e.brows[1] = [{x:0,y:0},{x:-2,y:0}];
    if(cycle(120,e,0)){
    e.browState = 'default';
    }
    }else if(cycle(500,e,0)||cycle(500,e,16)){
    e.brows[0] = [{x:-4,y:0},{x:-4,y:0}];
    e.brows[1] = [{x:-4,y:0},{x:-4,y:0}];
    e.browState = 'raise';
    }else if(cycle(500,e,-8)||cycle(500,e,8)){
    e.brows[0] = [{x:0,y:0},{x:0,y:0}];
    e.brows[1] = [{x:0,y:0},{x:0,y:0}];
    e.browState = 'default';
    }else if(e.browState === 'angry attack'){
    e.brows[0] = [{x:0,y:0},{x:0,y:0}];
    e.brows[1] = [{x:0,y:0},{x:0,y:0}];
    e.browState = 'default';
    }else if(e.browState === 'default'){
    e.brows[0] = [{x:0,y:0},{x:0,y:0}];
    e.brows[1] = [{x:0,y:0},{x:0,y:0}];
    }
    },
    handR:function(){
    stroke(0,0,0);
    strokeWeight(2);
    fill(21, 207, 0);
    ellipse(-5,0,20,10);
    },
    handL:function(){
    stroke(0,0,0);
    strokeWeight(2);
    fill(21, 207, 0);
    ellipse(-5,0,20,10);
    },
    handRCustom:1,
    handLCustom:1,
    effects:function(x,y){
    },
    },
    health:500,
    speed:3.4,
    acceleration:0.2,
    size:1,
    weapons:['iron katana','fwoggy blaster','iron sword','iron greatsword'],
    powers:['froggy hop','halt','sludge spew','blink'],
    }, 
    {
    name:'Geist',
    looks:{
    color:color(160, 0, 160),
    hat:function(e){
    strokeWeight(2);
    stroke(0, 234, 255,150+sin(frameCount+60)*40);
    line(13,-3,4,-8);
    stroke(0, 234, 255,150+sin(frameCount+120)*40);
    line(-5,-8,4,-8);
    stroke(0, 234, 255,150+sin(frameCount+180)*40);
    line(-6.5,-8,-13,-3);
    fill(255+cos(frameCount)*40, 0+sin(frameCount)*40, 255+cos(frameCount)*40);
    strokeWeight(1);
    stroke(0, 0, 0);
    beginShape();
    vertex(2,-15);
    vertex(8,-10);
    vertex(10,-8);
    vertex(10,8);
    vertex(8,10);
    vertex(2,15);
    
    vertex(2,10);
    vertex(5,5);
    vertex(5,-5);
    vertex(2,-10);
    
    vertex(2,-15);
    endShape(CLOSE);
    
    noStroke();
    fill(0, 166, 255,200);
    var point = {x:5+abs(cos(frameCount)*3),y:sin(frameCount)*10};
    ellipse(point.x,point.y,3,3);
    
    },
    handR:function(){

    return 0;
    },
    handL:function(){

    return 0;
    },
    effects:function(x,y){

    },
    },
    health:800,
    speed:3.6,
    acceleration:0.35,
    size:1,
    weapons:['geist katana','geist dagger','digital smasher','lazer beam'],
    powers:['gravity bomb','blink','EMP','lazer cross'],
    },
    ];
var p;
var effects = [];
var projs = [];
var screenDist = sqrt(pow(width/2,2)+pow(height/2,2));
function proj(x,y,a,v,l,d){
this.x = x;
this.y = y;
this.angle = a;
this.rot = a;
this.v = v;
this.life = l;
this.data = d;
if(this.data.size){
this.size = this.data.size;
}else{
this.size = 0;
this.data.size = 0;
}
this.id = random(0,1000000);
projs.push(this);
}
function effect(x,y,r,c,t,t2,tp){
this.x = x;
this.y = y;
if(r[1]){
this.w = r[0];
this.h = r[1];
}else{
this.w = r;
this.h = r;
}
this.vx = 0;
this.vy = 0;
this.color = c;
this.timer = t;
this.ty = t2;
if(tp){
this.type = tp;
}else{
this.type = 'ellipse';
}

//if(dist(x,y,p.x,p.y) < screenDist || scene !== 'game'||p.health<=0){
this.index = effects.length;
effects.push(this);
//}

}
//function effect(){}
effect.prototype.terminate = function(){

for(var i = this.index+1; i < effects.length; i++){

effects[i].index--;

}
effects.splice(this.index,1);
};
effect.prototype.draw = function() {
noStroke();
this.x += this.vx;
this.y += this.vy;
fill(this.color,this.timer);
if(this.type === 'ellipse'){
ellipse(this.x,this.y,this.w,this.h);
}
if(this.type === 'solid ellipse'){
fill(this.color);
ellipse(this.x,this.y,this.w,this.h);
}
textAlign(CENTER,BASELINE);
pushMatrix();
translate(this.x,this.y);
rotate(this.rot);
translate(-this.x,-this.y);
if(this.type === 'rect'){
rect(this.x-this.w/2,this.y-this.h/2,this.w,this.h);
}
if(this.type === 'solid rect'){
fill(this.color);
rect(this.x-this.w/2,this.y-this.h/2,this.w,this.h);
}
if(this.type === 'text'){
textSize(this.textSize);
text(this.text,this.x,this.y);
}
if(this.type === 'btext'){
this.rot += this.vRot;
this.vy += 0.1;
//fill(this.color);
textSize(this.textSize);
text(this.text,this.x,this.y);
}
popMatrix();
this.timer -= this.ty;
if(this.timer <= 0){
this.terminate();
//effects.splice(this,1);
}

};
function projGraphics(e,t,isSymbol){
switch(e){
case 'none':
break;
case 'lazer':
noStroke();
fill(143, 0, 143,100);
//ellipse(random(-3,3),random(-3,3),20,20);
rect(random(-3,3)-10,random(-3,3)-10,20,20);
break;
case 'frog pellet':

strokeWeight(2);
stroke(0,0,0);
fill(81, 227, 32);
ellipse(10,0,10+sin(frameCount*10)*2,13);
fill(7, 117, 22);
pushMatrix();
translate(-5,8);
rotate(45);
ellipse(0,0,10,5);
popMatrix();
pushMatrix();
translate(-5,-8);
rotate(-45);
ellipse(0,0,10,5);
popMatrix();
ellipse(0,0,20,15);
strokeWeight(5);
point(8,8);
point(8,-8);

if(t){

if(t.v <= 0){
if(!t.frogBounces && t.frogBounces !== 0){
    t.frogBounces = 4;
}else{
t.frogBounces--;
}
if(t.frogBounces > 0){
t.life = 200;
t.v = 12;
t.angle += random(-90,90);
t.rot = t.angle;
}
}
}
break;
case 'gravity bomb':
noStroke();
fill(92, 92, 92);
ellipse(0,0,20,20);
fill(0, 61, 242);
ellipse(0,0,4,4);
fill(0, 255, 221,70);
ellipse(0,0,13,8);
if(!isSymbol){
if((frameCount/4 !== round(frameCount/4))){
fill(0, 200, 255,65);
}else{
fill(0, 200, 255,55);
}
ellipse(0,0,400,400);
}
break;
case 'sludge':
noStroke();
pushMatrix();
scale(2);
if(!t){
t = {sRand:0};
}else{
if(!t.sRand){
    t.sRand = random(0,1000);
}
}
fill(0+cos(t.sRand)*20, 120+sin(t.sRand)*20, 2+cos(t.sRand)*20);
ellipse(0,0,20+sin(frameCount*2+t.sRand)*3,20+cos(frameCount*2+t.sRand)*3);
if(round(random(0,10)) === 2 && t.x){
var poof = new effect(t.x+random(-15,15),t.y+random(-15,15),random(2,12),color(0+cos(t.sRand)*20, 120+sin(t.sRand)*20, 2+cos(t.sRand)*20),random(0,255),random(2,5));
poof.vx = random(-0.5,0.5);
poof.vy = random(-0.5,0.5);
}
popMatrix();
break;
case 'boomerang':
fill(255, 255, 0);
stroke(0,0,0);
strokeWeight(10);
//point(0,0);
pushMatrix();
translate(-25,-28);
scale(0.2);
//translate(-12,-18);
//rotate(-25);
beginShape();
vertex(237,248);
bezierVertex(120,124,204,113,205,34);
bezierVertex(60,163,186,237,237,248);
endShape();
popMatrix();
break;
case 'fireball':
noStroke();
fill(255, 123, 0,100);
//ellipse(random(-3,3),random(-3,3),20,20);
for(var i = 0; i < 5; i++){
ellipse(random(-3,3),random(-3,3),20,20);
}
break;
default:
    strokeWeight(1.5);
    stroke(148, 106, 78);
    line(-10, 0, 15, 0);
    strokeWeight(2);
    stroke(184, 184, 184);
    line(13, -2, 15, 0);
    line(13, 2, 15, 0);
    stroke(255, 255, 255);
    line(-14, 0, -10, 0);
    line(-13, -2, -10, 0);
    line(-13, 2, -10, 0);
break;
}
}

function drawEffects(){
for(var i = effects.length-1; i > -1; i--){
effects[i].draw();
}
}
function mixUp(e){
    
    var sra = [];
    var ea = [];
    for(var q = 0; q < e.length; q++){
        ea.push(e[q]);
    }
   for(var i = 0; i < e.length; i++){
       var sn = round(random(0,ea.length-1));
       sra.push(ea[sn]);
       ea.splice(sn, 1);
   }
    return(sra);
}
function diff(a, b) {
    return abs(a - b);
}
function stun(e,t){

if(e.buffs.stun < t||!e.buffs.stun){
e.buffs.stun = t;
}
}
function phaseOut(e,t){
if(e.buffs.phaseOut < t ||!e.buffs.phaseOut){
e.buffs.phaseOut = t;
}
}
function basicProj(s){
var d = s.rot;

    var e = new proj(s.x+cos(d)*(15*s.size),s.y+sin(d)*(15*s.size),s.rot,s.charge/s.use.chargeFactor+s.use.projSpeed,200,{
    slow:s.use.windResistance,
    noStall:s.use.noStall,
    rebound:s.use.rebound,
    spin:s.use.spin,
    size:s.use.size,
    shooter:s,
    data:s.use,
    });
    s.charge = 0;
    
}
function basicInstaProj(s){
var d = s.rot;
    var e = new proj(s.x+cos(d)*(15*s.size),s.y+sin(d)*(15*s.size),s.rot,s.use.projSpeed,200,{
    slow:s.use.windResistance,
    noStall:s.use.noStall,
    rebound:s.use.rebound,
    spin:s.use.spin,
    size:s.use.size,
    shooter:s,
    data:s.use,
    });

}
function flame(x,y){
pushMatrix();
translate(-222+x,-260+y);
    //fill(115, 115, 115);
    //strokeWeight(3);
    beginShape();
vertex(213,255);
vertex(196,277);
vertex(211,292);
vertex(229,295);
vertex(241,285);
vertex(250,271);
vertex(248,248);
vertex(238,258);
vertex(231,251);
vertex(224,255);
vertex(217,238);
vertex(212,255);
endShape();
beginShape();
vertex(201,265);
vertex(208,278);
vertex(219,283);
vertex(232,281);
vertex(235,271);
vertex(234,211);
vertex(222,250);
vertex(214,241);
vertex(210,250);
vertex(201,245);
vertex(201,263);
endShape();
popMatrix();
}
function bolt(x,y){
pushMatrix();
translate(x,y);
beginShape();
vertex(0,-17);
vertex(-5,0);
vertex(-1,3);
vertex(0,17);
vertex(5,0);
vertex(1,-3);
vertex(0,-17);
endShape(CLOSE);
popMatrix();
}
var abilities = [
    ['geist',{
    hit:function(s,t){
    var dir = atan2(s.y-t.y,s.x-t.x);
var postPos = [s.x,s.y];
s.x = t.x;
s.y = t.y;
t.x = postPos[0];
t.y = postPos[1];
t.vx = cos(dir)*3;
t.vy = sin(dir)*3;
for(var i = 0; i < 20; i++){
var poof = new effect(s.x,s.y,random(5,15),choice(color(128, 0, 128),color(0, 0, 0)),random(0,255),random(2,5));
poof.vx = random(-1,1);
poof.vy = random(-1,1);
}
    },
    }],
    ['stun 1',{
    hit:function(s,t){
    stun(t,60);
    },
    }],
    ['continuous',{
    duringSwing:function(s){
    if(s.cooldown <= 1){
    s.cooldown = 0;
    }
    }
    }],
    ['beam',{
    duringSwing:function(s){
    if(frameCount/s.use.frequency === round(frameCount/s.use.frequency)){
    basicProj(s);
    }
    }
    }],
    ['charge arrow',{
    duringSwing:function(s){
    s.charge+=s.use.chargeSpeed;
    },
    released:function(s){
    //println('e');
    basicProj(s);
    },
    }],
    ['arrow',{
    swing:function(s){
    basicInstaProj(s);
    },
    }],
    ['fling',{
    swing:function(s){
    var dir = s.rot;
    s.vx = cos(dir)*12;
    s.vy = sin(dir)*12;
    }
    }],
    ['fling2',{
    swing:function(s){
    var dir = s.rot;
    s.vx = cos(dir)*8;
    s.vy = sin(dir)*8;
    }
    }],
    ['dart',{
    swing:function(s){
    var dir = s.rot;
    s.vx = cos(dir)*10;
    s.vy = sin(dir)*10;
    },
    endSwing:function(s){
    var dir = s.rot - 180;
    s.vx = cos(dir)*8;
    s.vy = sin(dir)*8;
    }
    }],
    ];
var powers = [
    ['dash',{
    cooldown: 70,
    changeRot: 0.03,
    aiDist: 300,
    idealDist: 300,
    abilities: ['continuous'],
    idealCharge: 10,
    descript: 'Dash forwards after charging for a couple of seconds.',
    use:function(s){
    s.pCharge+=0.5;
    s.altSpeed = 0.5;
    },
    released:function(s){
    
    s.vx = cos(s.rot)*(s.pCharge+3.5)/1.5;
    s.vy = sin(s.rot)*(s.pCharge+3.5)/1.5;
    for(var i = 0; i < 20; i++){
var poof = new effect(s.x,s.y,random(5,15),color(0, 51, 110),random(0,255),random(2,5));
poof.vx = random(-1,1);
poof.vy = random(-1,1);
}
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    rotate(-45+sin(frameCount)*10-i);
    fill(115, 115, 115);
    strokeWeight(3);
    beginShape();
    vertex(0,-5);
    vertex(0,-15);
    vertex(20,0);
    vertex(0,15);
    vertex(0,5);
    vertex(-20,5);
    vertex(-20,-5);
    vertex(0,-5);
    endShape();
    noStroke();
    rotate(45-sin(frameCount)*10+i*2);
    fill(0, 255, 238,100);
    rect(-35,-35,70,70,15);
    fill(217, 0, 0,50);
    rect(-35+((15-r)*(70/15))/2,-35+((15-r)*(70/15))/2,r*(70/15),r*(70/15),15);
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
    }
    }],
    ['halt',{
    cooldown: 100,
    noHold: true,
    aiDist: Infinity,
    idealDist: Infinity,
    abilities: [],
    descript: 'Instantly come to a stop, losing all velocity in all directions.',
    condition:function(s,t){
    if(abs(s.vx)+abs(s.vy) > s.speed*3.3){
    return true;
    }
    },
    use:function(s){
    s.vx = 0;
    s.vy = 0;
    for(var i = 0; i < 20; i++){
var poof = new effect(s.x,s.y,random(5,15),choice(color(245, 10, 10),color(66, 38, 6)),random(0,255),random(2,5));
poof.vx = random(-2,2);
poof.vy = random(-2,2);
}
    },
    released:function(s){
    
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    rotate(-45+sin(frameCount)*10-i);
    fill(115, 115, 115);
    strokeWeight(3);
    beginShape();
    vertex(20,20);
    vertex(12,20);
    vertex(0,8);
    vertex(-12,20);
    vertex(-20,20);
    vertex(-7,0);
    vertex(-20,-20);
    vertex(-12,-20);
    vertex(0,-8);
    vertex(12,-20);
    vertex(20,-20);
    vertex(6,0);
    vertex(20,20);
    endShape();
    noStroke();
    rotate(45-sin(frameCount)*10+i*2);
    fill(255, 0, 0,100);
    rect(-35,-35,70,70,15);
    
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
    }
    }],
    ['wall of flames',{
    cooldown: 400,
    changeRot: 0.015,
    abilities: ['continuous'],
    aiDist: 150 + standardAiOff,
    idealDist: 50,
    idealCharge: 10,
    descript: 'Slowly summon a wall of fireballs to fling forwards.',
    use:function(s){
    s.noWeaponDraw = true;
    s.hands = [{transX:-s.pCharge/3,transY:-6},{transX:-s.pCharge/3,transY:6}];
    s.pCharge+=0.2;
    s.altSpeed = 0.5;
    s.onSwingRot = s.rot;
    for(var i = (-20)*((4/15)*s.pCharge); i < 20+(20)*((4/15)*s.pCharge); i+=20){
    var d = s.rot;
    var e = new effect(s.x+cos(d)*(30*s.size)+cos(d+90)*i,s.y+sin(d)*(30*s.size)+sin(d+90)*i,20,color(255, 123, 0,100),5,1,'solid ellipse');
    }
    },
    released:function(s){
    //if(s.pCharge >= 15){
    s.pCharge+=1;
    s.vx = -(cos(s.rot)*7);
    s.vy = -(sin(s.rot)*7);
    for(var i = (-20)*((4/15)*s.pCharge); i < 20+(20)*((4/15)*s.pCharge); i+=20){
    var d = s.rot;
    var e = new proj(s.x+cos(d)*(30*s.size)+cos(d+90)*i,s.y+sin(d)*(30*s.size)+sin(d+90)*i,s.rot,4,50,{
    slow:0,
    noStall:false,
    rebound:false,
    shooter:s,
    data:{
    type:'fireball',
    knockback:6,
    damage:30,
    abilities:[],
    },
    });
    e.noScale = true;
    }
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    //println('b');
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    //rotate(-45+sin(frameCount)*10-i);
    pushMatrix();
    scale(0.4);
    for(var i = 0; i < 3; i++){
    fill(156, 70, 0);
    strokeWeight(5);
    flame(i*40-38,-i*20+25);
    }
    noStroke();
    //println('c');
    popMatrix();
    //rotate(45-sin(frameCount)*10+i*2);
    fill(186, 78, 0,100);
    rect(-35,-35,70,70,15);
    
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
     fill(217, 0, 0,50);
    rect(-35+((15-r)*(70/15))/2,-35+((15-r)*(70/15))/2,r*(70/15),r*(70/15),15);
    }
    }],
    ['lazer cross',{
    cooldown: 400,
    changeRot: 0.015,
    aiDist: 250+ standardAiOff,
    idealDist: 200,
    abilities: ['continuous'],
    idealCharge: 12,
    descript: 'Slowly summon a spinning cross made of lazers to fling forwards.',
    use:function(s){
    s.noWeaponDraw = true;
    s.hands = [{transX:s.pCharge/3,transY:-4},{transX:-s.pCharge/3,transY:4}];
    s.pCharge+=0.15;
    s.altSpeed = 0.5;
    s.onSwingRot = s.rot;
    for(var i = 0; i < 20+(20)*((3/15)*s.pCharge); i+=20){
    for(var q = 0; q < 4; q++){
    var d = s.rot+(q*90)+(s.pCharge*24);
    var e = new effect(s.x+cos(d)*(30*s.size)+cos(d)*i+random(-3,3),s.y+sin(d)*(30*s.size)+sin(d)*i+random(-3,3),20,color(143,0,143,45),5,1,'solid rect');
    e.rot = d;
    }
    }
    },
    released:function(s){
    //if(s.pCharge >= 15){
    s.pCharge+=1;
    s.vx = -(cos(s.rot)*5);
    s.vy = -(sin(s.rot)*5);
    for(var i = 0; i < 20+(20)*((3/15)*s.pCharge); i+=20){
    for(var q = 0; q < 4; q++){
    var d = s.rot+(q*90)+((s.pCharge-1)*24);
    
    //var e = new effect(s.x+cos(d)*(30*s.size)+cos(d)*i+random(-3,3),s.y+sin(d)*(30*s.size)+sin(d)*i+random(-3,3),20,color(143,0,143,40),5,1,'solid rect');
    for(var i2 = 0; i2 < 2; i2++){
    var e = new proj(s.x+cos(d)*(30*s.size)+cos(d)*i,s.y+sin(d)*(30*s.size)+sin(d)*i,s.rot,4,140,{
    slow:0,
    noStall:false,
    rebound:false,
    shooter:s,
    data:{
    type:'lazer',
    knockback:2,
    damage:10,
    abilities:[],
    },
    });
    e.rot = d;
    e.noScale = true;
    }
    }
    }
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    //rotate(-45+sin(frameCount)*10-i);
    pushMatrix();
    scale(0.4);
    for(var i = 0; i < 3; i++){
    fill(99, 0, 94);
    strokeWeight(5);
    flame(i*40-38,-i*20+25);
    }
    noStroke();
    popMatrix();
    //rotate(45-sin(frameCount)*10+i*2);
    fill(153, 0, 130,100);
    rect(-35,-35,70,70,15);
    
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
     fill(217, 0, 0,50);
    rect(-35+((15-r)*(70/15))/2,-35+((15-r)*(70/15))/2,r*(70/15),r*(70/15),15);
    }
    }],
    ['gravity bomb',{
    cooldown: 600,
    aiDist: 250+ standardAiOff,
    idealDist: 200,
    noHold: true,
    abilities: [],
    descript: 'Throw a bomb in front of you that pulls in all enemies.',
    use:function(s){
    s.noWeaponDraw = true;
    var d = s.rot;
    var e = new proj(s.x+cos(d)*(30*s.size-s.size/2)/2,s.y+sin(d)*(30*s.size)/2,s.rot,3,200,{
    slow:0.1,
    noStall:true,
    rebound:false,
    shooter:s,
    effects:function(st,thst){
    if(st.health > 0){
    for(var i = 0; i < st.enemies.length; i++){
    var q = st.enemies[i];
    if(!q.buffs.phaseOut){
    if(dist(thst.x,thst.y,q.x,q.y)<200+(q.size*15)){
    var dir = atan2(thst.y-q.y,thst.x-q.x);
    var power = 10;
    q.vx = lerp(q.vx,cos(dir)*power,0.05);
    q.vy = lerp(q.vy,sin(dir)*power,0.05);
    q.danger = true;
    }
    }
    }
    }
    },
    data:{
    type:'gravity bomb',
    knockback:0,
    damage:0,
    noHit:true,
    abilities:[],
    },
    });
    e.noScale = true;
    },
    released:function(s){
    
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    //rotate(-45+sin(frameCount)*10-i);
    pushMatrix();
    scale(2);
    projGraphics('gravity bomb',false,true);
    popMatrix();
    //rotate(45-sin(frameCount)*10+i*2);
    fill(0, 64, 153,30);
    rect(-35,-35,70,70,15);
    
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
     fill(217, 0, 0,50);
    rect(-35+((15-r)*(70/15))/2,-35+((15-r)*(70/15))/2,r*(70/15),r*(70/15),15);
    }
    }],
    ['sludge spew',{
    cooldown: 600,
    aiDist: 80+ standardAiOff,
    idealDist: 80,
    changeRot: 0.05,
    abilities: ['continuous'],
    idealCharge: 12,
    descript: 'Spew toxic sludge.\nTip: use on a stunned or cornered enemy for massive damage!',
    use:function(s){
    if(s.pCharge >= 15){
    s.forcedPowerRelease = true;
    }
    s.noWeaponDraw = true;
    s.hands = [{transX:-3,transY:-4},{transX:-3,transY:4}];
    s.pCharge+= 0.05;
    s.altSpeed = 0.5;
    s.onSwingRot = s.rot;
    s.browState = 'angry attack';
    if(round(frameCount/4) === frameCount/4){
    var d = s.rot;
    
    var e = new proj(s.x+cos(d)*(30*s.size-s.size/2)/2,s.y+sin(d)*(30*s.size)/2,s.rot,5,300,{
    slow:0.1,
    noStall:true,
    rebound:false,
    size:35,
    shooter:s,
    effects:function(st,thst){
    if(thst.sRand){
    thst.x += cos(thst.sRand)*0.1;
    thst.y += sin(thst.sRand)*0.1;
    }
    },
    data:{
    type:'sludge',
    knockback:0.1,
    damage:4,
    abilities:[],
    },
    });
    e.noScale = true;
    }
    },
    released:function(s){
    
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    //rotate(-45+sin(frameCount)*10-i);
    pushMatrix();
    scale(1.3);
    projGraphics('sludge',false,true);
    popMatrix();
    //rotate(45-sin(frameCount)*10+i*2);
    fill(11, 82, 0,100);
    rect(-35,-35,70,70,15);
    
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
     fill(217, 0, 0,50);
    rect(-35+((15-r)*(70/15))/2,-35+((15-r)*(70/15))/2,r*(70/15),r*(70/15),15);
    }
    }],
    ['blink',{
    cooldown: 150,
    noHold: true,
    aiDist: Infinity,
    idealDist: Infinity,
    abilities: [],
    descript: 'Instantly jump in the direction you\'re facing',
    bypassCondition: true,
    condition:function(s,t){
    if(s.danger){
    return true;
    }
    },
    use:function(s){
    
    var num = 60;
    s.vx = cos(s.rot)*4;
    s.vy = sin(s.rot)*4;
    
    for(var i = 0; i < num; i++){
    pushMatrix();
    
    if(i/10 === round(i/10)){
    
    doPlayerGraphics(s,s.size);
    
    }
    s.x += s.vx;
    s.y += s.vy;
    
    s.collisions();
    popMatrix();
    }
    
    
    for(var i = 0; i < 20; i++){
var poof = new effect(s.x,s.y,random(5,15),choice(color(245, 202, 12),color(66, 38, 6)),random(0,255),random(2,5));
poof.vx = random(-2,2);
poof.vy = random(-2,2);
}
    },
    released:function(s){
    
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    rotate(-45+sin(frameCount)*10-i);
    fill(115, 115, 115);
    strokeWeight(3);
    arc(0,5,50,25,200,340);
    arc(0,-5,50,25,20,160);
    ellipse(0,0,5,5);
    noStroke();
    rotate(45-sin(frameCount)*10+i*2);
    fill(209, 185, 0,100);
    rect(-35,-35,70,70,15);
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
    }
    }],
    ['froggy hop',{
    cooldown: 350,
    noHold: true,
    aiDist: Infinity,
    idealDist: Infinity,
    abilities: [],
    descript: 'Jump in the direction you\'re facing, ignoring all damage you recieve during the hop\n\n"I\'m out"\n-Worty Frowlg 2023',
    condition:function(s,t){
    if(s.danger){
    return true;
    }
    },
    use:function(s){
    s.vx = cos(s.rot)*10;
    s.vy = sin(s.rot)*10;
    s.browState = 'sad';
    phaseOut(s,50);
    },
    released:function(s){
    
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    rotate(-45+sin(frameCount)*10-i);
    
    worty(0,0,1,0,2);
    
    noStroke();
    rotate(45-sin(frameCount)*10+i*2);
    fill(54, 189, 0,100);
    rect(-35,-35,70,70,15);
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
    }
    }],
     ['EMP',{
    cooldown: 600,
    changeRot: 0.03,
    aiDist: 400,
    idealDist: 400,
    abilities: ['continuous'],
    idealCharge: 10,
    descript: 'Stun all enemies within a radius. The longer you charge for, the more powerful.\nEMP: electro-magnetic-\npulsethatsomehowworksonpeople',
    use:function(s){
    s.pCharge+=0.2;
    s.altSpeed = 0.5;
    s.noWeaponDraw = true;
    s.hands = [{transX:-s.pCharge/1.5,transY:-s.pCharge/1.5},{transX:-s.pCharge/1.5,transY:s.pCharge/1.5}];
    },
    released:function(s){
    var rad = (1000/15)*s.pCharge;
    var num = (160/15)*s.pCharge;
    var poof = new effect(s.x,s.y,rad*2,color(129, 245, 5),200,3);
    for(var i = 0; i < 20; i++){
var poof = new effect(s.x+cos(s.rot)*25,s.y+sin(s.rot)*25,random(5,15),color(2, 140, 2),random(0,255),random(2,5),'rect');
poof.vx = random(-2,2);
poof.vy = random(-2,2);
}
    s.curHands = [{transX:10,transY:10},{transX:10,transY:-10}];
    for(var i = 0; i < s.enemies.length; i++){
    var q = s.enemies[i];
    if(!q.buffs.phaseOut){
    if(dist(s.x,s.y,q.x,q.y)<rad+(q.size*15)){
    stun(q,num);
    }
    }
    }
    },
    symbol:function(s,c,n){
    stroke(0, 0, 0);
    if(s.powerSelect === n){
    strokeWeight(8);
    }else{
    strokeWeight(5);
    }
    fill(227, 227, 227);
    var r = 0;
    if(s.powerSelect === n){
    r = s.pCharge;
    }
    var w = s.pCooldown[n];
    if(w > c){
    w = c;
    }
    var i = random(-r,r)/2;
    rotate(45+i);
    rect(-35,-35,70,70,15);
    rotate(45+sin(frameCount)*10-i);
    fill(115, 115, 115);
    strokeWeight(3);
    var num2 = 360;
    
    for(var i2 = 0; i2 < 3; i2++){
    if(cos((frameCount+i2*num2)/4)<cos((frameCount+i2*num2+1)/4)){
    var num = 90-cos((frameCount+i2*num2)/4)*40;
    rotate(num);
    bolt(0+cos((frameCount+i2*num2)/4)*25,-10);
    rotate(-num);
    }
    }
    
    beginShape();
    vertex(0,-5);
    vertex(0,-15);
    vertex(20,0);
    vertex(0,15);
    vertex(0,5);
    vertex(-20,5);
    vertex(-20,-5);
    vertex(0,-5);
    endShape();
    
    for(var i2 = 0; i2 < 3; i2++){
    if(cos((frameCount+i2*num2)/4)>cos((frameCount+i2*num2+1)/4)){
    var num = 90-cos((frameCount+i2*num2)/4)*40;
    rotate(num);
    bolt(0+cos((frameCount+i2*num2)/4)*25,-10);
    rotate(-num);
    }
    }
    
    rotate(-90);
    noStroke();
    rotate(45-sin(frameCount)*10+i*2);
    fill(255, 208, 0,100);
    rect(-35,-35,70,70,15);
    fill(217, 0, 0,50);
    rect(-35+((15-r)*(70/15))/2,-35+((15-r)*(70/15))/2,r*(70/15),r*(70/15),15);
    fill(66, 66, 66,50);
    rect(-35,-35,(c-w)*(70/c),(c-w)*(70/c),15);
    }
    }],
    ];

var walls = [];
var players = [];
var chunks = [];
var cam = {x:0,y:0};
var trueRandom = random(0,10000);

{
// var keyID = [];
// var keyPID = [];
// //var keyPPID = [];
// //var waveNum = 1;
// var alive = true;
// function keyPressed() {
//     if(keyID[keyCode] !== true){
//     keyPID[keyCode] = true;
//     }else{
//     keyPID[keyCode] = false;
//     }
//     keyID[keyCode] = true;
//     //println(keyCode);
// }
// function keyReleased() {
    
//     keyID[keyCode] = false;
// }
}

/**Inputs**/
//{

var TAPPED_TIME = 1;

function Key(){
    this.pressed = false;
        this.tapped = false;
        //how long key will stay tapped
        this.tappedTime = TAPPED_TIME;
}
Key.prototype.press = function() {
        this.tapped = false;
        if (this.pressed === false) {    
            this.tapped = true;
            this.tappedTime = TAPPED_TIME;
        }
        this.pressed = true;
        
    };
Key.prototype.unTap = function() {
        this.tapped = false;
        this.tappedTime = 0;
    };
Key.prototype.isTapped = function () {
        
        if (this.tapped === true) {
            
            this.tapped = false;
            this.tappedTime = 0;
            return true;
        } else {
            return false;    
        }
    };
Key.prototype.update = function () {
        this.tappedTime --;
    };
//stores key presses
var keys = {};
function pressed(e){
if(e){
if(e.pressed){
return true;
}
}
}
function tapped(e){
if(e){
if(e.tapped){
return true;
}
}
}


keyPressed = function (){
    if (!keys[keyCode]) {
        keys[keyCode] = new Key();
    }
    keys[keyCode].press();
};
keyReleased = function (){
  keys[keyCode].pressed=false;
};

function manageKeys(){
    
    for (var i in keys) {
        if (keys[i].tapped === true) {
            
            keys[i].update();
            if (keys[i].tappedTime <= 0) {
                keys[i].tapped = false;
            }
        }
        
    }
    
}


//}




// stuff not by me{

// Cavan P stuff
function getTriCenter(d){
var avgX = (d.x1+d.x2+d.x3)/3;
var avgY = (d.y1+d.y2+d.y3)/3;
return {x:avgX, y:avgY};
}
function getCenter(e){
var avgX = 0;
var avgY = 0;
for(var i = 0; i < e.data.length; i++){
avgX += e.data[i].x;
avgY += e.data[i].y;
}
avgX /= e.data.length;
avgY /= e.data.length;
return {
x:avgX,
y:avgY,
};
}
var triArea = function(x1, y1, x2, y2, x3, y3){
    return Math.abs((x1*(y2-y3) + x2*(y3-y1)+ x3*(y1-y2))/2);
    //Calclulate area of any triangle
};
var isInsideTri = function(x1, y1, x2, y2, x3, y3, x, y){
    x = round(x);
    y = round(y);
    var a = triArea(x1, y1, x2, y2, x3, y3);//Area of triangle ABC
    var a1 = triArea(x1, y1, x2, y2, x, y);//Area of triangle ABP
    var a2 = triArea(x1, y1, x, y, x3, y3);//Area of triangle APC
    var a3 = triArea(x, y, x2, y2, x3, y3);//Area of triangle PBC
    
    return a===a1+a2+a3;
    //return true if area 'a' is equal to the sum of the other three triangles
};
var quadArea = function(x1, y1, x2, y2, x3, y3, x4, y4){
    return triArea(x1, y1, x2, y2, x4, y4)+triArea(x2, y2, x3, y3, x4, y4);
    //Calculate area of any quadralateral
};
var insideQuad = function(x1, y1, x2, y2, x3, y3, x4, y4, x, y){
    var a = quadArea(x1, y1, x2, y2, x3, y3, x4, y4);
    var a1 = triArea(x1, y1, x2, y2, x, y);
    var a2 = triArea(x2, y2, x3, y3, x, y);
    var a3 = triArea(x3, y3, x4, y4, x, y);
    var a4 = triArea(x4, y4, x1, y1, x, y);
    
    return (a1+a2+a3+a4-a)<=0.1e-6;
};
function between(x,a,b){
if((x >= a && x <= b)||(x >= b && x <= a)){
return true;
}
}
var drawRay = function(x, y){
    noFill();
    ellipse(x, y, 9, 9);
    line(x, y, max(width, height), y);
};
var Point = function(x, y){
    return {
        x: x,
        y: y
    };
};
var onSegment = function(p, q, r){
    return  q.x <= max(p.x, r.x) && 
            q.x >= min(p.x, r.x) && 
            q.y <= max(p.y, r.y) && 
            q.y >= min(p.y, r.y);
};
var orientation = function(p, q, r){
    var v = (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);
    
    if (v===0) {
        return 0;
    }
    
    return v > 0?1:2;
};
var doIntersect = function(p1, q1, p2, q2){
    var o1 = orientation(p1, q1, p2); 
    var o2 = orientation(p1, q1, q2); 
    var o3 = orientation(p2, q2, p1); 
    var o4 = orientation(p2, q2, q1);
    
    return (o1!==o2&&o3!==o4)||(o1===0&&onSegment(p1, p2, q1))||(o2 === 0&&onSegment(p1, q2, q1))||(o3===0&&onSegment(p2, p1, q2))||(o4===0&&onSegment(p2, q1, q2));
};
var isInside = function(poly, n, p){
    if (n < 3){ 
        return false; 
    } 

    var extreme = Point(100000, p.y);

    var count = 0, i = 0; 
    do { 
        var next = (i + 1) % n; 

        if (doIntersect(poly[i], poly[next], p, extreme)){ 
            if (orientation(poly[i], p, poly[next])===0){ 
                //return onSegment(poly[i], p, poly[next]); 
                count--;
            } 

            count++; 
        } 
        i = next; 
    } 
    while (i !== 0); 

    return count % 2 === 1;
};
function getSize(size){
return (30*size)/2;
}
function getClosest(e,s){
var dir = atan2(s.y-e.y,s.x-e.x);
return {x:e.x+cos(dir)*getSize(e.size),y:e.y+sin(dir)*getSize(e.size)};
}
// And a bit of Bob Lyon
var nearestPointOnLine = function(ax, ay, bx, by) {
    var dx = bx - ax;  /* Vector from A to B (run) */
    var dy = by - ay;  /* ... (rise) */
    var mag2 = dx*dx + dy*dy;  /* Squared distance between A and B */
    
    /* Find and return the nearest point on line AB to point P. */
    var nearest = function(px, py) {
        var a2pX = px - ax;  /* Vector from A to P */
        var a2pY = py - ay;
        var a2pDota2b = a2pX*dx + a2pY*dy;  /* AP ⦁ AB */
        var t = a2pDota2b / mag2;  /* Parametric distance from A to THE point */
        var ret = {
            x: ax + dx*t,
            y: ay + dy*t 
        };
        
        if(between(ret.x,ax,bx) && between(ret.y,ay,by)){
        return ret;
        }else{
        if(ret.x > ax && ret.x > bx){
        return{
        x: ax,
        y: ay,
        };
        }else if(ret.x < ax && ret.x < bx){
        return{
        x: ax,
        y: ay,
        };
        }else if(ret.y > ay && ret.y > by){
        return{
        x: ax,
        y: ay,
        };
        }else if(ret.y < ay && ret.y < by){
        return{
        x: ax,
        y: ay,
        };
        }else{
        return{
        x: Infinity,
        y: Infinity,
        };
        }
        }
        
        
    };
    
    return nearest;
};
//}

// loading vars
var loadCount = 0;
var toLoad = [];
var showChunkCollisions = false;

// Chunk system
var loadCap = 1;
var otherLoadCap = 15;

var chunkSize = 10;

//var otherOtherLoadCap = 19;

function getChunk(x,y){
return {
x:floor((x+100000)/chunkSize),
y:floor((y+100000)/chunkSize),
};
}

// render
function toRenderAt(x,y){

if(chunks[getChunk(x,y).y]){
if(chunks[getChunk(x,y).y][getChunk(x,y).x]){
return chunks[getChunk(x,y).y][getChunk(x,y).x];
}
}
return [];
}
// render +1 chunk radius
function allRenderAt(x,y){
var ret = [];
for(var z = -1; z < 2; z++){
for(var c = -1; c < 2; c++){
var rend = toRenderAt(x+(z*chunkSize),y+(c*chunkSize));
for(var i = 0; i < rend.length; i++){
//this.collide(rend[i]);
//println(rend[i][1].type);
ret.push(rend[i]);
}
}
}
return ret;
}
// render +player size
function fatRenderAt(x,y,pl){
var ret = [];
var wid = 1;
wid = getSize(pl.size)/chunkSize;

for(var z = -wid; z < 1+wid; z++){
for(var c = -wid; c < 1+wid; c++){
var rend = toRenderAt(x+(z*chunkSize),y+(c*chunkSize));

for(var i = 0; i < rend.length; i++){

//this.collide(rend[i]);
//println(rend[i][1].type);
ret.push(rend[i]);
}
}
}
return ret;
}
function giveChunk(x,y,e){
if(!chunks[y]){
chunks[y] = [];
}
if(!chunks[y][x]){
chunks[y][x] = [];
}
if(!chunks[y][x].includes(e)){
chunks[y][x].push(e);
if(!e[1].chunksIn){
e[1].chunksIn = [];
}
e[1].chunksIn.push([y,x]);
}
}
var numbersBetween = function(a,b){
var ret = [];

//println(a+' , '+b);
if(a === b){
ret.push(a);
}else{
ret.push(a);
ret.push(b);
}
if(a > b){
for(var i = b; i < a; i+= 1){
ret.push(i);
}

}
if(b > a){
for(var i = a; i < b; i+= 1){

ret.push(i);

}

}
return ret;
};
//numbersBetween = DeKhan.loopDetect(numbersBetween);
function getBetween(x,y,x2,y2){
var ret = [];
//println(x+','+y+','+x2+','+y2);
for(var i = 0; i < numbersBetween(x,x2).length; i++){
for(var q = 0; q < numbersBetween(y,y2).length; q++){
ret.push({
x:numbersBetween(x,x2)[i],
y:numbersBetween(y,y2)[q],
});
}
}
return ret;
}

var startLoading = function(){
loadCount = 0;
scene = 'loading';
toLoad = [];
for(var i = 0; i < walls.length; i++){
switch(walls[i].type){
case 'polygon':
for(var q = 0; q < walls[i].data.length; q++){
toLoad.push({point:walls[i].data[q],owner:walls[i],pos:q});
}
break;
case 'circle':
toLoad.push({point:walls[i].data,owner:walls[i]});
break;
}
}
//println(toLoad[147].point.y);
};
//startLoading = DeKhan.loopDetect(startLoading);
// trashy laggy computer crashing load system
var loadChunksa = function(){
// var i = loadCount;
// var loadRewind = false;
// //println(i);
// if(!walls[i]){
// println(i);
// }
//println(walls[i]);
for(var i = 0; i < walls.length; i++){
switch(walls[i].type){
case 'polygon':
{
//     var loadAddAlt = 0;
//     var max = walls[i].data.length;
//     if(walls[i].data.length > (loadCap)+(loadCap*walls[i].loadRew)){
//     //println(walls[58].data[19]);
//     walls[i].loadRew += 1;
//     walls[i].loadRew = round(walls[i].loadRew);
//     loadRewind = true;
//     max = (loadCap*walls[i].loadRew);
//     if(max > walls[i].data.length){
//         max = walls[i].data.length;
//     }
// }else{
// loadAddAlt = 1;
// }
    //println('max: '+max);
//for(var q = 0+(loadCap*(walls[i].loadRew-1+loadAddAlt)); q < max; q++){
for(var q = 0; q < walls[i].data.length; q++){
    //println(q);
var aVert = walls[i].data[q];
giveChunk(getChunk(aVert.x,aVert.y).x,getChunk(aVert.x,aVert.y).y,walls[i]);


var cVert = false;
if(q+1 !== walls[i].data.length){
cVert = walls[i].data[q+1];
}else{
cVert = walls[i].data[0];
}
if(cVert && dist(cVert.x,cVert.y,aVert.x,aVert.y) >= chunkSize){
var chunkA = getChunk(cVert.x,cVert.y);
var chunkB = getChunk(aVert.x,aVert.y);
//println('e');
//println(getBetween(chunkA.x,chunkA.y,chunkB.x,chunkB.y).length);
for(var z = 0; z < getBetween(chunkA.x,chunkA.y,chunkB.x,chunkB.y).length; z++){

giveChunk(getBetween(chunkA.x,chunkA.y,chunkB.x,chunkB.y)[z].x,getBetween(chunkA.x,chunkA.y,chunkB.x,chunkB.y)[z].y,walls[i]);
}
}
}



}
break;
case 'circle':
{
for(var z = -1-(floor(walls[i].data.r/chunkSize)); z < 2+(floor(walls[i].data.r/chunkSize)); z++){
for(var c = -1-(floor(walls[i].data.r/chunkSize)); c < 2+(floor(walls[i].data.r/chunkSize)); c++){
giveChunk(getChunk(walls[i].data.x,walls[i].data.y).x+z,getChunk(walls[i].data.x,walls[i].data.y).y+c,walls[i]);
}
}
}
break;
}
}
scene = 'game';
// if(loadCount < walls.length-1 && !loadRewind){
// loadCount++;
// loadCount = round(loadCount);
// }
};
// working good load system
var loadChunksb = function(){
var i = loadCount;
//println(toLoad[i].owner.type);
switch(toLoad[i].owner.type){
case 'polygon':
{
    //println(q);
var aVert = toLoad[i].point;
giveChunk(getChunk(aVert.x,aVert.y).x,getChunk(aVert.x,aVert.y).y,[aVert,toLoad[i].owner]);


var cVert = false;
if(toLoad[i].pos+1 !== toLoad[i].owner.data.length){
cVert = toLoad[i].owner.data[toLoad[i].pos+1];
}else{
cVert = toLoad[i].owner.data[0];
}
if(cVert && dist(cVert.x,cVert.y,aVert.x,aVert.y) >= chunkSize){
//if(cVert){
//{
var chunkA = getChunk(cVert.x,cVert.y);
var chunkB = getChunk(aVert.x,aVert.y);
//println('e');
var between = getBetween(chunkA.x,chunkA.y,chunkB.x,chunkB.y);
for(var z = 0; z < between.length; z++){
//println('e');
giveChunk(between[z].x,between[z].y,[aVert,toLoad[i].owner]);
//giveChunk(between[z].x,between[z].y,[cVert,toLoad[i].owner]);
}
}




}
break;
case 'circle':
{
for(var z = -1-(floor(toLoad[i].owner.data.r/chunkSize)); z < 2+(floor(toLoad[i].owner.data.r/chunkSize)); z++){
for(var c = -1-(floor(toLoad[i].owner.data.r/chunkSize)); c < 2+(floor(toLoad[i].owner.data.r/chunkSize)); c++){
giveChunk(getChunk(toLoad[i].owner.data.x,toLoad[i].owner.data.y).x+z,getChunk(toLoad[i].owner.data.x,toLoad[i].owner.data.y).y+c,[toLoad[i].owner.data,toLoad[i].owner]);
}
}
}
break;
}

//scene = 'game';
// if(loadCount < walls.length-1 && !loadRewind){
// loadCount++;
// loadCount = round(loadCount);
// }
};
// backup of b because it worked and if i make it not work anymore then i have a backup
var loadChunksc = function(){
var i = loadCount;
//println(toLoad[i].owner.type);
switch(toLoad[i].owner.type){
case 'polygon':
{
    //println(q);
var aVert = toLoad[i].point;
giveChunk(getChunk(aVert.x,aVert.y).x,getChunk(aVert.x,aVert.y).y,toLoad[i].owner);


var cVert = false;
if(toLoad[i].pos+1 !== toLoad[i].owner.data.length){
cVert = toLoad[i].owner.data[toLoad[i].pos+1];
}else{
cVert = toLoad[i].owner.data[0];
}
if(cVert && dist(cVert.x,cVert.y,aVert.x,aVert.y) >= chunkSize){
var chunkA = getChunk(cVert.x,cVert.y);
var chunkB = getChunk(aVert.x,aVert.y);
//println('e');
var between = getBetween(chunkA.x,chunkA.y,chunkB.x,chunkB.y);
for(var z = 0; z < between.length; z++){
//println('e');
giveChunk(between[z].x,between[z].y,toLoad[i].owner);
}
}




}
break;
case 'circle':
{
for(var z = -1-(floor(toLoad[i].owner.data.r/chunkSize)); z < 2+(floor(toLoad[i].owner.data.r/chunkSize)); z++){
for(var c = -1-(floor(toLoad[i].owner.data.r/chunkSize)); c < 2+(floor(toLoad[i].owner.data.r/chunkSize)); c++){
giveChunk(getChunk(toLoad[i].owner.data.x,toLoad[i].owner.data.y).x+z,getChunk(toLoad[i].owner.data.x,toLoad[i].owner.data.y).y+c,toLoad[i].owner);
}
}
}
break;
}

//scene = 'game';
// if(loadCount < walls.length-1 && !loadRewind){
// loadCount++;
// loadCount = round(loadCount);
// }
};
//loadChunks = DeKhan.loopDetect(loadChunks);  
function clearPath(x,y,x2,y2){
var ret = true;

var dir = atan2(y2-y,x2-x);
var bDist = dist(x,y,x2,y2);

var num = bDist/5;

for(var i = 0; i < num; i++){
var retx = x + (cos(dir) * ((bDist / num) * i));
var rety = y + (sin(dir) * ((bDist / num) * i));
var rend = toRenderAt(retx,rety);
//println(rend[0][1].data.length);
for(var q = 0; q < rend.length; q++){
switch(rend[q][1].type){
case 'polygon':
if(isInside(rend[q][1].data, rend[q][1].data.length, {x:retx,y:rety})){
ret = false;
return false;
//println(q);
}
break;
case 'circle':
if(dist(retx,rety,rend[q][1].data.x,rend[q][1].data.y) <= rend[q][1].data.r){
ret = false;
return false;
}
break;
}
}
}

return ret;
}
function fatClearPath(x,y,x2,y2,pl){
var ret = true;

var dir = atan2(y2-y,x2-x);
var bDist = dist(x,y,x2,y2);

var num = bDist/5;

for(var i = 0; i < num; i++){
var retx = x + (cos(dir) * ((bDist / num) * i));
var rety = y + (sin(dir) * ((bDist / num) * i));
var rend = toRenderAt(retx,rety);
//println(rend[0][1].data.length);
for(var q = 0; q < rend.length; q++){
switch(rend[q][1].type){
case 'polygon':
if(isInside(rend[q][1].data, rend[q][1].data.length, {x:retx,y:rety})){
ret = false;
return false;
//println(q);
}
break;
case 'circle':
if(dist(retx,rety,rend[q][1].data.x,rend[q][1].data.y) <= rend[q][1].data.r){
ret = false;
return false;
}
break;
}
}
}

return ret;
}
function obsFrom(x,y,x2,y2,pl){
var ret = [];

var dir = atan2(y2-y,x2-x);
var bDist = dist(x,y,x2,y2);

var num = bDist/5;

for(var i = 0; i < num; i++){
var retx = x + (cos(dir) * ((bDist / num) * i));
var rety = y + (sin(dir) * ((bDist / num) * i));
var rend = toRenderAt(retx,rety,pl);
//println(rend[0][1].data.length);
for(var q = 0; q < rend.length; q++){
switch(rend[q][1].type){
case 'polygon':
if(isInside(rend[q][1].data, rend[q][1].data.length, {x:retx,y:rety})){
ret.push([{x:retx,y:rety},rend[q][1]]);
//println(q);
}
break;
case 'circle':
if(dist(retx,rety,rend[q][1].data.x,rend[q][1].data.y) <= rend[q][1].data.r){
ret.push([{x:retx,y:rety},rend[q][1]]);
}
break;
}
}
}

return ret;
}
function player(){
this.x = 0; this.y = 0;
this.px = 0; this.py = 0;
this.vx = 0; this.vy = 0; this.trot = 0; this.onUseRot = false;
this.size = 1; this.rot = 0; this.charge = 0; 
this.tvx = 0; this.tvy = 0;
this.tCount = 0; this.pCharge = 0;  this.pUsed = false; this.pcUsed = false; this.powerSelect = 0; this.contAway = [];
this.selected = 0; this.attacked = false;
this.cooldown = 1000; this.handMove = 'punch'; this.currentPath = 0; this.pCooldown = [1000,1000,1000,1000,1000,1000,1000,1000];
this.color = color(245, 245, 245); this.name = 'random person';
this.health = 10; this.acc = 0.1; this.weapons = [];
this.use = weapons[0][1]; this.curHands = [{transX:0,transY:0},{transX:0,transY:0}]; this.powerNames = []; this.rand = random(0,10000); this.buffs = {};
this.sight = {
x:width,
y:height,
};
this.handMove = this.use.anim;
this.sweeping = false; this.pAttacked = false;
this.sweepRad = this.use.sweep;
this.onSwingRot = false; this.newTargTimer = 0; this.newpTargTimer = 0;
this.que = []; this.hitYet = [];this.enemies = [];
this.hands = [{transX:0,transY:0},{transX:0,transY:0}];
this.keep = false; this.dirs = []; this.targDir = 0; this.colCount = 0;
players.push(this);
}
function getWeaponStats(e){
for(var i = 0; i < weapons.length; i++){
if(weapons[i][0] === e){
return weapons[i][1];
}
}
}
function getAbilityStats(e){
for(var i = 0; i < abilities.length; i++){
if(abilities[i][0] === e){
//println(abilities[i][1].swing);
return abilities[i][1];
}
}
}
function getPowerStats(e){
for(var i = 0; i < powers.length; i++){
if(powers[i][0] === e){
//println(abilities[i][1].swing);
return powers[i][1];
}
}
}
function drawWeapon(name, e, c, pos) {
    e.hands = [{transX:0,transY:0},{transX:0,transY:0}];
    if(db && e.use){
    pushMatrix();
    resetMatrix();
    stroke(0, 255, 4);
    line(e.x,e.y,e.x+cos(e.rot)*((e.size*e.use.reach)+(30*e.size/2)),e.y+sin(e.rot)*((e.size*e.use.reach)+(30*e.size/2)));
    stroke(255, 0, 0);
    line(e.x,e.y,e.x+cos(e.rot+e.use.sweep)*80,e.y+sin(e.rot+e.use.sweep)*80);
    line(e.x,e.y,e.x+cos(e.rot-e.use.sweep)*80,e.y+sin(e.rot-e.use.sweep)*80);
    popMatrix();
    }
    
    stroke(0, 0, 0);
    strokeWeight(2);
    pushMatrix();
    if(pos){
    translate(e.x, e.y);
    }
    // if(e.size !== 1){
    // scale(e.size);
    // }
    var toRotate = e.rot;
    if(pos){
    rotate(toRotate);
    }
    strokeWeight(2);

    //melee
    {
        if(name.includes('wooden')) {
            fill(102, 56, 15);
            stroke(0, 0, 0);
        }
        if(name.includes('stone')) {
            fill(140, 140, 140);
            stroke(0, 0, 0);
        }
        if(name.includes('iron')) {
            fill(219, 219, 219);
            stroke(0, 0, 0);
        }
        if(name.includes('steel')) {
            fill(92, 92, 92);
            stroke(0, 0, 0);
        }
        if(name.includes('heavy')) {
            fill(28, 28, 28);
            stroke(0, 0, 0);
        }
        if(name.includes('fire')) {
            fill(214, 92, 21);
            stroke(0, 0, 0);
        }
        if(name.includes('geist')) {
            fill(207, 58, 202);
            stroke(18, 18, 18);
            //x,y,r,c,t,t2,tp
            if(!pos){
            var geistPart = new effect(e.x+cos(toRotate)*20+random(-20,20),e.y+sin(toRotate)*20+random(-20,20),random(1,15),choice(color(128, 0, 128),color(0, 0, 0)),random(0,100),random(3,6));
            geistPart.vx = random(-0.4,0.4);
            geistPart.vy = random(-0.4,0.4);
            }
        }
        if(name.includes('dragon scale')) {
            fill(150, 9, 9);
            stroke(0, 0, 0);
        }
        if(name.includes('isaac')) {
            fill(0, 255, 111);
            stroke(0, 0, 0);
        }
        if(name.includes('lazer beam')){
        fill(143, 0, 143,100);
        noStroke();
        if(e.cooldown < 1 || !e.cooldown){
        ellipse(25,0,20,20);
        }
        if(e.cooldown < 1){
        for(var q = 0; q<2; q++){
        ellipse(25+random(-3,3),random(-3,3),20,20);
        }
        }
        }
        if(name.includes('greatsword')){
            e.hands = [{transX:8,transY:0},{transX:5,transY:0}];
           
pushMatrix();
scale(0.4);
translate(-150,-70);
//just some variables I used to make matching the colors easier
var crossguardColor = color(138, 138, 138);
var goldenHighlight = color(207, 203, 79);
strokeWeight(5);


//blade
//fill(255, 255, 255);
beginShape();
vertex(185, 179);
vertex(187, 256);
vertex(179, 245);
vertex(188, 485);
vertex(217, 485);
vertex(226, 245);
vertex(218, 256);
vertex(220, 179);
endShape(CLOSE);
// for (var i = 0; i < 3; i+=1) {
// noStroke();    
// fill(189, 189, 189, 100);
// rect(i*3+(3/4)+188, 180, 20, 305);    
// }
noFill();
//stroke(0, 0, 0);
beginShape();
vertex(190, 179);
vertex(192, 269);
vertex(184, 259);
vertex(193, 485);
vertex(212, 485);
vertex(221, 259);
vertex(213, 269);
vertex(215, 179);
endShape(CLOSE);
line(221, 260, 226, 246);
line(184, 260, 179, 246);


//crossguard
fill(crossguardColor);
beginShape();
vertex(183, 180);
vertex(192, 180);
vertex(203, 195);
vertex(213, 180);
vertex(222, 180);
bezierVertex(248, 150, 250, 180, 286, 160);
bezierVertex(248, 145, 250, 172, 217, 140);
vertex(189, 140);
bezierVertex(155, 172, 155, 145, 118, 160);
bezierVertex(155, 180, 164, 150, 183, 180);
endShape(CLOSE);
beginShape();
vertex(190, 140);
vertex(217, 140);
bezierVertex(210, 120, 279, 156, 237, 209);
bezierVertex(255, 214, 291, 133, 217, 120);
vertex(191, 120);
bezierVertex(149, 122, 126, 169, 167, 209);
bezierVertex(133, 148, 190, 128, 190, 136);
endShape(CLOSE);
fill(goldenHighlight);
rect(239, 156, 5, 9);
rect(160, 156, 5, 9);
triangle(198, 181, 208, 181, 203, 189);
noFill();
ellipse(203, 160, 30, 28);
//image(getImage("creatures/Winston"), 193, 151, 20, 20);

arc(224, 171, 145, 121, 145, 212);
arc(182, 171, 145, 121, 329, 399);
arc(179, 161, 95, 25, 526, 556);
line(126, 160, 131, 160);
arc(225, 161, 95, 25, 705, 735);
line(273, 160, 277, 160);


//hilt
fill(goldenHighlight);
rect(194, 24, 18, 11);
fill(crossguardColor);
rect(196, 35, 14, 7);
rect(195, 42, 14, 10);
fill(goldenHighlight);
rect(196, 52, 14, 5);
fill(crossguardColor);
rect(196, 57, 14, 11);
rect(196, 68, 14, 10);
rect(197, 78, 14, 11);
fill(goldenHighlight);
rect(196, 89, 14, 7);
fill(crossguardColor);
rect(196, 96, 14, 16);
fill(goldenHighlight);
rect(191, 111, 24, 8);


fill(goldenHighlight);
beginShape();
vertex(198, 2);
bezierVertex(186, 16, 189, 30, 203, 29);
bezierVertex(229, 31, 214, -1, 209, 2);
bezierVertex(221, 25, 188, 25, 199, 2);
endShape(CLOSE);
fill(255, 0, 0);
ellipse(203,161,20,20);
popMatrix();
        }else if(name.includes('sword')) {
                pushMatrix();
                // if(c < 10){
                // translate(8-(c / (10 / 8)),0);
                // }
                beginShape();
                vertex(28, 7);
                vertex(28, 14);
                vertex(38, 16);
                vertex(48, 10.5);
                vertex(38, 5);
                endShape(CLOSE);
                fill(102, 56, 15);
                rect(15, 6.5, 10, 5);
                rect(23, 4.5, 5, 10);
                popMatrix();
        }
        if(name.includes('stick')) {
            pushMatrix();
                // if(c < 10){
                // translate(8-(c / (10 / 8)),0);
                // }
                fill(102, 56, 15);
                rect(15, 6.5, 35, 4);
                
            popMatrix();
        }
        if(name.includes('katana')) {
            
            pushMatrix();
                // if(c < 10){
                // translate(8-(c / (10 / 8)),0);
                // }
                beginShape();
                vertex(28, 8);
                vertex(28, 13);
                vertex(58, 12);
                vertex(70, 9);
                vertex(70, 6);
                vertex(28, 8);
                endShape(CLOSE);
                fill(102, 56, 15);
                rect(15, 6.5, 10, 5);
                rect(23, 4.5, 5, 10);
            popMatrix();
        }
        if(name.includes('dagger')) {
            pushMatrix();
                // if(c < 10){
                // translate(8-(c / (10 / 8)),0);
                // }
                beginShape();
                vertex(25, 7);
                vertex(25, 14);
                vertex(30, 15);
                vertex(43, 10.5);
                vertex(30, 6);
                endShape(CLOSE);
                fill(102, 56, 15);
                rect(15, 6.5, 10, 5);
                rect(21, 5, 5, 9.5);
            popMatrix();
        }
        if(name.includes('spear')) {
            e.hands = [{transX:10,transY:10},{transX:0,transY:0}];
            pushMatrix();
            translate(20,-3);
                // if(c < 10){
                // translate(8-(c / (10 / 8)),0);
                // }
                triangle(70, 6.5, 70, 12.5, 81, 9.5);
                stroke(0, 0, 0);
            popMatrix();
                fill(102, 56, 15);
                rect(15, 7.5-3, 74, 3);
            
        }
        if(name.includes('staff')) {
            pushMatrix();
                // if(c < 10){
                // translate(-8+ (c / (10 / 8)),0);
                // }
                triangle(9, -20, 15, -20, 12, -25);
                triangle(15, -20, 21, -20, 18, -25);
                rect(9, -20, 12, 5);
                fill(59, 59, 59);
                rect(15, -15, 3, 35);
            popMatrix();
        }
        if(name.includes('axe')) {
            e.hands = [{transX:0,transY:-3},{transX:0,transY:3}];
            pushMatrix();
                // if(c < 10){
                // translate(-8+ (c / (10 / 8)),0);
                // }
                pushMatrix();
                translate(2,-30);
                
                triangle(-10, -10, 15, -20, -10, -30);
                triangle(40,-10, 15, -20, 40, -30);
                rect(9, -25, 12, 10);
                popMatrix();
                fill(59, 59, 59);
                rect(15, -45, 3, 65);
                
            popMatrix();
        }
        if(name.includes('digital smasher')) {
            fill(0, 148, 22);
            e.hands = [{transX:0,transY:-3},{transX:0,transY:3}];
            pushMatrix();
                // if(c < 10){
                // translate(-8+ (c / (10 / 8)),0);
                // }
                pushMatrix();
                var mult = 0.5;
                if(round(random(1,100)) === 10){
                mult = 4;
                }
                var nums = {
                x:random(-1,1)*mult,
                y:random(-1,1)*mult,
                };
                translate(2+nums.x,-31+nums.y);
                beginShape();
                vertex(-10,-10);
                vertex(15,-15);
                vertex(40,-10);
                vertex(40,-27);
                vertex(15,-25);
                vertex(-10,-27);
                endShape(CLOSE);
                strokeWeight(2);
                stroke(0, 255, 34,200+cos(frameCount+60)*40);
                line(38,-13,24,-18);
                stroke(0, 255, 34,200+cos(frameCount+120)*40);
                line(24,-18,6,-18);
                stroke(0, 255, 34,200+cos(frameCount+180)*40);
                line(-8,-23,6,-18);
                stroke(0, 255, 34);
                line(9,-22,35,-22);
                stroke(0, 0, 0);
                //triangle(-10, -13, 25, -20, -10, -27);
                //triangle(40,-13, 5, -20, 40, -27);
                //rect(9, -25, 12, 10);
                popMatrix();
                fill(59, 59, 59);
                rect(15, -45, 3, 65);
                pushMatrix();
                noStroke();
                fill(0, 148, 22, 150);
                var mult = 0.5;
                if(round(random(1,100)) === 10){
                mult = 4;
                }
                var nums = {
                x:random(-1,1)*mult,
                y:random(-1,1)*mult,
                };
                scale(1.2);
                translate(-1+nums.x,-23+nums.y);
                beginShape();
                vertex(-10,-10);
                vertex(15,-15);
                vertex(40,-10);
                vertex(40,-27);
                vertex(15,-25);
                vertex(-10,-27);
                endShape(CLOSE);
                popMatrix();
                
            popMatrix();
        }
        if(name.includes('BURRITO')) {
            textSize(30);
            fill(0, 0, 0);
            pushMatrix();
            rotate(33);

            textAlign(LEFT, BASELINE);
            text('🌯', 0, -5);
            popMatrix();
        }
    }
    //ranged
    {
        strokeWeight(2);
        if(name.includes('wooden')) {
            fill(102, 56, 15);
            stroke(102, 56, 15);
        }
        if(name.includes('stone')) {
            fill(140, 140, 140);
            stroke(140, 140, 140);
        }
        if(name.includes('iron')) {
            fill(219, 219, 219);
            stroke(105, 105, 105);
        }
        if(name.includes('fwoggy')) {
            fill(13, 112, 0);
            stroke(0, 0, 0);
        }
        if(name.includes("crime boss'")) {
            fill(255, 196, 0);
            stroke(255, 196, 0);
        }
        if(name.includes("artemis")) {
            fill(99, 70, 35);
            stroke(74, 57, 3);
        }
        if(name.includes('hailstorm')) {

            fill(255, 255, 255);
            stroke(199, 199, 199);
        }
        if(name.includes('bow')) {
            pushMatrix();
                // if(c < 10){
                // translate(-8+ (c / (10 / 8)),0);
                // }
                if(e.charge){
                e.hands = [{transX:0,transY:-2},{transX:0,transY:-10}];
                }else{
                e.hands = [{transX:0,transY:-2},{transX:0,transY:2}];
                }
                
                noFill();
                strokeWeight(4);
                arc(14, 0, 20, 40, 270, 450);
                if(name.includes('recurve bow')){
                arc(14, -25.5, 4, 9, 90, 270);
                arc(14, 25.5, 4, 9, 90, 270);
                }else{
                arc(14, -25.5, 4, 9, 90, 200);
                arc(14, 25.5, 4, 9, 160, 270);
                }
                stroke(0,0,0);
                strokeWeight(2);
                //line(11, -25, 11, 25);
                line(11, -25, 11-e.charge, 0);
                line(11, 25, 11-e.charge, 0);
                if(e.charge > 0){
                pushMatrix();
                if(e.charge < 5){
                translate(10,0);
                rotate(100-e.charge*20);
                translate(-10,-0);
                }
                translate(-e.charge+25,0);
                projGraphics(e.use.type);
                popMatrix();
                }
            popMatrix();
        }
        if(name.includes('boomerang')) {
        
        pushMatrix();
        if((!e.name || e.cooldown > e.use.cooldown)){
        translate(15,10);
        rotate(10);
        projGraphics('boomerang');
        }else{
        if(e.cooldown > e.use.cooldown-10){
        e.hands = [{transX:0,transY:0},{transX:15-(e.use.cooldown-e.cooldown)*3,transY:3}];
        translate(15-(e.use.cooldown-e.cooldown)*3,10);
        rotate(10+(e.use.cooldown-e.cooldown)*10);
        projGraphics('boomerang');
        }
        }
popMatrix();
        }
        if(name.includes('dragon breath')){
                    fill(133, 0, 0);
                    
                    // if(c < 10){
                    // pushMatrix();
                    // translate(0,((10-c)/2));
                    // triangle(12 + c / (10 / 8),12,22 + c / (10 / 8),10,2 + c / (10 / 8),10);
                    // triangle(9 + c / (10 / 8),9,19 + c / (10 / 8),7,-1 + c / (10 / 8),7);
                    // triangle(15 + c / (10 / 8),15,19 + c / (10 / 8),13,5 + c / (10 / 8),13);
                    
                    // popMatrix();
                    
                    // pushMatrix();
                    // translate(0,-((10-c)/2));
                    // triangle(12 + c / (10 / 8),-12,22 + c / (10 / 8),-10,2 + c / (10 / 8),-10);
                    // triangle(9 + c / (10 / 8),-9,19 + c / (10 / 8),-7,-1 + c / (10 / 8),-7);
                    // triangle(15 + c / (10 / 8),-15,19 + c / (10 / 8),-13,5 + c / (10 / 8),-13);
                    // popMatrix();
                    // // triangle(21 + c / (10 / 8),-9,19 + c / (10 / 8),-7,-15 + c / (10 / 8),-7);
                    // // triangle(19 + c / (10 / 8),-12,-5 + c / (10 / 8),-12,-10 + c / (10 / 8),-1);
                    // // triangle(17 + c / (10 / 8),-16,7 + c / (10 / 8),-15,-10 + c / (10 / 8),-1);
                    // }else{
                    triangle(20,12,30,10,10,10);
                    triangle(17,9,27,7,7,7);
                    triangle(23,15,27,13,13,13);
                    
                    
                    triangle(20,-12,30,-10,10,-10);
                    triangle(17,-9,27,-7,7,-7);
                    triangle(23,-15,27,-13,13,-13);
                    //}
                    pushMatrix();
                    translate(5,0);
                    rotate(sin(frameCount*1.5)*15 + 7.5);
                    quad(-34,-5,-34,-13,-40,-25,5,-5);
                    popMatrix();
                    pushMatrix();
                    translate(5,0);
                    rotate(sin(frameCount*1.5)*-15 - 7.5);
                    quad(-34,5,-34,13,-40,25,5,5);
                    //quad(-24,5,-24,13,-30,25,5,10);
                    popMatrix();
        }
        if(name.includes('blaster')){
            pushMatrix();
            if(c >= 10){
            //translate(-10,0);
            e.hands = [{transX:10,transY:0},{transX:10,transY:0}];
            
            }
            rect(20,-20,5,20);
            pushMatrix();
            var follow = false;
            if(e){
            if(c < 10){
            if(e.que){
                if(e.que[0]){
                if(e.que[0].type === 'delay'){
                
            translate((-10) - c / (10 / 8), 0);
            }else{
                follow = true;
            }
            }else{
                follow = true;
            }
            }else{
                //follow = true;
            }
            if(follow){
                
        translate((-10-(frameCount/e.use.frequency - ceil(frameCount/e.use.frequency))*10) - c / (10 / 8),0);
        
            }
            }
            }
            rect(20,0,5,20);
            popMatrix();
            fill(77, 77, 77);
            rect(10,-8,20,16,5);
            if(e.rot && e.size){
            if(frameCount/10 === round(frameCount/10)){
    var poof = new effect(e.x+cos(e.rot)*e.size*29,e.y+sin(e.rot)*e.size*29,random(7,15),choice(color(89, 89, 89),color(212, 110, 32)),random(0,255),random(2,5));
    poof.vx = cos(e.rot+random(-60,60))*0.5;
    poof.vy = sin(e.rot+random(-60,60))*0.5;
            }
            }
            popMatrix();
        }
    }

    popMatrix();

}
function handa(x,y,e){
    
pushMatrix();
if(e.health){
e.curHands[0].transX = lerp(e.curHands[0].transX,e.hands[0].transX,0.3);
e.curHands[0].transY = lerp(e.curHands[0].transY,e.hands[0].transY,0.3);
translate(e.curHands[0].transX,e.curHands[0].transY);
}
if(e === p){
    //println(e.curHands[0].transX);
    }
if(e.looks.handL&&e.looks.handLCustom===1){

}else{
    
fill(e.looks.color);
stroke(0, 0, 0);
strokeWeight(2);
ellipse(x,y,10,10);
}
fill(e.looks.color);
stroke(0, 0, 0);
strokeWeight(2);
if(e.looks.handL){
pushMatrix();
translate(x,y);
e.looks.handL();
popMatrix();
}
popMatrix();
}
function handb(x,y,e){
pushMatrix();
if(e.health){
e.curHands[1].transX = lerp(e.curHands[1].transX,e.hands[1].transX,0.3);
e.curHands[1].transY = lerp(e.curHands[1].transY,e.hands[1].transY,0.3);

translate(e.curHands[1].transX,e.curHands[1].transY);
}
if(e.looks.handR&&e.looks.handRCustom===1){

}else{
fill(e.looks.color);
stroke(0, 0, 0);
strokeWeight(2);
ellipse(x,y,10,10);
}
fill(e.looks.color);
stroke(0, 0, 0);
strokeWeight(2);
if(e.looks.handR){
pushMatrix();
translate(x,y);
e.looks.handR();
popMatrix();
}
popMatrix();

}
function noanimhanda(x,y,e){
pushMatrix();
// e.curHands[0].transX = lerp(e.curHands[0].transX,e.hands[0].transX,0.3);
// e.curHands[0].transY = lerp(e.curHands[0].transY,e.hands[0].transY,0.3);
// translate(e.curHands[0].transX,e.curHands[0].transY);
ellipse(x,y,10,10);
popMatrix();
}
function noanimhandb(x,y,e){
pushMatrix();
// e.curHands[1].transX = lerp(e.curHands[1].transX,e.hands[1].transX,0.3);
// e.curHands[1].transY = lerp(e.curHands[1].transY,e.hands[1].transY,0.3);

// translate(e.curHands[1].transX,e.curHands[1].transY);
ellipse(x,y,10,10);
popMatrix();
}
function drawHands(e,c,t){
if(e.hands){
if(!e.hands[0].transX||!e.hands[0].transY||!e.hands[1].transX||!e.hands[1].transY){
e.hands = [{transX:0,transY:0},{transX:0,transY:0}];
}
}
if(e.curHands){
if(!(e.curHands[0].transX||e.curHands[0].transX===0)||!(e.curHands[0].transY||e.curHands[0].transY===0)||!(e.curHands[1].transX||e.curHands[1].transX===0)||!(e.curHands[1].transY||e.curHands[1].transY===0)){
e.curHands = [{transX:0,transY:0},{transX:0,transY:0}];
}
}
    pushMatrix();
    translate(e.x, e.y);
    if(e.size !== 1){
    scale(e.size);
    }
    rotate(e.rot);
    if(e.use.altAnim){
    t = e.use.altAnim;
    }
        pushMatrix();
        if(c < 10){
        switch(t){
        case 'twang':
        translate(8-(c / (10 / 8)),0);
        break;
        case 'stretch':
        translate(-8+(c / (10 / 8)),((10-c)/2));
        break;
        case 'throw':
        translate(-19+(c / (10 / 19)),((10-c)/2));
        break; 
        case 'back':
        translate(-8+(c / (10 / 8)),0);
        break;
        case 'thrust':
        translate(8-(c / (10 / 8)),0);
        break;
        }
        }
        switch(t){
        case 'cast1':
        translate(0.5+sin(frameCount*2)*5,0);
        break;
        }
        if(e.noWeaponDraw){
        }else{
        drawWeapon(e.weapons[e.selected],e,c);
        }
        e.noWeaponDraw = false;
        popMatrix();
        fill(e.looks.color);
        stroke(0, 0, 0);
    if(t === 'cast1'){    
        handa(8+abs(sin(frameCount*3))*7, -10+sin(frameCount*7)*4, e);
        handb(15.5+sin(frameCount*2)*5, 10, e);
        
    } else if(t === 'twang'&&c<10){    
        handa(23 - c / (10 / 8), -10,e);
        handb(23- e.charge - c / (10 / 8), 10,e);
    
    } else if(t === 'frequency twang'&&c<10){    
        handa(23 - c / (10 / 8), -10,e);
        if(e.que && e.que[0] && e.que[0].type === 'delay'){
            handb(23+ (-10) - c / (10 / 8), 10,e);
        }else{
        handb(23+ (-10-(frameCount/e.use.frequency - ceil(frameCount/e.use.frequency))*10) - c / (10 / 8), 10,e);
        }
    
    } else if(t === 'firebreath'&&c<10){    
        handa(7 + c / (10 / 8), -10-((10-c)/2),e);
        handb(7 + c / (10 / 8), 10+((10-c)/2),e);
    
    } else if(t === 'throw'&&c<10){    
        handa(-4 + c / (10 / 19), -10-((10-c)/2),e);
        handb(-4 + c / (10 / 19), 10+((10-c)/2),e);
    
    } else if(t === 'back'&&c<10){    
        handa(7 + c / (10 / 8), -10,e);
        handb(7 + c / (10 / 8), 10,e);
    } else if(t === 'thrust'&&c<10){
        
        handa(23 - c / (10 / 8), -10,e);
        handb(23 - c / (10 / 8), 10,e);
    } /*else if(t === 'sweep'&&e.sweeping){
    
    } */else if(t === 'punch'&&c<10){
        
        if(e.cooldown === 0){
        e.punchSide = floor(random(0,2));
        }
        
        switch(e.punchSide){
        case 0:
        handa(23 - c / (10 / 8), -10,e);
        handb(15, 10,e);
        break;
        case 1:
        handa(15, -10,e);
        handb(23 - c / (10 / 8), 10,e);
        break;
        }
    
    }else if(t.includes('throw ')&&c<10){
        if(t.includes('left')){
        handa(23 - c / (10 / 8), -10,e);
        handb(15, 10,e);
        }else{
        handa(15, -10,e);
        handb(23 - c / (10 / 8), 10,e);
        }
    
    } else {
        
        e.sHandMove = 'none';
        //drawWeapon(e.weapons[e.selected],e,c);
        fill(e.looks.color);
        stroke(0, 0, 0);
        handa(15, -10,e);
        handb(15, 10,e);
    }
    popMatrix();
}
function d(a,b){
return dist(a.x,a.y,b.x,b.y);
}
function space(a,b){
return abs(a-b);
}
function angle(a,b){
return atan2(b.y-a.y,b.x-a.x);
}
function angleDiff(a,b){
//var diff = mod(b - a + 180, 360);
var diff = abs(b-a)+180;
while(diff >= 360){
diff -= 360;
}
diff = abs(diff-180);
return diff;
}
function noAbsAngleDiff(a,b){
//var diff = mod(b - a + 180, 360);
var diff = abs(b-a)+180;
while(diff >= 360){
diff -= 360;
}
diff = diff-180;
return diff;
}
function hitDiff(a,b){
return (a.use.reach*a.size)+(getSize(b.size))+(getSize(a.size));
}
player.prototype.become = function(name){
for(var i = 0; i < people.length; i++){
if(people[i].name === name){
this.name = people[i].name;
this.looks = people[i].looks;
this.health = people[i].health;
this.maxHealth = this.health;
this.speed = people[i].speed;
this.acc = people[i].acceleration;
this.weapons = people[i].weapons;
this.use = getWeaponStats(people[i].weapons[0]);
this.size = people[i].size;
this.debugNum = i;
this.data = people[i];
this.powers = [];
this.powerNames = [];
for(var q = 0; q < this.data.powers.length; q++){
this.powers.push(getPowerStats(this.data.powers[q]));
this.powerNames.push(this.data.powers[q]);
}
}
}
};
player.prototype.switchPower = function(n){
this.pCharge = 0;
this.powerSelect+=n;
if(this.powerSelect >= this.powers.length){
this.powerSelect = 0;   
}
if(this.powerSelect < 0){
this.powerSelect = this.powers.length-1;
}
};
player.prototype.switchPowerI = function(n){
this.pCharge = 0;
this.powerSelect=n;
};
player.prototype.doPower = function(i){
if(this.health>0 && !this.forcedPowerRelease){
if(!i){
i = this.powerSelect;
}
if(this.powers[i]){
//println(this.didPowerYet);
if(!this.buffs.stun && !this.noPower){
   
if(this.pCooldown[i] > this.powers[i].cooldown){
//println(i+' , '+this.didPowerYet+' , '+frameCount);
//this.pUsed = i;
this.pcUsed = i;
this.powerSelect = i;
if(this.powers[i].use){
this.powers[i].use(this);
}
if(this.powers[i].lockRot){
this.onUseRot = this.rot;
this.pChangeRot = false;
}
if(this.powers[i].changeRot){
this.onUseRot = this.rot;
this.pChangeRot = this.powers[i].changeRot;
}
if(this.powers[i].noHold){
this.pCooldown[i] = 0;
}
}
}
this.noPower = false;
}
}
};
player.prototype.hit = function(e,w,k){
    if(gameSet.noAttack<=0){
this.hitYet.push(e);
if(!e.buffs.phaseOut){
    for(var a = 0; a < w.abilities.length; a++){
    
    var stats = getAbilityStats(w.abilities[a]);
    if(stats){
    if(stats.hit){
    stats.hit(this,e);
    }
    }
    }
    e.knockback(k,w.knockback);
    e.health -= w.damage;
    var dmgNotif = new effect(e.x,e.y,0,color(255, 0, 0),255,5,"btext");
    dmgNotif.textSize = 30;
    dmgNotif.text = w.damage;
    dmgNotif.vx = random(-1,1);
    dmgNotif.vy = random(-2.5);
    dmgNotif.rot = 0;
    dmgNotif.vRot = random(-1,1);
}
    }
};
player.prototype.checkForHits = function(){
this.trueAttacking = true;
var angMod = 0;
if(this.use.sweepMod){
angMod = this.use.sweepMod;
}
for(var q = this.enemies.length - 1; q > -1; q--){
    if(this.enemies[q]){
    //println('e');
    // if(this.use.sweep === 180){
    // if(players[q] !== this&&!this.hitYet.includes(players[q])){
    // if(d(this,players[q]) <= (this.use.reach*this.size)+(getSize(players[q].size))+(getSize(this.size))){
    // println(angleDiff(this.rot,angle(this,players[q])));
    // }
    // }
    // }
    if(this.enemies[q] !== this&&!this.hitYet.includes(this.enemies[q])){
        //println('e');
        //println( this.use.sweep+angMod);
    if(d(this,this.enemies[q]) <= hitDiff(this,this.enemies[q]) && angleDiff(this.rot,angle(this,this.enemies[q])) <= this.use.sweep+angMod){
        //println('e');
    var check = false;
    
    if(clearPath(this.x,this.y,this.enemies[q].x,this.enemies[q].y)){
    check = true;    
    }
    
    if(check){
    this.hit(this.enemies[q],this.use,this);
    }
    
    
    
    }
    }
    }
}
};
function doPlayerGraphics(e,s){
    if(e.looks.effects){
    e.looks.effects(e.x,e.y);
    }
    
    fill(e.looks.color);
    stroke(0, 0, 0);
    strokeWeight(2);
    pushMatrix();
    drawHands(e,e.cooldown,e.handMove);
    popMatrix();
    // popMatrix();
    // pushMatrix();
    translate(e.x,e.y);
    scale(s);
    translate(-e.x,-e.y);
    fill(e.looks.color);
    stroke(0, 0, 0);
    strokeWeight(2);
    ellipse(e.x, e.y, 30, 30); 
    if(e.looks.hat){
    pushMatrix();
    translate(e.x,e.y);
    rotate(e.rot);
    e.looks.hat(e);
    popMatrix();
    }
}
player.prototype.draw = function(){
    if(this.charge > 15){
    this.charge = 15;
    }
    if(this.pCharge > 15){
    this.pCharge = 15;
    }
    //this.didPowerYet = false;
    //println(this.pcUsed+' , '+this.pUsed);
    if((this.pcUsed === false && this.pUsed !== false)){
    
    this.powers[this.pUsed].released(this);
    this.forcedPowerRelease = false;
    if(!this.powers[this.pUsed].noHold){
    this.pCooldown[this.pUsed] = 0;
    }
    // this.pcUsed = false;
    // this.pUsed = true;
    }
    if(this.pcUsed === false){
    this.pCharge = 0;
    }
    this.pUsed = this.pcUsed;
    //this.pUsedN = this.pcUsed[0];
    this.pcUsed = false;
    
    while(space(this.rot,this.trot)>180){

    if(this.rot > this.trot){
    this.rot -= 360;
    }else if(this.rot < this.trot){
    this.rot += 360;
    }
    }
    
    if(this.onUseRot !== false){
    if(this.pChangeRot){
    this.rot = lerp(this.rot,this.trot,this.pChangeRot);
    }else{
    
    this.rot = this.onUseRot;
    }
    if(this.pCooldown[this.pUsed] > 1){
    this.onUseRot = false;
    }
    }else if(this.onSwingRot !== false){
        
    if(this.use.changeRot){


    this.rot = lerp(this.rot,this.trot,this.use.changeRot);
    }else{
        
    this.rot = this.onSwingRot;
    }
    if(this.cooldown > 1){
    this.onSwingRot = false;
    }
    
    }else{
        
    
    this.rot = lerp(this.rot,this.trot,0.2);
    }
    if(this.health > 0){
    
    this.px = this.x;
    this.py = this.y;
    var amp = 1;
    var shake = false;
    if(this.altSpeed){
    amp = this.altSpeed;
    }
    this.altSpeed = false;
    if(this.use.slow){
    amp = this.use.slow;
    }
    if(this.cooldown <= 1){
    if(this.use.useSlow){
    amp = this.use.useSlow;
    }
    }
    if(this.que[0]){
    if(this.que[0].type === 'delay'){
    amp = this.que[0].slow;
    shake = 5;
    }
    }
    
    this.tvx = this.vx*amp;
    this.tvy = this.vy*amp;
    //var totalV = (this.tvx+this.tvy)/2;
    
    this.tvx = constrain(this.tvx,-getSize(this.size/1.2),getSize(this.size/1.2));
this.tvy = constrain(this.tvy,-getSize(this.size/1.2),getSize(this.size/1.2));

    this.x += this.tvx;
    this.y += this.tvy;
    this.x = round(this.x * 10) / 10;
    this.y = round(this.y * 10) / 10;
    this.health = round(this.health*100)/100;
    pushMatrix();
    
    if(shake){
    translate(this.x,this.y);
    rotate(random(-shake,shake));
    translate(-this.x,-this.y);
    }
    
    pushMatrix();
    translate(this.x,this.y);
    //rotate(this.rot);
    if(this.attacked && this.cooldown <= 1 && !this.que[0]){
    //
    for(var a = 0; a < this.use.abilities.length; a++){
    var stats = getAbilityStats(this.use.abilities[a]);
    if(stats){
    if(stats.duringSwing){
    stats.duringSwing(this);
    }
    } 
    }
    }else{
    if(this.pAttacked && this.cooldown <= 1){
    for(var a = 0; a < this.use.abilities.length; a++){
    var stats = getAbilityStats(this.use.abilities[a]);
    if(stats){
    if(stats.released){
    stats.released(this);
    }
    } 
    }
    }
    }

    if(this.sweeping){
    this.selected = this.keep;
    var mod = 0;
    if(this.use.swingMod){
    mod = this.use.swingMod;
    }
    
    if(this.use.invert){
    rotate(this.sweepRad-(((this.sweepRad*2)/this.use.swingDuration)*this.cooldown)+mod);
    }else{
    rotate(-this.sweepRad+(((this.sweepRad*2)/this.use.swingDuration)*this.cooldown)+mod);
    }
    if(this.cooldown > this.use.swingDuration){
    this.sweeping = false;
    for(var a = 0; a < this.use.abilities.length; a++){
    var stats = getAbilityStats(this.use.abilities[a]);
    if(stats){
    if(stats.endSwing){
    stats.endSwing(this);
    }
    } 
    }
    }
    if(this.cooldown < this.use.swingDuration){
    this.checkForHits();
    }
    }
    translate(-this.x,-this.y);
    doPlayerGraphics(this,this.size);
    this.trueAttacking = false;
    // if(this.target){
    // line(this.x,this.y,this.x+cos(angle(this,this.target))*20,this.y+sin(angle(this,this.target))*20);
    // }
    popMatrix();
    popMatrix();
    noStroke();
    fill(255, 0, 0);
    rect(this.x - 25, this.y - 30, 50, 8);
    fill(0, 255, 4);
    stroke(0, 255, 4);
    strokeWeight(2);
    rect(this.x - 25, this.y - 30, (50 / round(this.maxHealth)) * (round(this.health*100)/100), 8);
    fill(0, 0, 0);
    textSize(8);
    textAlign(CENTER, BOTTOM);
    text(round(this.health) + '/' + this.maxHealth, this.x, this.y - 21);

    textSize(9);
    text(this.name, this.x, this.y - 34);
    if(this === p && gameSet.noAttack <=0){
    stroke(0, 0, 255,200);
    strokeWeight(3);
    for(var i = 0; i < players.length; i++){
    if(players[i] !== this&&!this.enemies.includes(players[i])){ 
    var dir = angle(this,players[i]);
    line(this.x,this.y,this.x+cos(dir)*10,this.y+sin(dir)*10);
    }
    }
    }
    if(this.buffs.phaseOut){
    this.buffs.phaseOut--;
    if(this.buffs.phaseOut <= 0){
    this.buffs.phaseOut = false;
    }
    pushMatrix();
    translate(this.x,this.y);
    scale(this.size);
    translate(-this.x,-this.y);
    noStroke();
    fill(0, 255, 9,128);
    ellipse(this.x, this.y, 40, 40);
    popMatrix();
    }
    if(this.buffs.stun){
    pushMatrix();
    translate(this.x,this.y);
    scale(this.size);
    translate(-this.x,-this.y);
    noStroke();
    fill(255, 183, 0,128);
    ellipse(this.x, this.y, 40, 40);
    popMatrix();
    pushMatrix();
    translate(random(-1,1),random(-1,1));
    fill(255, 30, 0);
    textSize(20);
    textAlign(CENTER,BASELINE);
    text('stun',this.x,this.y-30);
    popMatrix();
    }
    this.cooldown += 1;
    for(var i = 0; i < this.powers.length; i++){
    this.pCooldown[i] += 1;
    }
    this.pAttacked = this.attacked;
    this.pTrueAttacked = this.trueAttacked;
    this.attacked = false;
    this.trueAttacked = false;
    }
};
proj.prototype.draw = function() {
noStroke();

this.x += cos(this.angle)*this.v;
this.y += sin(this.angle)*this.v;
if(this.data.slow || this.data.slow === 0){
this.v -= this.data.slow;
}else{
this.v -= 0.1;
}
if(this.v <= 0 && !this.data.rebound){
    
this.v = 0;
}
if(this.data.spin){
this.rot += this.data.spin;
}
pushMatrix();
translate(this.x,this.y);
if(!this.noScale){
scale(this.data.shooter.size);
}
rotate(this.rot);
fill(255, 0, 0);
noStroke();
//println('e');
//ellipse(0,0,10,10);
projGraphics(this.data.data.type,this);
var rend = toRenderAt(this.x,this.y);
for(var q = 0; q < rend.length; q++){
switch(rend[q][1].type){
case 'polygon':
if(isInside(rend[q][1].data, rend[q][1].data.length, this)){
this.life = 0;
}
break;
case 'circle':
if(dist(this.x,this.y,rend[q][1].data.x,rend[q][1].data.y) <= rend[q][1].data.r){
this.life = 0;
}
break;
}
}
if(!this.data.size){
this.data.size = 0;
}
if(this.data.effects){
this.data.effects(this.data.shooter,this);
}
for(var i = 0; i < this.data.shooter.enemies.length; i++){
var e = this.data.shooter.enemies[i];
if(dist(this.x,this.y,e.x,e.y)<getSize(e.size)+this.data.size/2){
if(!this.data.data.noHit){
if(this.data.shooter){
this.data.shooter.hit(e,this.data.data,this);
}
this.life = 0;
}
break;
}
}

popMatrix();
this.life -= 1;
if(this.life <= 0||(this.v<=1&&!this.data.noStall)){
for(var i = 0; i < projs.length; i++){
if(projs[i] === this){
projs.splice(i,1);
}
}
}
};
player.prototype.move = function(dirs){
//move
if(this.cooldown <= 1&&this.use.swingStill){
dirs = [false,false,false,false];
}
if(this.buffs.stun){
dirs = [false,false,false,false];
this.buffs.stun--;
if(this.buffs.stun <= 0){
this.buffs.stun = false;
}
}
        {
        //up / down
        if(dirs[0]) {
            
            if(this.vy > -1 * this.speed) {

                this.vy = this.vy - this.acc;
            }
            if(this.vy < -1 * this.speed) {

                this.vy = this.vy + this.acc;
            }

        } else if(dirs[2]) {
            if(this.vy < this.speed) {
                this.vy = this.vy + this.acc;
            }
            if(this.vy > this.speed) {
                this.vy = this.vy - this.acc;
            }
        } else {
            this.vy = round(this.vy * 100) / 100;
            if(this.vy > 0) {
                this.vy = this.vy - this.acc;
            } else if(this.vy < 0) {
                this.vy = this.vy + this.acc;
            }
            if(space(this.vy,0) <= this.acc){
            this.vy = 0;
            }
        }

        //left / right
        if(dirs[3]) {
            
            if(this.vx < this.speed) {
                this.vx = this.vx + this.acc;
            }
            if(this.vx > this.speed) {
                this.vx = this.vx - this.acc;
            }
        } else if(dirs[1]) {
           
            if(this.vx > -1 * this.speed) {
                this.vx = this.vx - this.acc;
            }
            if(this.vx < -1 * this.speed) {
                this.vx = this.vx + this.acc;
            }
        } else {
            this.vx = round(this.vx * 100) / 100;
            if(this.vx > 0) {
                
                this.vx = this.vx - this.acc;
            } else if(this.vx < 0) {
                this.vx = this.vx + this.acc;
            }
            if(space(this.vx,0) <= this.acc){
            this.vx = 0;
            }
        }
        //prevents moving to fast

        // {
        //     if(this.vy > this.speed) {
        //         this.vy = this.speed;
        //     }
        //     if(this.vy < this.speed) {
        //         this.vy = this.speed;
        //     }
        //     if(this.vx > this.speed) {
        //         this.vx = this.speed;
        //     }
        //     if(this.vx < this.speed) {
        //         this.vx = this.speed;
        //     }
        // }

        this.vy = round(this.vy * 100) / 100;
        this.vx = round(this.vx * 100) / 100;
        }
};
player.prototype.resetHands = function(){
this.curHands[0].transX = 0;
this.curHands[0].transY = 0;
this.curHands[1].transX = 0;
this.curHands[1].transY = 0;
this.hands[0].transX = 0;
this.hands[0].transY = 0;
this.hands[1].transX = 0;
this.hands[1].transY = 0;
};
player.prototype.switchWeapon = function(n){
if(!this.que[0]){
for(var i = 0; i < weapons.length; i++){
if(weapons[i][0] === this.weapons[n]){
this.selected = n;
this.use = weapons[i][1];
this.charge = 0;
if(this.cooldown < 2){
this.cooldown = 2;
}
}
}
}
};
player.prototype.knockback = function(e,n){
var dir = atan2(e.y-this.y,e.x-this.x);
this.vx -= cos(dir)*n;
this.vy -= sin(dir)*n;
};
player.prototype.procede = function(i){
    this.cooldown = 0;
    this.use = weapons[i][1];
    this.handMove = this.use.anim;
    if(this.handMove === 'sweep'){
    this.sweeping = true;
    this.sweepRad = this.use.sweep;
    for(var e = 0; e < this.sweepRad; e+=2){
    new effect(this.x+cos(this.rot+e*2-this.sweepRad)*(this.use.reach+15)*this.size,this.y+sin(this.rot+e*2-this.sweepRad)*(this.use.reach+15)*this.size,random(2,10)*this.size,color(59, 59, 59),random(0,255),random(3,6));
    }
    }
    for(var a = 0; a < this.use.abilities.length; a++){
    var stats = getAbilityStats(this.use.abilities[a]);

    if(stats){
    
    if(stats.swing){
    
    stats.swing(this);
    }
    }
    }
    this.checkForHits();
};
player.prototype.doQue = function(){
if(this.que[0]){
this.cooldown = 0;
switch(this.que[0].type){
case 'delay':
this.que[0].counter -= 1;
this.selected = this.que[0].num;
//println('e');
this.rot = this.que[0].rot;
if(this.que[0].counter <= 0){
this.procede(this.que[0].i);
this.que.splice(0,1);
}
break;
}
}
};
player.prototype.attack = function(){
    if(this.health>0){
    if(!this.buffs.stun){
    this.attacked = true;
    this.noPower = true;
for(var i = 0; i < weapons.length; i++){
    if(weapons[i][0] === this.weapons[this.selected]){
    if(this.cooldown >= weapons[i][1].cooldown){
    //this.trueAttacked = true;
    this.hitYet = [];
    this.cooldown = 0;
    this.use = weapons[i][1];
    this.handMove = this.use.anim;
    this.keep = this.selected;
    this.onSwingRot = this.rot;
    if(this.use.delay){
    this.que.push({
    type:'delay',
    counter:this.use.delay[0],
    num: this.selected,
    slow: this.use.delay[1],
    rot: this.rot,
    i:i,
    });
    }else{
    this.procede(i);
    }
    }
    }
    
}
}
}
};
player.prototype.canSee = function(e){
if(space(this.x,e.x) <= this.sight.x/2+getSize(e.size)&&space(this.y,e.y) <= this.sight.y/2+getSize(e.size)){

if(clearPath(this.x,this.y,e.x,e.y)){
return true;
}
}
};
player.prototype.alignDirs = function(){
//strokeWeight(10);
//stroke(255, 0, 0);
//line(this.x,this.y,this.x+cos(this.targDir)*100,this.y+sin(this.targDir)*100);
this.ideal = 0;

if(this.curAtt === 'weapon'){
if(this.use.idealDist){
this.ideal = this.use.idealDist;
}
}
if(this.curAtt === 'power'){
if(this.powers[this.powerSelect].idealDist){
this.ideal = this.powers[this.powerSelect].idealDist;
}
}

if((this.target && this.target.name)&&(this.target && this.ideal&&this.target&&this.target.name&&d(this,this.target)<(this.ideal+getSize(this.target.size)))&&!this.targDirAlt){
if(this.targDir > -90&&this.targDir <= 90){
this.dirs[1] = true;
}else{
this.dirs[3] = true;
}
if(this.targDir > 0){
this.dirs[0] = true;
}else{
this.dirs[2] = true;
}
}else{
if(this.targDir > -90&&this.targDir <= 90){
this.dirs[3] = true;
}else{
this.dirs[1] = true;
}
if(this.targDir > 0){
this.dirs[2] = true;
}else{
this.dirs[0] = true;
}
}
// }else{
// if(this.targDir < 90||this.targDir >= 270){
// this.dirs[3] = true;
// }else{
// this.dirs[1] = true;
// }
// if(this.targDir > 180){
// this.dirs[0] = true;
// }else{
// this.dirs[2] = true;
// }
// }
};
player.prototype.checkForKill = function(){
if(this.health <= 0){
for(var i = players.length-1; i > -1; i--){
for(var q = players.length-1; q > -1; q--){
if(players[q].enemies.indexOf(this) >= 0){
//println('e');
players[q].enemies.splice(players[q].enemies.indexOf(this),1);
}
}
if(players[i] === this){
players.splice(i,1);
}
}
}
};
function injectPath(p,e,pos){
var ret = [];
for(var i = 0; i < p.length+1; i++){
if(i < pos-1){
    
ret.push(p[i]);
}else if(i === pos-1){
   
ret.push([
    {
    x:p[i][0].x,
    y:p[i][0].y,
    },
    {
    x:e.x,
    y:e.y,
    },
    ]);
}else if(i === pos){
     
ret.push([
    {
    x:e.x,
    y:e.y,
    },
    {
    x:p[i-1][1].x,
    y:p[i-1][1].y,
    },
    ]);
}else{
ret.push(p[i-1]);
}
}

return ret;
}
function allObsAlong(p,pl){
var ret = [];
for(var i = 0; i < p.length; i++){
var obs = obsFrom(p[i][0].x,p[i][0].y,p[i][1].x,p[i][1].y,pl);
for(var q = 0; q < obs.length; q++){
ret.push([obs[q],p[i],i]);
}
}
return ret;
}
function resetPath(a,b){
var ret = [];
ret.push([
    {
    x:a.x,
    y:a.y
    },
    {
    x:b.x,
    y:b.y
    },
    ]);
return ret;
}
function decideDir(a,b){
var xd = a.x-b.x;
var yd = a.y-b.y;
if(abs(xd) < abs(yd)){
return 'x';
}else{
return 'y';
}
}
function minim(a,b){
if(a<b){
return a;
}else{
return b;
}
}
function maxim(a,b){
if(a>=b){
return a;
}else{
return b;
}
}
function chunksFrom(a,b){
var mini={x:minim(a.x,b.x),y:minim(a.y,b.y)};
var maxi={x:maxim(a.x,b.x),y:maxim(a.y,b.y)};
var chunkA = mini;
var chunkB = maxi;
var ret = [];
//println('a');
for(var i = chunkA.y; i < chunkB.y; i++){
ret[i] = [];
//println('b');
for(var q = chunkA.x; q < chunkB.x; q++){

ret[i][q] = chunks[i][q];

}

}
//println('c');
return ret;
}


function noNest(e){
var ret = e;
println(e.length);

return ret;
}

function changePath(p,e,pos){
var ret = p;
if(pos-1 >= 0){
ret[pos-1][1] = e;
}
ret[pos][0] = e;
return ret;
}
function findWay(position, f) {
  var queue = [];
  
  var matrix = chunksFrom({x:position[1],y:position[0]},{x:f[1],y:f[0]});
  
  //println('d');
  if(!matrix[position[0]]){
  matrix[position[0]] = [];
  
  }
  //println('e');
  matrix[position[0]][position[1]] = 1;
//println('f');
  queue.push([position]); // store a path, not just a position
  
  while (queue.length > 0) {
    var path = queue.shift(); // get the path out of the queue
    var pos = path[path.length-1]; // ... and then the last position from it
    //println('g');
    var direction = [
      [pos[0] + 1, pos[1]],
      [pos[0], pos[1] + 1],
      [pos[0] - 1, pos[1]],
      [pos[0], pos[1] - 1],
    ];

    for (var i = 0; i < direction.length; i++) {
      // Perform this check first:
    if (direction[i][0] === f[0] && direction[i][1] === f[1]) {
        // return the path that led to the find
        return path.concat([f]); 
      }
//if (direction[i][0] < 0  || direction[i][1] < 0 || matrix[direction[i][0]][direction[i][1]] !== 0) { 
    //    continue;
    //  }
    //println('h');
    if(!matrix[direction[i][0]]){
  matrix[direction[i][0]] = [];
  
  }
      matrix[direction[i][0]][direction[i][1]] = 1;
      //println('i');
      // extend and push the path on the queue
      queue.push(path.concat([direction[i]])); 
    }
  }
  //println('j');
}
player.prototype.getPath = function(e){
var ret = [];
var int = pathfindingInt;
var lastRot = Infinity;
this.currentPath = 0;
for(var i = 0; i < 1000/int; i++){

var cont = false;
var past = {x:this.x,y:this.y};
if(ret.length-1 >= 0){
past = ret[ret.length-1][1];
}
var dir = angle(past,e);
var dir2 = angle(past,e);
while(dir < 360 && cont === false){
ret.push([{x:past.x,y:past.y},{x:past.x+cos(dir)*int,y:past.y+sin(dir)*int}]);
var last = ret[ret.length-1];
dir++;

if(round(dir) !== round(lastRot+180) && round(dir) !== round(lastRot-180) && fatClearPath(last[0].x,last[0].y,last[1].x,last[1].y,this)){
cont = true;
lastRot = dir;
continue;
}else{
ret.splice(ret.length-1,1);
}
ret.push([{x:past.x,y:past.y},{x:past.x+cos(dir2)*int,y:past.y+sin(dir2)*int}]);
var last = ret[ret.length-1];
dir2--;
if(round(dir2) !== round(lastRot+180) && round(dir2) !== round(lastRot-180) &&fatClearPath(last[0].x,last[0].y,last[1].x,last[1].y,this)){
cont = true;
lastRot = dir2;
continue;
}else{
ret.splice(ret.length-1,1);
}
}
}

return ret;
};
player.prototype.canSee = function(e){
if(space(this.x,e.x) <= this.sight.x+getSize(e.size)&&space(this.y,e.y) <= this.sight.y+getSize(e.size)){
if(clearPath(this.x,this.y,e.x,e.y)){
return true;
}
}
return false;
};
player.prototype.calcProjAngle = function(e,u){
// current dist
var d1 = d(this,e);
// will be dist
var d2 = d(this,{x:e.x+e.tvx*(d1/u.projSpeed),y:e.y+e.tvy*(d1/u.projSpeed)});
// make angle according to movement and will be dist
return angle(this,{x:e.x+e.tvx*(d2/u.projSpeed-e.tvx),y:e.y+e.tvy*(d2/u.projSpeed-e.tvy)});
};
player.prototype.rayCast = function(incr,a,cap){
var dir = (360/cap)*a + ((360/cap)/2);
    var tryLength = incr;
    while(clearPath(this.x,this.y,this.x+cos(dir)*tryLength,this.y+sin(dir)*tryLength) && tryLength < 300){
        tryLength += incr;
    }
};
player.prototype.getOptimalDirection = function(incr){
    if(!this.curBestDir){
this.curBestDir = 0;
}
if(!this.curDir){
this.curDir = 0;
}
    var rad = 160;
    var cap = 8;
    var inc = incr;
    var best = 0;
    var bests = [];
    var bestDir = 0;
for(var i = 0; i < cap; i++){
    var dir = (rad/cap)*i +this.curDir-rad/2;
    var tryLength = inc;
    while(clearPath(this.x,this.y,this.x+cos(dir)*tryLength,this.y+sin(dir)*tryLength) && tryLength < 300){
        tryLength += inc;
    }
    //strokeWeight(10);
    //stroke(0, 0, 0);
    //line(this.x,this.y,this.x+cos(dir)*tryLength,this.y+sin(dir)*tryLength);
    if(tryLength > best){
        
        best = tryLength;
        bests = [];
        bests.push(dir);
        
    }else if(tryLength === best){
        bests.push(dir);
    }
}

    var go = bests[floor(random(0,bests.length))];
    //strokeWeight(10);
    //stroke(255, 0, 0);
    //line(this.x,this.y,this.x+cos(go)*best,this.y+sin(go)*best);
    return go;
};
player.prototype.doAi = function(shouldntSwitch){

this.newTargTimer += 1;
this.newpTargTimer += 1;
this.targDirAlt = false;
if(!shouldntSwitch){
if(!this.attacked){
if(round(random(0,240)) === 4){

this.switchWeapon(floor(random(0,this.weapons.length)));

}
}
if(!this.pcUsed && this.pcUsed !== 0){
if(round(random(0,240)) === 4){
this.switchPowerI(floor(random(0,this.powers.length)));
//this.switchPowerI(0);
while(this.powers[this.powerSelect].condition && !this.powers[this.powerSelect].bypassCondition){
this.switchPowerI(floor(random(0,this.powers.length)));
}
}
}
}
this.dirs = [false,false,false,false];
if(gameSet.noAttack <= 0){
if(this.newTargTimer > 0){
if(this.newpTargTimer > 60){
if(round(random(0,10)) === 5){           
for(var i = this.enemies.length-1; i > -1; i--){
if(this.enemies[i] !== this){

var e = this.enemies[i];
if(this.canSee(e)){
this.target = e;
this.newpTargTimer = 0;
}
}
}
}
}
}
}


if(this.target){
if(this.target.name){

// if the target is a player
if(this.use.projSpeed){


this.targDir = this.calcProjAngle(this.target,this.use);

}else{
this.targDir = angle(this,this.target);
}

if(this.colCount > 100){
this.path = false;
this.currentPath = 0;
this.target = false;
this.newTargTimer = 0;
}
}else{
// if the target is not a player


// pathfinding was too hard and too laggy
// if(this.path){
// // if has a path, follow path

// // for(var i = 0; i < this.path.length; i++){
// // strokeWeight(10);
// // stroke(255, 0, 0);
// // line(this.path[i][0].x,this.path[i][0].y,this.path[i][1].x,this.path[i][1].y);
// // }

// this.targDir = angle(this,this.path[this.currentPath][1]);
// //println(d(this,this.path[this.path.length-1][1]));
// if(d(this,this.path[this.currentPath][1])<getSize(this.size)*4){
    
// if(this.currentPath < this.path.length-1){
// this.currentPath++;
// }
// }

// if(d(this,this.path[this.path.length-1][1])<=getSize(this.size)*4||round(random(0,900))===10){
// this.path = false;
// this.currentPath = 0;
// this.target = false;
// }
// if(this.colCount > 100){
// this.path = false;
// //println(frameCount);
// this.colCount = 0;

// this.currentPath = 0;
// this.target = false;
// this.newTargTimer = 0;
// }
// }else{
// // if no path, make a path

// this.path = this.getPath(this.target);
// }
if(!this.curBestDir){
this.curBestDir = 0;
}
if(!this.curDir){
this.curDir = 0;
}
if(round(random(0,15))===1){
var inc = 10;
var tDir = this.getOptimalDirection(inc);
this.curBestDir = tDir;
}
// if(this.curBestDir > this.curDir){
 
// }
// if(this.curBestDir < this.curDir){
//  this.curDir -= 1;
// }
this.curDir = lerp(this.curDir,this.curBestDir,random()/11);
if(round(random(0,170)) === 2){
this.curDir += 180;
}
while(space(this.curDir,this.curBestDir)>180){

    if(this.curDir > this.curBestDir){
    this.curDir -= 360;
    }else if(this.curDir < this.curBestDir){
    this.curDir += 360;
    }
    }

this.target = {x:this.x+cos(this.curDir),y:this.y+sin(this.curDir)};
this.targDir = angle(this,this.target);

//println(dir);
}
}else{
// if(this.tCount > 3 || !this.target){
// this.tCount = 0;
// this.target = {x:random(this.x-1000,this.x+1000),y:random(this.y-1000,this.y+1000)};
// this.pTarget = this.target;
// }else{
// this.target = this.pTarget;
// }
var inc = 10;
var dir = this.getOptimalDirection(inc);
this.target = {x:this.x+cos(dir)*inc,y:this.y+sin(dir)*inc};
this.curBestDir = dir;
this.curDir = dir;
//println(this.target.x);
}

this.trot = this.targDir;

if(this.health <= 0){

}else{
//println(p.pcUsed);


if(this.target){
if(this.target.name){
if(!shouldntSwitch){
if(!players.includes(this.target)){
// if player target is dead, remove target
this.path = false;
this.currentPath = 0;
this.target = false;

}

if(round(random(0,120)) === 4){
this.att = choice('power','weapon');
this.curAtt = this.att;
}

// conditional powers
if(round(random(0,16))===2){
for(var i = 0; i < this.powers.length; i++){
if(round(random(0,3))===2){
if(this.powers[i].condition){
if(this.powers[i].condition(this,this.target)&&this.pCooldown[i] > this.powers[i].cooldown){
this.att = 'power';
this.switchPowerI(i);
}
}
}
}
}
}else{
this.att = shouldntSwitch;
}

if(this.att === 'power'){
    
if(round(random(0,10))===5||this.contAttack){
// if this is continuing an attack or decides it could possibly start attacking
this.contAttack = false;
if(d(this,this.target) <= this.powers[this.powerSelect].aiDist*this.size+(getSize(this.target.size))+(getSize(this.size))){
// if this should logically try to use power

this.doPower();

if(this.powers[this.powerSelect].abilities){
if(this.powers[this.powerSelect].abilities.includes('continuous')){
var mCharge = 15;
if(this.powers[this.powerSelect].idealCharge){
mCharge = this.powers[this.powerSelect].idealCharge+random(0,15-this.powers[this.powerSelect].idealCharge);
}
if((this.pCharge < mCharge || space(this.rot,this.trot) > random(0,30))&&space(this.rot,this.trot) < 90){
this.contAttack = true;
// how long this should keep attacking if it's a continuous attack(bow, lazer beam)
}
}
}
if(this.contAttack === false){
this.att = 'weapon';
}

}
}
}else{
this.att = 'weapon';
// println(d(this,this.target));
// print(this.use.aiDist*this.size+(getSize(this.target.size))+(getSize(this.size)));
if(round(random(0,10))===5||this.contAttack){
    
// if this is continuing an attack or decides it could possibly start attacking
this.contAttack = false;
if(d(this,this.target) <= this.use.aiDist*this.size+(getSize(this.target.size))+(getSize(this.size))){
// if this should logically try to attack
//println('e');
this.attack();

if(this.use.abilities.includes("dart")){
if(abs(this.vx)+abs(this.vy)>0&&!this.hitYet.includes(this.target)){
// how long this should keep attacking if it's a dart attack(dagger)
this.contAttack = true;
}
}else if(this.use.abilities.includes('continuous')){

if((this.charge < 15 || space(this.rot,this.trot) > random(0,30))&&space(this.rot,this.trot) < 90){
    
this.contAttack = true;
// how long this should keep attacking if it's a continuous attack(bow, lazer beam)
}
}


}
}
}
}
}
}
if(this.onSwingRot !== false){
// if has a rotation debuff 
if(this.use.changeRot){
// tries to reach the desired rotation faster
if(this.rot > this.targDir+2){
this.trot -= 0.4/this.use.changeRot;
}
if(this.rot < this.targDir-2){
this.trot += 0.4/this.use.changeRot;
}
}
}
this.danger = false;
for(var i = 0; i < projs.length; i++){
// for each projectile
if(round(random(0,5)) === 2 ||this.contAway[projs[i].id]){
this.contAway[projs[i].id] = false;
var e = projs[i];
if(this.canSee(e)){
var d1 = angle(e,this);
if(angleDiff(d1,e.angle)<50){
this.danger = true;
this.contAway[projs[i].id] = true;
this.targDirAlt = true;
if(d1>e.angle){
this.targDir = d1+90;
}else{
this.targDir = d1-90;
}
i = projs.length;
// strokeWeight(10);
// stroke(255, 0, 0);
// line(this.x,this.y,this.x+cos(this.targDir)*100,this.y+sin(this.targDir)*100);

}
}
}
}

//println(this.vx);
//println(this.vx);

this.alignDirs();

};
player.prototype.initiate = function(){
    //println('e');
for(var i = 0; i < players.length; i++){
    //println('e');
if(players[i] !== this){
this.enemies.push(players[i]);
}
}
};
player.prototype.initiateI = function(n){
    //println('e');

if(players[n] !== this){
this.enemies.push(players[n]);
}

};
p = new player();
p.x = 300;
p.y = 300;
p.become('ack');
p.size = 1;
player.prototype.initiate2 = function(){
    //println('e');
this.enemies.push(p);
};
function wall(e,d,s){
this.data = d;
this.type = e;
this.texture = s;
this.loadRew = 0;
walls.push(this);
this.index = walls.length-1;
}
wall.prototype.shadow = function(e){
noStroke();
fill(0, 0, 0);
switch(this.type){
case 'polygon':
{
for(var i = 0; i < this.data.length; i++){
var dir = atan2(this.data[i].y-e.y, this.data[i].x-e.x);
var dir2;
if(this.data[i+1]){
dir2 = atan2(this.data[i+1].y-e.y, this.data[i+1].x-e.x);
}else{
dir2 = atan2(this.data[0].y-e.y, this.data[0].x-e.x);
}
/*
vertex(120,90);
vertex(120+cos(rot)*80,90+sin(rot)*80);
vertex((120+cos(rot)*80)+cos(rot+90)*210,(90+sin(rot)*80)+sin(rot+90)*210);
vertex(120+cos(rot+90)*210,90+sin(rot+90)*210);
*/
beginShape();
vertex(this.data[i].x, this.data[i].y);
vertex(this.data[i].x+cos(dir)*10000, this.data[i].y+sin(dir)*10000);
//vertex(this.data[i].x+cos(dir+90)*1000, this.data[i].y+sin(dir+90)*1000);
if(this.data[i+1]){
vertex(this.data[i+1].x+cos(dir2)*10000, this.data[i+1].y+sin(dir2)*10000);
vertex(this.data[i+1].x, this.data[i+1].y);
}else{
vertex(this.data[0].x+cos(dir2)*10000, this.data[0].y+sin(dir2)*10000);
vertex(this.data[0].x, this.data[0].y);
}
endShape(CLOSE);
// beginShape();
// vertex(this.data[i].x, this.data[i].y);
// vertex(this.data[i].x+cos(dir)*600, this.data[i].y+sin(dir)*600);
// if(this.data[i-1]){
// vertex(this.data[i-1].x, this.data[i-1].y);
// }else{
// vertex(this.data[this.data.length-1].x, this.data[this.data.length-1].y);
// }
// endShape(CLOSE);
}
}
break;
case 'circle':
{

var dir = atan2(this.data.y-e.y,this.data.x-e.x)+90;
var dir2 = dir+180;
var dir3 = atan2((this.data.y+sin(dir)*this.data.r)-e.y,(this.data.x+cos(dir)*this.data.r)-e.x);
var dir4 = atan2((this.data.y+sin(dir2)*this.data.r)-e.y,(this.data.x+cos(dir2)*this.data.r)-e.x);
beginShape();
vertex(this.data.x+cos(dir)*this.data.r,this.data.y+sin(dir)*this.data.r);
vertex(this.data.x+cos(dir3)*this.data.r*6000,this.data.y+sin(dir3)*this.data.r*6000);
vertex(this.data.x+cos(dir4)*this.data.r*6000,this.data.y+sin(dir4)*this.data.r*6000);
vertex(this.data.x+cos(dir2)*this.data.r,this.data.y+sin(dir2)*this.data.r);

endShape(CLOSE);

}

break;
}
};
wall.prototype.draw = function(highlight) {
pushMatrix();
if(this.texture.stroke){
stroke(this.texture.stroke);
if(this.texture.strokeWeight !== false){
strokeWeight(this.texture.strokeWeight);
if(this.texture.strokeWeight === 0){
noStroke();
}
}else{
strokeWeight(2);
}
}else{
noStroke();
}
if(this.texture.fill){
fill(this.texture.fill);
}else{
fill(130, 130, 130);
}
if(highlight){
fill(255, 0, 0);
}else if(showChunkCollisions){

var rend = fatRenderAt(p.x,p.y,p);
//println(rend.length);
for(var i = 0; i < rend.length; i++){
    
if(rend[i][1] === this){
    
fill(255, 0, 0);
}
}

}
switch(this.type){
case 'polygon':
beginShape();
for(var i = 0; i < this.data.length; i++){
vertex(this.data[i].x, this.data[i].y);
}
if(this.data[0]||this.data[1]){
vertex(this.data[0].x, this.data[0].y);
vertex(this.data[1].x, this.data[1].y);
}
endShape(CLOSE);
break;
case 'circle':
ellipse(this.data.x,this.data.y,this.data.r*2,this.data.r*2);
break;
}
popMatrix();
};
wall.prototype.destroy = function(){
for(var i = 0; i < walls.length; i++){
if(walls[i] === this){
walls.splice(i,1);
}
}
};
wall.prototype.rot = function(rot){
if(rot !== 0){
var center;
if(this.type === 'polygon'){
center = getCenter(this);
}else{
center = {
x:this.data.x,
y:this.data.y,
};
}
for(var i = 0; i < this.data.length; i++){
var bDist = dist(center.x,center.y,this.data[i].x,this.data[i].y);
var ang1 = atan2(center.y-this.data[i].y,center.x-this.data[i].x);
this.data[i] = {
x:center.x+cos(rot+ang1)*bDist,
y:center.y+sin(rot+ang1)*bDist,
};
}
}
};
wall.prototype.remove = function(){
for(var i = 0; i < this.chunksIn.length; i++){
for(var q = chunks[this.chunksIn[i][0]][this.chunksIn[i][1]].length-1; q > -1; q--){
if(chunks[this.chunksIn[i][0]][this.chunksIn[i][1]][q][1] === this){
chunks[this.chunksIn[i][0]][this.chunksIn[i][1]].splice(q,1);
}
}
}
for(var q = walls.length-1; q > -1; q--){
if(walls[q] === this){
walls.splice(q,1);
}
}
};
function drawWalls(e){
// var rend = toRenderAt(e.x,e.y);
// for(var i = 0; i < rend.length; i++){
// rend[i].draw();
// }
for(var i = walls.length-1; i > -1; i--){
walls[i].draw();
}
}

player.prototype.collide = function(e){
switch(e.type){
case 'polygon':
{
var nearest = function(){};
for(var i = 0; i < e.data.length; i++){

if(i+1 !== e.data.length){
nearest = nearestPointOnLine(e.data[i].x,e.data[i].y,e.data[i+1].x,e.data[i+1].y);
}else{
nearest = nearestPointOnLine(e.data[i].x,e.data[i].y,e.data[0].x,e.data[0].y);
}

var projection = nearest(this.x,this.y);

//getClosest(p,getTriCenter(w.data)).x,getClosest(p,getTriCenter(w.data)).y
//if((isInsideTri(e.data.x1, e.data.y1, e.data.x2, e.data.y2, e.data.x3, e.data.y3, getClosest(this,getTriCenter(e.data)).x, getClosest(this,getTriCenter(e.data)).y))){
// stroke(255, 0, 0);
// strokeWeight(20);
// point(projection.x,projection.y);

if(isInside(e.data, e.data.length, this)){
this.x = this.px;
this.y = this.py;
//println(q);
}

while((dist(this.x,this.y,projection.x,projection.y)<getSize(this.size))){
var dir = atan2(projection.y-this.y,projection.x-this.x);
this.x -= cos(dir);
this.y -= sin(dir);
this.collided = [true,dir,e,i];
// this.vx = 0;
// this.vy = 0;
}
}
//}
}
break;
case 'circle':
{
var dir = atan2(e.data.y-this.y,e.data.x-this.x);
while(dist(e.data.x,e.data.y,this.x,this.y) < getSize(this.size)+e.data.r){
this.x -= cos(dir);
this.y -= sin(dir);
this.collided = [true,dir,e,false];
}
}
break;
}

};
player.prototype.collideSingular = function(e,o){
switch(o.type){
case 'polygon':
{
var nearest = function(){};
var i = o.data.indexOf(e);
//println(walls.indexOf(o));
// for(var q = 0; q < o.data.length; q++){
// if(o.data[q] === e){
// i = q;
// }
// }
//getClosest(p,getTriCenter(w.data)).x,getClosest(p,getTriCenter(w.data)).y
//if((isInsideTri(e.data.x1, e.data.y1, e.data.x2, e.data.y2, e.data.x3, e.data.y3, getClosest(this,getTriCenter(e.data)).x, getClosest(this,getTriCenter(e.data)).y))){


if(isInside(o.data, o.data.length, this)){
this.x = this.px;
this.y = this.py;
//println(i);
}
//var nearest = function(){};
if(i+1 !== o.data.length){
nearest = nearestPointOnLine(e.x,e.y,o.data[i+1].x,o.data[i+1].y);
}else{
nearest = nearestPointOnLine(e.x,e.y,o.data[0].x,o.data[0].y);
}

var projection = nearest(this.x,this.y);

if(showChunkCollisions){
stroke(255, 0, 0);
strokeWeight(20);
point(projection.x,projection.y);
//println(i);
}

while((dist(this.x,this.y,projection.x,projection.y)<getSize(this.size))){
var dir = atan2(projection.y-this.y,projection.x-this.x);
this.x -= cos(dir);
this.y -= sin(dir);
this.collided = [true,dir,o,i];
// this.vx = 0;
// this.vy = 0;
}

if(i-1 >= 0){
nearest = nearestPointOnLine(e.x,e.y,o.data[i-1].x,o.data[i-1].y);
}else{
nearest = nearestPointOnLine(e.x,e.y,o.data[o.data.length-1].x,o.data[o.data.length-1].y);
}

var projection = nearest(this.x,this.y);

while((dist(this.x,this.y,projection.x,projection.y)<getSize(this.size))){
var dir = atan2(projection.y-this.y,projection.x-this.x);
this.x -= cos(dir);
this.y -= sin(dir);
this.collided = [true,dir,o,i];
// this.vx = 0;
// this.vy = 0;
}

//}
}
break;
case 'circle':
{
this.collide(o);
}
break;
}

};
player.prototype.collisions = function(){
this.collided = false;
this.colCount -= 1;
this.colCount = constrain(this.colCount,0,105);
// for(var z = -1; z < 2; z++){
// for(var c = -1; c < 2; c++){
// var rend = toRenderAt(this.x+(z*chunkSize),this.y+(c*chunkSize));
// for(var i = 0; i < rend.length; i++){
// //this.collide(rend[i]);
// //println(rend[i][1].type);
// this.collideSingular(rend[i][0],rend[i][1]);
// }
// }
// }
var rend = fatRenderAt(this.x,this.y,this);
//var rend = allRenderAt(this.x,this.y);
//println(rend.length);
for(var i = 0; i < rend.length; i++){
//this.collide(rend[i]);
//println(rend[i][1].type);
this.collideSingular(rend[i][0],rend[i][1]);
//rend[i][1].remove();
}
if(this.collided){
this.colCount += 2;
}
for(var q = 0; q < players.length; q++){
var targ = players[q];
if(dist(this.x,this.y,targ.x,targ.y) < getSize(this.size)+getSize(targ.size)){
var dir = atan2(targ.y-this.y,targ.x-this.x);
this.x -= cos(dir);
this.y -= sin(dir);
targ.x += cos(dir);
targ.y += sin(dir);
}
}
};
var presets = [
    ['polygon',
    function(x,y,s,r,w){
    w.data = [];
    for(var i = 0; i < s; i++){
    w.data.push({
    x:x+cos(i*(360/s))*r,
    y:y+sin(i*(360/s))*r,
    });
    }
    }],
    ['tree',
    function(x,y,s,r,w){
    w.data = [];
    for(var i = 0; i < s; i++){
    w.data.push({
    x:x+cos(i*(360/s))*r,
    y:y+sin(i*(360/s))*r,
    });
    w.data.push({
    x:x+cos(i*(360/s)+((360/s)/2))*r/1.5,
    y:y+sin(i*(360/s)+((360/s)/2))*r/1.5,
    });
    }
    }],
    ['circle',
    function(x,y,s,r,w){
    w.data = {x:x,y:y,r:r};
    w.type = 'circle';
    }],
    ['rock',
    function(x,y,s,r,w){
    w.data = [];
    w.texture.fill = color(148, 148, 148);
    for(var i = 0; i < s; i++){
    w.data.push({
    x:x+cos(i*(360/s))*r+sin(i*725)*100,
    y:y+sin(i*(360/s))*r,
    });
    }
    }],
    ['rock2',
    function(x,y,s,r,w){
    w.data = [];
    w.texture.fill = color(120, 120, 120);
    for(var i = 0; i < s; i++){
    w.data.push({
    x:x+cos(i*(360/s))*r+sin(i*715)*100,
    y:y+sin(i*(360/s))*r,
    });
    }
    }],
    ];
wall.prototype.preset = function(type,x,y,s,r){
for(var i = 0; i < presets.length; i++){
if(presets[i][0] === type){
presets[i][1](x,y,s,r,this);
}
}
};
var waveFade = 255;
var graphics = {
vent:function(x,y){
stroke(0,0,0);
strokeWeight(2);
fill(163, 163, 163);
rect(x,y,45,30,7);
line(x+10,y+7,x+35,y+7);
line(x+10,y+15,x+35,y+15);
line(x+10,y+23,x+35,y+23);
},
paper:function(x,y,rot){
pushMatrix();
translate(x,y);
rotate(rot);
strokeWeight(1);
stroke(69, 69, 69,150);
fill(255, 255, 255);
rect(0,0,20,30,4);
popMatrix();
},
water:function(x,y){
noStroke();
fill(81, 196, 177);
rect(x,y,10,10,10);
fill(196, 196, 196,150);
rect(x,y-10,10,20,10);
},
};

var maps = [
{
name: 'The Original Forest',
load:function(){
//begin
//println('a');
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',Infinity,Infinity,2,79);
//println('b');
//0
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',77.4148897346833,193.32981936166925,5,79);
//1
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',411.64812240145295,826.239557815765,5,79);
//2
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',507.65128497595066,221.77520086522412,6,104);
//3
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',-71.92336315897978,637.788905354714,5,36);
//4
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',361.86870477023194,556.0084335319938,5,50);
//5
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',-384.8225596980833,139.99472904250388,5,50);
//6
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',450.7605219688409,-258.2406120072643,5,50);
//7
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',710.3246281887791,616.4548692270479,5,50);
//8
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-214.15027067675408,392.4474898865533,5,50);
//9
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',1005.4454612881608,164.88443785811438,5,50);
w.rot(33);
//10
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',2.745763287851787,-212.01686706398755,6,74);
//11
var w = new wall('polygon',[
{
x:1147.672368805935,
y:602.2321784752705,
},
{
x:1193.896113749212,
y:602.2321784752705,
},
{
x:1204.563131813045,
y:829.7952305037094,
},
{
x:1510.3509829762597,
y:826.239557815765,
},
{
x:1506.7953102883152,
y:122.21636560278208,
},
{
x:1417.9034930897064,
y:-59.12294148238021,
},
{
x:1247.2312040683773,
y:-69.78995954621325,
},
{
x:1176.11775030949,
y:22.65753034034003,
},
{
x:1186.784768373323,
y:143.55040173044824,
},
{
x:1147.672368805935,
y:143.55040173044824,
},
{
x:1140.5610234300466,
y:29.768875716228763,
},
{
x:1222.3414952527667,
y:-94.67966836182376,
},
{
x:1435.6818565294282,
y:-98.23534104976812,
},
{
x:1542.352037167759,
y:122.21636560278208,
},
{
x:1553.019055231592,
y:890.2416661987635,
},
{
x:1154.7837141818238,
y:883.1303208228748,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(89, 53, 23),
});
//12
var w = new wall('polygon',[
{
x:1133.4496780541576,
y:271.55461849644513,
},
{
x:1153.4971143749055,
y:264.25794840234573,
},
{
x:1237.4088204570485,
y:494.803466090946,
},
{
x:1217.3613841363006,
y:502.1001361850454,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(89, 53, 23),
});
//13
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(189, 135, 10),
});
w.preset('polygon',1326.766512692526,168.3632676035223,6,74);
//14
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(115, 115, 115),
});
w.preset('circle',1364.7949020515084,691.9849364695114,6,34);
//15
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',-108.95144864505755,811.3355738423177,6,34);
//16
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',-91.39988432552718,875.6913096805956,6,34);
//17
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',-53.37149496654473,934.1965240790302,6,34);
//18
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',10.98424087173322,948.8228276786388,6,34);
//19
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',75.3399767100112,928.3460026391867,6,34);
//20
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',127.99466966860228,896.1681347200478,6,34);
//21
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',133.84519110844573,831.8123988817697,6,34);
//22
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',-76.77358072591858,752.8303594438831,6,34);
//23
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(74, 74, 74),
});
w.preset('circle',-24.118887767327465,717.7272308048224,6,34);
//24
var w = new wall('polygon',[
{
x:-1035.1365995027325,
y:429.60640794601807,
},
{
x:-973.1923604108854,
y:420.07652500881085,
},
{
x:-892.188355444624,
y:639.263832564577,
},
{
x:-658.706223483047,
y:715.5028960622349,
},
{
x:-382.33961830403746,
y:577.31959347273,
},
{
x:-563.4073941109748,
y:162.7696857042158,
},
{
x:-487.1683306133169,
y:-113.59691947479371,
},
{
x:-77.38336431340633,
y:-342.3141099677671,
},
{
x:-201.27184249710024,
y:-685.3898957072272,
},
{
x:-596.7619843912,
y:-847.39790563975,
},
{
x:-1154.2601362178227,
y:-775.9237836106959,
},
{
x:-1392.5072096480033,
y:-523.3818857747044,
},
{
x:-1344.857794961967,
y:-494.7922369630827,
},
{
x:-1139.9653118120118,
y:-733.0393103932633,
},
{
x:-601.5269258598037,
y:-790.2186080165068,
},
{
x:-239.39137424592911,
y:-647.2703639583983,
},
{
x:-129.79772046804607,
y:-361.3738758421815,
},
{
x:-510.993037956335,
y:-166.01127562943344,
},
{
x:-611.0568087970108,
y:138.9449783611977,
},
{
x:-425.22409152147,
y:558.2598275983156,
},
{
x:-653.9412820144433,
y:677.3833643134059,
},
{
x:-873.1285895702094,
y:610.6741837529553,
},
{
x:-958.8975360050745,
y:377.19205179137833,
},
{
x:-1044.6664824399395,
y:391.4868761971892,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(110, 117, 110),
});
//25
var w = new wall('polygon',[
{
x:-1182.8497850294443,
y:415.3115835402072,
},
{
x:-1039.9015409713359,
y:658.3235984389914,
},
{
x:-1125.670487406201,
y:672.6184228448024,
},
{
x:-1197.1446094352552,
y:815.5666669029107,
},
{
x:-1430.6267413968321,
y:858.4511401203432,
},
{
x:-1492.5709804886792,
y:734.5626619366492,
},
{
x:-1497.3359219572828,
y:486.7857055692614,
},
{
x:-1444.921565802643,
y:482.0207641006578,
},
{
x:-1459.216390208454,
y:729.7977204680456,
},
{
x:-1421.0968584596249,
y:815.5666669029107,
},
{
x:-1225.7342582468768,
y:786.977018091289,
},
{
x:-1159.0250776864264,
y:648.7937155017842,
},
{
x:-1092.3158971259757,
y:629.7339496273698,
},
{
x:-1220.9693167782732,
y:415.3115835402072,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(110, 117, 110),
});
//26
var w = new wall('polygon',[
{
x:-1101.845780063183,
y:850.8272337705771,
},
{
x:-935.0728286620565,
y:898.4766484566132,
},
{
x:-763.5349357923265,
y:788.8829946787303,
},
{
x:-734.9452869807049,
y:812.7077020217482,
},
{
x:-930.3078871934529,
y:950.891004611253,
},
{
x:-1111.3756630003902,
y:884.1818240508024,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(110, 117, 110),
});
//27
var w = new wall('polygon',[
{
x:-1161.8840425675885,
y:-411.8822554093798,
},
{
x:-895.0473203257864,
y:-511.94602625005564,
},
{
x:-632.9755395525876,
y:-230.8144796024426,
},
{
x:-937.9317935432189,
y:140.85095494863918,
},
{
x:-1095.174862007138,
y:-2.097289109469159,
},
{
x:-1228.5932231280392,
y:212.32507697769336,
},
{
x:-1276.2426378140754,
y:174.20554522886448,
},
{
x:-1095.174862007138,
y:-59.27658673271253,
},
{
x:-947.4616764804259,
y:74.14177438818862,
},
{
x:-690.154837175831,
y:-221.2845966652353,
},
{
x:-899.81226179439,
y:-459.53167009541596,
},
{
x:-1128.5294522873633,
y:-383.2926065977582,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(110, 117, 110),
});
//28
var w = new wall('polygon',[
{
x:-1423.9558233407872,
y:-402.35237247217265,
},
{
x:-1514.489711244256,
y:-221.2845966652353,
},
{
x:-1509.7247697756522,
y:-78.33635260712697,
},
{
x:-1471.6052380268234,
y:-92.63117701293783,
},
{
x:-1466.8402965582197,
y:-216.51965519663167,
},
{
x:-1390.601233060562,
y:-383.2926065977582,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(110, 117, 110),
});
//29
var w = new wall('polygon',[
{
x:-1509.7247697756522,
y:21.72741823354886,
},
{
x:-1714.6172529256075,
y:136.08601348003558,
},
{
x:-1747.9718432058328,
y:312.38884781836924,
},
{
x:-1500.194886838445,
y:374.3330869102162,
},
{
x:-1485.9000624326343,
y:317.1537892869728,
},
{
x:-1681.2626626453823,
y:288.56414047535117,
},
{
x:-1676.4977211767787,
y:140.85095494863918,
},
{
x:-1452.5454721524088,
y:45.55212557656694,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(110, 117, 110),
});
//30
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(158, 81, 143),
});
w.preset('polygon',-1533.5494771186702,202.79519404048614,6,34);
//31
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(99, 63, 0),
});
w.preset('circle',-967.8817670671997,-224.1772676567574,6,63);
//32
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(99, 63, 0),
});
w.preset('polygon',-579.6023095436757,-560.1883366674994,6,82);
//33
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(99, 63, 0),
});
w.preset('polygon',-336.92764859147326,-418.31699641851947,4,82);
//34
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(99, 63, 0),
});
w.preset('polygon',-721.4736497926556,410.51030714131053,8,91);
//35
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(189, 68, 179),
});
w.preset('circle',-638.5909194366725,480.6992860013321,8,36);
//36
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(189, 68, 179),
});
w.preset('circle',-560.1883366674995,611.3702572832873,8,36);
//37
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(189, 68, 179),
});
w.preset('circle',-914.8666872899494,473.23237335664896,8,36);
//38
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(189, 68, 179),
});
w.preset('circle',-537.78759873345,338.8279457523522,8,36);
//39
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(219, 212, 136),
});
w.preset('circle',-1200.1027503168457,170.82241124698126,8,36);
//40
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(219, 212, 136),
});
w.preset('circle',-1147.8343618040635,193.22314918103072,8,36);
//41
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(219, 212, 136),
});
w.preset('circle',-1099.299429613623,189.48969285868915,8,36);
//42
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(219, 212, 136),
});
w.preset('circle',-976.095370976351,114.82056641185761,8,36);
//43
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-1315.8398963094346,603.9033446386042,5,60);
w.rot(-50);
//44
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-1304.6395273424098,-209.99013363185952,5,60);
//45
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-1252.3711388296276,-251.05815317761687,5,60);
w.rot(-80);
//46
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-1181.4354687051377,-202.5232209871764,5,60);
w.rot(50);
//47
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-991.0291962657175,-621.4170203539012,5,60);
w.rot(50);
//48
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock',-135.32100718502767,-24.064008779249093,5,60);
w.rot(180);
//49
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock2',816.7103550120743,-50.94489430010816,5,60);
//50
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock2',865.2452872025148,370.93567012448995,5,32);
//51
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('rock2',917.5136757152968,800.2831471937712,5,44);
//52
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',958.5816952610542,571.7956202664668,5,73);
//53
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',1085.519210220668,-260.7651396157047,5,49);
//54
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',678.572471085436,-361.56846031892735,5,49);
//55
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',290.293013561912,-47.95812924223486,5,49);
//56
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',241.75808137147152,-436.2375867657588,6,69);
//57
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',55.008392818061964,519.6476478182897,6,69);

//}
var w = new wall('polygon',[
{
x:-1527.550585196441,
y:-724.2908884581823,
},
{
x:-2021.7260138385464,
y:-328.9505455444978,
},
{
x:-2012.7410060450534,
y:470.7151480763637,
},
{
x:-1419.730491674527,
y:1081.695678033876,
},
{
x:395.2410826110239,
y:1126.62071700134,
},
{
x:1725.0222360479622,
y:1009.8156156859333,
},
{
x:1769.9472750154264,
y:-104.32535070717722,
},
{
x:1248.8168229928424,
y:-706.3208728711966,
},
{
x:-449.34964997730174,
y:-1155.571262545838,
},
{
x:-1536.5355929899338,
y:-733.275896251675,
},
{
x:-1545.5206007834265,
y:-787.1859430126319,
},
{
x:-449.34964997730174,
y:-1200.4963015133021,
},
{
x:1266.786838579828,
y:-742.260904045168,
},
{
x:1832.8423295698763,
y:-122.29536629416282,
},
{
x:1769.9472750154264,
y:1063.7256624468903,
},
{
x:413.21109819800955,
y:1189.5157715557898,
},
{
x:-1437.7005072615127,
y:1153.5757403818184,
},
{
x:-2057.6660450125173,
y:506.655179250335,
},
{
x:-2084.6210683929958,
y:-337.93555333799065,
},
{
x:-1509.5805696094553,
y:-796.1709508061249,
},],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(82, 82, 82),
});
},
background:function(){
randomSeed(3);
var offColor = 10;
//color(3, 145, 10)
var baseColor = [57,145,79];
background(baseColor[0],baseColor[1],baseColor[2]);
for(var i = 0; i < 300; i++){

fill(baseColor[0]+random(-offColor,offColor), baseColor[1]+random(-offColor,offColor), baseColor[2]+random(-offColor,offColor));
noStroke();
var r = random(1,200);
ellipse(random(0,600),random(0,600),r,r);
}
bg = get(0,0,600,600);
},
bgCur:function(){
var baseColor = [57,145,79];
background(baseColor[0],baseColor[1],baseColor[2]);
},
bgMid:function(){
pushMatrix();
var x = -1100;
var y = 50;
translate(x,y);
rotate(114);
translate(-x,-y);
drawWeapon('iron spear',{
x:x,
y:y,
charge:0,
},100,true);
popMatrix();

pushMatrix();
var x = -1090;
var y = 50;
translate(x,y);
rotate(124);
translate(-x,-y);
drawWeapon('iron spear',{
x:x,
y:y,
charge:0,
},100,true);
popMatrix();
},
bgTop:function(){
graphics.water(-672,425);
graphics.water(-775,450);
drawWeapon('iron sword',{
x:-760,
y:400,
charge:0,
},100,true);
graphics.paper(-730,370,-50);
pushMatrix();
var x = -700;
var y = 330;
translate(x,y);
rotate(90);
translate(-x,-y);
drawWeapon('iron dagger',{
x:x,
y:y,
charge:0,
},100,true);
popMatrix();



stroke(0,0,0);
strokeWeight(2);
line(-715,372,-706,376);

graphics.water(-370,-440);
graphics.paper(-310,-420,60);

pushMatrix();
var x = -590;
var y = -585;
translate(x,y);
rotate(124);
translate(-x,-y);
drawWeapon('heavy axe',{
x:x,
y:y,
charge:0,
},100,true);
popMatrix();

graphics.water(-950,-230);
graphics.paper(-990,-230,40);

graphics.water(1360,695);

pushMatrix();
var x = 1385;
var y = 190;
translate(x,y);
rotate(124);
scale(0.9);
translate(-x,-y);
drawWeapon('iron greatsword',{
x:x,
y:y,
charge:0,
},100,true);
popMatrix();

},
},
{
name: 'Just A Wall lol',
load:function(){
//begin
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:5,
fill:color(125, 186, 125),
});
w.preset('tree',Infinity,Infinity,2,79);

var w = new wall('polygon',[
{
x:-1527.550585196441,
y:-724.2908884581823,
},
{
x:-2021.7260138385464,
y:-328.9505455444978,
},
{
x:-2012.7410060450534,
y:470.7151480763637,
},
{
x:-1419.730491674527,
y:1081.695678033876,
},
{
x:395.2410826110239,
y:1126.62071700134,
},
{
x:1725.0222360479622,
y:1009.8156156859333,
},
{
x:1769.9472750154264,
y:-104.32535070717722,
},
{
x:1248.8168229928424,
y:-706.3208728711966,
},
{
x:-449.34964997730174,
y:-1155.571262545838,
},
{
x:-1536.5355929899338,
y:-733.275896251675,
},
{
x:-1545.5206007834265,
y:-787.1859430126319,
},
{
x:-449.34964997730174,
y:-1200.4963015133021,
},
{
x:1266.786838579828,
y:-742.260904045168,
},
{
x:1832.8423295698763,
y:-122.29536629416282,
},
{
x:1769.9472750154264,
y:1063.7256624468903,
},
{
x:413.21109819800955,
y:1189.5157715557898,
},
{
x:-1437.7005072615127,
y:1153.5757403818184,
},
{
x:-2057.6660450125173,
y:506.655179250335,
},
{
x:-2084.6210683929958,
y:-337.93555333799065,
},
{
x:-1509.5805696094553,
y:-796.1709508061249,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(82, 82, 82),
});
},
background:function(){
randomSeed(3);
var offColor = 10;
//color(66, 116, 117)
var baseColor = [66, 116, 117];
background(baseColor[0],baseColor[1],baseColor[2]);
for(var i = 0; i < 300; i++){

fill(baseColor[0]+random(-offColor,offColor), baseColor[1]+random(-offColor,offColor), baseColor[2]+random(-offColor,offColor));
noStroke();
var r = random(1,200);
ellipse(random(0,600),random(0,600),r,r);
}
bg = get(0,0,600,600);
},
bgCur:function(){
var baseColor = [66, 116, 117];
background(baseColor[0],baseColor[1],baseColor[2]);
},
},
{
name: 'ඞ',
load:function(){//begin
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
w.preset('tree',Infinity,Infinity,2,79);
//1
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
w.preset('tree',Infinity,Infinity,2,79);
//2
var w = new wall('polygon',[
{
x:97.15375212740526,
y:239.45398672268254,
},
{
x:98.86409148552156,
y:46.18563925553909,
},
{
x:283.5807421620834,
y:-97.48286682623126,
},
{
x:880.436747691654,
y:-102.06470989815853,
},
{
x:1036.3563611475065,
y:53.85490355769409,
},
{
x:1040.5142175063293,
y:236.80058334589447,
},
{
x:1077.934924735734,
y:234.72165516648312,
},
{
x:1077.934924735734,
y:35.14454994299177,
},
{
x:882.5156758710654,
y:-156.11684256285406,
},
{
x:242.20579661236405,
y:-147.8011298452086,
},
{
x:55.10226046534095,
y:20.592052687112187,
},
{
x:65.49690136239781,
y:240.9584397047172,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//3
var w = new wall('polygon',[
{
x:106.6596793147429,
y:408.5200509652734,
},
{
x:108.73860749415428,
y:549.8871671652464,
},
{
x:291.68428728235466,
y:676.7017861093398,
},
{
x:528.6820997352506,
y:680.8596424681625,
},
{
x:530.761027914662,
y:726.5960624152126,
},
{
x:283.36857456470915,
y:720.3592778769786,
},
{
x:69.23897208533828,
y:572.7553771387715,
},
{
x:67.16004390592693,
y:410.59897914468473,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//4
var w = new wall('polygon',[
{
x:742.8117022146214,
y:676.7017861093398,
},
{
x:929.9152383616446,
y:670.4650015711057,
},
{
x:1013.0723655380993,
y:574.8343053181828,
},
{
x:1029.7037909733904,
y:418.9146918623302,
},
{
x:1065.0455700233833,
y:420.99362004174156,
},
{
x:1050.493072767504,
y:581.0710898564168,
},
{
x:936.1520228998787,
y:716.2014215181558,
},
{
x:742.8117022146214,
y:714.1224933387444,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//5
var w = new wall('polygon',[
{
x:104.58075113533152,
y:409.35162223703765,
},
{
x:-36.78636506464147,
y:409.35162223703765,
},
{
x:-36.78636506464147,
y:440.5355449282082,
},
{
x:104.58075113533152,
y:440.5355449282082,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//6
var w = new wall('polygon',[
{
x:-280.0209620557715,
y:407.27269405762627,
},
{
x:-155.28527129108943,
y:407.27269405762627,
},
{
x:-155.28527129108943,
y:440.5355449282082,
},
{
x:-280.0209620557715,
y:440.5355449282082,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//7
var w = new wall('polygon',[
{
x:-298.7313156704738,
y:407.27269405762627,
},
{
x:-257.5685377181287,
y:407.27269405762627,
},
{
x:-257.56853771812865,
y:896.23660185518,
},
{
x:-298.73131567047375,
y:896.23660185518,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//8
var w = new wall('polygon',[
{
x:-257.5685377181287,
y:896.23660185518,
},
{
x:-178.56926690049676,
y:979.3937290316347,
},
{
x:162.37495452296758,
y:989.7883699286915,
},
{
x:176.92745177884717,
y:759.0273420140297,
},
{
x:68.82318644945605,
y:576.0816622258294,
},
{
x:95.84925278180381,
y:565.6870213287725,
},
{
x:233.05851262295408,
y:783.974480166966,
},
{
x:203.95351811119497,
y:1060.4719280286781,
},
{
x:-238.85818410342642,
y:1025.1301489786847,
},
{
x:-297.06817312694466,
y:892.0787454963572,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//9
var w = new wall('polygon',[
{
x:-585.6124445437822,
y:405.1382581650662,
},
{
x:-250.20205039755717,
y:405.1382581650662,
},
{
x:-250.20205039755717,
y:440.6143575459169,
},
{
x:-585.6124445437822,
y:440.6143575459169,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//10
var w = new wall('polygon',[
{
x:98.10874352352258,
y:240.6581610356674,
},
{
x:-588.8375444874958,
y:240.6581610356674,
},
{
x:-588.8375444874958,
y:205.1820616548167,
},
{
x:98.10874352352258,
y:205.1820616548167,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//11
var w = new wall('polygon',[
{
x:-595.9327643636659,
y:76.17806390626865,
},
{
x:-550.7813651516741,
y:76.17806390626865,
},
{
x:-550.7813651516741,
y:237.4330610919537,
},
{
x:-595.9327643636659,
y:237.4330610919537,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//12
var w = new wall('polygon',[
{
x:-595.1163806196031,
y:77.22926818548501,
},
{
x:-815.4049872885521,
y:77.22926818548501,
},
{
x:-892.9713980874778,
y:159.44966363234633,
},
{
x:-887.6987759230688,
y:550.3107097644307,
},
{
x:-938.7825942423406,
y:550.3107097644307,
},
{
x:-951.5535488221585,
y:148.02564050016522,
},
{
x:-862.1568667634328,
y:39.47252657171265,
},
{
x:-587.581343297347,
y:45.8580038616216,
},
{
x:-530.1120476881662,
y:77.78539031116648,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//13
var w = new wall('polygon',[
{
x:-587.2037999999989,
y:407.42759999999976,
},
{
x:-547.844549999999,
y:407.42759999999976,
},
{
x:-547.844549999999,
y:557.9188499999996,
},
{
x:-587.2037999999989,
y:557.9188499999996,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//14
var w = new wall('polygon',[
{
x:-938.0513663928136,
y:552.6220785910936,
},
{
x:-768.7336193478445,
y:552.6220785910936,
},
{
x:-768.7336193478445,
y:762.5760849268554,
},
{
x:-938.0513663928136,
y:762.5760849268554,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//15
var w = new wall('polygon',[
{
x:-548.6205481893846,
y:549.2357236501941,
},
{
x:-660.3702612390642,
y:549.2357236501941,
},
{
x:-660.3702612390642,
y:765.9624398677547,
},
{
x:-548.6205481893846,
y:765.9624398677547,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//16
var w = new wall('polygon',[
{
x:-934.6650114519143,
y:891.257572681032,
},
{
x:-768.7336193478445,
y:891.257572681032,
},
{
x:-768.7336193478445,
y:1114.7569987803913,
},
{
x:-934.6650114519143,
y:1114.7569987803913,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//17
var w = new wall('polygon',[
{
x:-656.9839062981648,
y:891.257572681032,
},
{
x:-545.2341932484853,
y:891.257572681032,
},
{
x:-545.2341932484853,
y:1114.7569987803913,
},
{
x:-656.9839062981648,
y:1114.7569987803913,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//18
var w = new wall('polygon',[
{
x:-548.6205481893846,
y:1019.9390604352086,
},
{
x:-328.50747703092475,
y:1023.3254153761079,
},
{
x:-325.1211220900253,
y:559.3947884728923,
},
{
x:-372.5300912626167,
y:461.19049518681015,
},
{
x:-474.12073948959824,
y:457.8041402459108,
},
{
x:-531.6887734848877,
y:525.5312390638985,
},
{
x:-568.9386778347808,
y:535.6903038865967,
},
{
x:-497.82522407589386,
y:423.94059083691695,
},
{
x:-325.1211220900253,
y:434.0996556596151,
},
{
x:-254.00766833113823,
y:1036.8708351397054,
},
{
x:-555.3932580711835,
y:1060.575319726001,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//19
var w = new wall('polygon',[
{
x:-1068.4036962767495,
y:353.42694698794134,
},
{
x:-933.633019190049,
y:353.42694698794134,
},
{
x:-933.633019190049,
y:601.3087280581228,
},
{
x:-1068.4036962767495,
y:601.3087280581228,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//20
var w = new wall('polygon',[
{
x:-1065.9970770430584,
y:1027.2803324214447,
},
{
x:-924.0065422552846,
y:1027.2803324214447,
},
{
x:-924.0065422552846,
y:1301.634925062228,
},
{
x:-1065.9970770430584,
y:1301.634925062228,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//21
var w = new wall('polygon',[
{
x:-1065.9970770430584,
y:401.559331661763,
},
{
x:-1220.0207079992879,
y:399.15271242807194,
},
{
x:-1508.8150160422178,
y:493.01086254202414,
},
{
x:-1513.6282545095999,
y:1154.8311518070718,
},
{
x:-1222.427327232979,
y:1248.6893019210243,
},
{
x:-1061.1838385756764,
y:1253.5025403884065,
},
{
x:-1241.6802811025075,
y:1306.4481635296102,
},
{
x:-1576.200354585568,
y:1169.2708672092185,
},
{
x:-1571.387116118186,
y:387.11961625961646,
},
{
x:-1010.6448346681636,
y:288.4482276782821,
},
{
x:-1010.6448346681636,
y:288.4482276782821,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//22
var w = new wall('polygon',[
{
x:-924.0729120374119,
y:1304.953881927454,
},
{
x:-926.1518402168233,
y:1556.504191636229,
},
{
x:-849.2314975786028,
y:1666.6873851450316,
},
{
x:-549.8658397433661,
y:1662.5295287862089,
},
{
x:-549.0342684716016,
y:1546.1095507391722,
},
{
x:-513.6924894216085,
y:1548.1884789185835,
},
{
x:-519.9292739598425,
y:1710.34487691267,
},
{
x:-977.293473430343,
y:1712.4238050920815,
},
{
x:-985.6091861479886,
y:1288.3224564921627,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//23
var w = new wall('polygon',[
{
x:-553.3005419744461,
y:1077.9468871483448,
},
{
x:-513.5010763972797,
y:1077.9468871483448,
},
{
x:-513.5010763972797,
y:1322.0502760216318,
},
{
x:-553.3005419744461,
y:1322.0502760216318,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//24
var w = new wall('polygon',[
{
x:-524.0415027404401,
y:1550.9422065262725,
},
{
x:-371.46580828119295,
y:1550.9422065262725,
},
{
x:-371.46580828119295,
y:1933.8356314853627,
},
{
x:-524.0415027404401,
y:1933.8356314853627,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//25
var w = new wall('polygon',[
{
x:-545.6212052417329,
y:1079.1841464012314,
},
{
x:-103.78251295295547,
y:1079.1841464012314,
},
{
x:-103.78251295295546,
y:1321.0666421797591,
},
{
x:-545.6212052417329,
y:1321.0666421797591,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//26
var w = new wall('polygon',[
{
x:-165.05941188351585,
y:1153.3614451066464,
},
{
x:-87.65701323438697,
y:1153.3614451066464,
},
{
x:-87.65701323438694,
y:1695.1782356505487,
},
{
x:-165.05941188351582,
y:1695.1782356505487,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//27
var w = new wall('polygon',[
{
x:-429.51760726803957,
y:1849.9830329488066,
},
{
x:250.978480855552,
y:1849.9830329488066,
},
{
x:250.978480855552,
y:1943.510931316504,
},
{
x:-429.51760726803957,
y:1943.510931316504,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//28
var w = new wall('polygon',[
{
x:-155.38411205237475,
y:1024.3574473580984,
},
{
x:467.0601770843701,
y:1024.3574473580984,
},
{
x:467.0601770843701,
y:1153.3614451066464,
},
{
x:-155.38411205237475,
y:1153.3614451066464,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//29
var w = new wall('polygon',[
{
x:454.1597773095152,
y:1146.911245219219,
},
{
x:454.1597773095152,
y:1298.4909425737633,
},
{
x:318.7055796735397,
y:1404.9192407163152,
},
{
x:312.2553797861123,
y:1566.1742379020006,
},
{
x:231.6278811932697,
y:1643.5766365511295,
},
{
x:80.04818383872563,
y:1646.8017364948432,
},
{
x:76.8230838950119,
y:1691.953135706835,
},
{
x:438.0342775909468,
y:1685.5029358194076,
},
{
x:444.4844774783742,
y:1401.6941407726017,
},
{
x:515.4366762400756,
y:1340.4172418420412,
},
{
x:521.886876127503,
y:1153.3614451066464,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//30
var w = new wall('polygon',[
{
x:461.9121259016777,
y:705.2689831422279,
},
{
x:530.315280507592,
y:706.462964647169,
},
{
x:521.957409973004,
y:1185.2850468885695,
},
{
x:453.55425536708975,
y:1184.0910653836281,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//31
var w = new wall('polygon',[
{
x:253.19582848125236,
y:1856.7958955164393,
},
{
x:448.18088143373694,
y:2004.0801364879785,
},
{
x:925.6526104980012,
y:2028.776950060268,
},
{
x:933.8848816887644,
y:1580.118170163675,
},
{
x:983.2785088333434,
y:1580.118170163675,
},
{
x:979.1623732379618,
y:2090.5189839909917,
},
{
x:192.98047452007847,
y:2024.6608144648865,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//32
var w = new wall('polygon',[
{
x:928.8315561192281,
y:1130.4821817102052,
},
{
x:979.2442125169722,
y:1130.4821817102052,
},
{
x:979.2442125169722,
y:1395.8119522246473,
},
{
x:928.8315561192281,
y:1395.8119522246473,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//33
var w = new wall('polygon',[
{
x:753.7139075796962,
y:1119.8689908896272,
},
{
x:979.2442125169722,
y:1119.8689908896272,
},
{
x:979.2442125169722,
y:1159.6684564667937,
},
{
x:753.7139075796962,
y:1159.6684564667937,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//34
var w = new wall('polygon',[
{
x:743.1007167591185,
y:690.0347626562308,
},
{
x:981.8975102221166,
y:690.0347626562308,
},
{
x:981.8975102221166,
y:899.6452813626403,
},
{
x:743.1007167591185,
y:899.6452813626403,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//35
var w = new wall('polygon',[
{
x:936.2607896936325,
y:1583.6654297488726,
},
{
x:1252.003216605819,
y:1583.6654297488726,
},
{
x:1252.003216605819,
y:1626.1181930311834,
},
{
x:936.2607896936325,
y:1626.1181930311834,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//36
var w = new wall('polygon',[
{
x:1474.8802238379503,
y:1588.9720251591616,
},
{
x:1628.771490736327,
y:1588.9720251591616,
},
{
x:1628.771490736327,
y:1626.1181930311834,
},
{
x:1474.8802238379503,
y:1626.1181930311834,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//37
var w = new wall('polygon',[
{
x:1628.771490736327,
y:1594.2786205694504,
},
{
x:1623.464895326038,
y:1992.2732763411138,
},
{
x:1464.2670330173728,
y:2127.5914593034795,
},
{
x:1079.5388657714313,
y:2106.365077662324,
},
{
x:976.0602552707988,
y:1976.3534901102473,
},
{
x:976.0602552707988,
y:1912.6743451867812,
},
{
x:1092.8053542971534,
y:2069.218909790302,
},
{
x:1456.3071399019395,
y:2090.4452914314575,
},
{
x:1583.6654297488717,
y:1976.3534901102473,
},
{
x:1596.931918274594,
y:1610.198406800317,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//38
var w = new wall('polygon',[
{
x:965.4470644502212,
y:1323.1115951036902,
},
{
x:962.7937667450768,
y:1397.403930847734,
},
{
x:1631.4247884414715,
y:1410.670419373456,
},
{
x:1769.3962691089814,
y:1254.1258547699354,
},
{
x:1854.301795673603,
y:1251.4725570647906,
},
{
x:1862.2616887890363,
y:1206.3664960773356,
},
{
x:1729.596803531815,
y:1206.3664960773356,
},
{
x:1604.8918113900272,
y:1344.3379767448455,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//39
var w = new wall('polygon',[
{
x:933.6074919884882,
y:813.678435715961,
},
{
x:1782.6627576347034,
y:813.678435715961,
},
{
x:1782.6627576347034,
y:895.9306645754381,
},
{
x:933.6074919884882,
y:895.9306645754381,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//40
var w = new wall('polygon',[
{
x:1859.6083910838918,
y:1211.6730914876243,
},
{
x:1729.596803531815,
y:1211.6730914876243,
},
{
x:1729.596803531815,
y:816.3317334211054,
},
{
x:1859.6083910838918,
y:816.3317334211054,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//41
var w = new wall('polygon',[
{
x:1625.107532221195,
y:1761.248717038441,
},
{
x:1915.5420598313199,
y:1761.248717038441,
},
{
x:1915.5420598313199,
y:1793.0149934957983,
},
{
x:1625.107532221195,
y:1793.0149934957983,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//42
var w = new wall('polygon',[
{
x:1914.9561067226093,
y:1765.0581087384212,
},
{
x:2100.609590464493,
y:1593.1567349033435,
},
{
x:2112.069682053498,
y:1263.1060971399945,
},
{
x:2024.972985977059,
y:1263.1060971399945,
},
{
x:2024.972985977059,
y:1235.6018773263822,
},
{
x:2157.910048409519,
y:1233.309859008581,
},
{
x:2160.20206672732,
y:1746.7219621960128,
},
{
x:1910.3720700870072,
y:1785.6862735986304,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//43
var w = new wall('polygon',[
{
x:2027.2650042948599,
y:1242.477932279785,
},
{
x:2155.6180300917176,
y:1242.477932279785,
},
{
x:2155.6180300917176,
y:969.7277524614618,
},
{
x:2027.2650042948599,
y:969.7277524614618,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//44
var w = new wall('polygon',[
{
x:1777.0264345720873,
y:656.9895378696128,
},
{
x:2161.039084870078,
y:656.9895378696128,
},
{
x:2161.039084870078,
y:820.5504815150533,
},
{
x:1777.0264345720873,
y:820.5504815150533,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//45
var w = new wall('polygon',[
{
x:2339.5338538048845,
y:1030.3351701037705,
},
{
x:2026.6346572657812,
y:1030.3351701037705,
},
{
x:2026.6346572657812,
y:969.8887344087165,
},
{
x:2339.5338538048845,
y:969.8887344087165,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//46
var w = new wall('polygon',[
{
x:941.8857808285397,
y:677.2193347403826,
},
{
x:1168.3438572374828,
y:458.53131238786347,
},
{
x:1193.5026562691885,
y:484.5840114437596,
},
{
x:967.0445798602456,
y:703.2720337962787,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//47
var w = new wall('polygon',[
{
x:1192.622413964688,
y:484.9879160026691,
},
{
x:1195.4083765550895,
y:418.12481383302963,
},
{
x:1761.5159749247036,
y:412.5528886522264,
},
{
x:1761.5159749247036,
y:451.5563649178494,
},
{
x:1783.8036756479169,
y:448.77040232744775,
},
{
x:1783.8036756479169,
y:390.2651879290132,
},
{
x:1154.1761302171453,
y:401.4090382906198,
},
{
x:1154.1761302171453,
y:482.20195341226747,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//48
var w = new wall('polygon',[
{
x:1756.7946569776825,
y:338.0812544878843,
},
{
x:1865.064890325588,
y:338.0812544878843,
},
{
x:1865.064890325588,
y:450.0849441581315,
},
{
x:1756.7946569776825,
y:450.0849441581315,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//49
var w = new wall('polygon',[
{
x:2025.603512186276,
y:345.5481671325674,
},
{
x:2342.9472995853102,
y:345.5481671325674,
},
{
x:2342.9472995853102,
y:453.8184004804731,
},
{
x:2025.603512186276,
y:453.8184004804731,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//50
var w = new wall('polygon',[
{
x:1163.25253875,
y:460.20372375000005,
},
{
x:1029.54685125,
y:460.20372375000005,
},
{
x:1029.54685125,
y:401.85942375,
},
{
x:1163.25253875,
y:401.85942375,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//51
var w = new wall('polygon',[
{
x:1043.0089313216226,
y:128.69631801650326,
},
{
x:1417.216003615669,
y:128.69631801650326,
},
{
x:1417.216003615669,
y:236.80058334589444,
},
{
x:1043.0089313216226,
y:236.80058334589444,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//52
var w = new wall('polygon',[
{
x:1414.7604390505478,
y:157.10893523951492,
},
{
x:1414.7604390505478,
y:-21.50489571109148,
},
{
x:1661.6677935999155,
y:-21.50489571109148,
},
{
x:2045.162195346806,
y:130.84219539383753,
},
{
x:2060.9222392542124,
y:356.7361580666633,
},
{
x:2139.722458791244,
y:356.7361580666633,
},
{
x:2108.2023709764317,
y:88.81541164075367,
},
{
x:1309.6934796678383,
y:-189.61203072342693,
},
{
x:1341.2135674826511,
y:151.85558727037946,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//53
var w = new wall('polygon',[
{
x:2312.032272178888,
y:417.6749945086353,
},
{
x:2611.4731064196108,
y:417.6749945086353,
},
{
x:2611.4731064196108,
y:617.3022173357836,
},
{
x:2312.032272178888,
y:617.3022173357836,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//54
var w = new wall('polygon',[
{
x:2312.032272178888,
y:801.1693962555255,
},
{
x:2616.726454388746,
y:801.1693962555255,
},
{
x:2616.726454388746,
y:1006.0499670518094,
},
{
x:2312.032272178888,
y:1006.0499670518094,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//55
var w = new wall('polygon',[
{
x:2600.9664104813396,
y:937.7564434530481,
},
{
x:2895.153896752927,
y:943.0097914221835,
},
{
x:3058.0076837961265,
y:811.6760921937964,
},
{
x:3058.0076837961265,
y:580.5287815518352,
},
{
x:2889.9005487837912,
y:428.18169044690626,
},
{
x:2585.2063665739333,
y:433.4350384160417,
},
{
x:2590.4597145430685,
y:375.6482107555514,
},
{
x:2942.434028475146,
y:375.6482107555514,
},
{
x:3152.5679472405654,
y:575.2754335826997,
},
{
x:3157.821295209701,
y:858.9562239160158,
},
{
x:2968.7007683208235,
y:1006.0499670518094,
},
{
x:2579.9530186047978,
y:985.0365751752674,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//56
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(66,126,162),
});
w.preset('circle',581.9422597601704,307.1277537579818,3,77);
//57
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(66,126,162),
});
w.preset('circle',797.7548040990648,77.45568822301152,3,77);
//58
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(66,126,162),
});
w.preset('circle',374.0494418190336,83.39548302132971,3,77);
//59
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(66,126,162),
});
w.preset('circle',379.98923661735176,538.7797508923913,3,77);
//60
var w = new wall('polygon',[],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(66,126,162),
});
w.preset('circle',803.6945988973831,526.900161295755,3,77);
//61
var w = new wall('polygon',[
{
x:-565.5129563263654,
y:1039.1744637907086,
},
{
x:-280.77993583555667,
y:1031.6318672214159,
},
{
x:-269.4660409816173,
y:950.5489541015166,
},
{
x:-114.84281131111186,
y:1031.6318672214159,
},
{
x:-131.81365359202096,
y:1108.9434820566685,
},
{
x:-573.0555528956584,
y:1099.5152363450525,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//62
var w = new wall('polygon',[
{
x:1051.0967429286793,
y:434.0684165352864,
},
{
x:1172.6207462208977,
y:441.9086748122037,
},
{
x:1172.6207462208977,
y:481.1099661967903,
},
{
x:1039.3363555133033,
y:606.5540986274673,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//63
var w = new wall('polygon',[
{
x:-562.2711390037499,
y:417.6335953340626,
},
{
x:-559.4569381584374,
y:525.9803278785939,
},
{
x:-479.2522140670311,
y:431.70459956062507,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//64
var w = new wall('polygon',[
{
x:-352.6131760279685,
y:421.8548966020313,
},
{
x:-293.514958276406,
y:673.7258722575002,
},
{
x:-276.62975320453097,
y:427.48329829265634,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//65
var w = new wall('polygon',[
{
x:-1030.4969999999998,
y:299.55899999999997,
},
{
x:-938.9894999999997,
y:244.43399999999997,
},
{
x:-920.2469999999998,
y:399.88649999999996,
},
{
x:-1084.5194999999997,
y:361.299,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//66
var w = new wall('polygon',[
{
x:-552.4529999999995,
y:70.01849999999996,
},
{
x:-316.5179999999996,
y:144.98849999999996,
},
{
x:-114.53999999999962,
y:215.5485,
},
{
x:-566.3444999999996,
y:213.34349999999998,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//67
var w = new wall('polygon',[
{
x:-1238.0311169844142,
y:1305.5561750428367,
},
{
x:-952.8822163331251,
y:1318.8532740369383,
},
{
x:-949.9273054455471,
y:1259.7550562853758,
},
{
x:-1261.6704040850393,
y:1252.3677790664306,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//68
var w = new wall('polygon',[
{
x:72.17637056772685,
y:1916.0407644164775,
},
{
x:190.37280607085188,
y:2022.41755636929,
},
{
x:247.99356837862533,
y:1916.0407644164775,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//69
var w = new wall('polygon',[
{
x:971.6512447465083,
y:1954.454605954993,
},
{
x:964.263967527563,
y:2087.4255958960084,
},
{
x:1079.50549214311,
y:2105.1550612214774,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//70
var w = new wall('polygon',[
{
x:1611.260174555841,
y:1783.5972260688945,
},
{
x:1603.1157014219539,
y:1858.5263789006567,
},
{
x:2042.9172506518632,
y:1773.8238583082298,
},
{
x:2146.8407278402647,
y:1745.8068707276577,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//71
var w = new wall('polygon',[
{
x:2145.29625067752,
y:1254.892725672487,
},
{
x:2673.2780105280262,
y:987.1305474625874,
},
{
x:2128.3254083966112,
y:989.0161966049106,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//72
var w = new wall('polygon',[
{
x:2096.122660653037,
y:117.81410417961283,
},
{
x:2123.2135001802326,
y:371.790724747067,
},
{
x:2461.8489942701713,
y:480.1540828558475,
},
{
x:2732.7573895421224,
y:381.9497895697652,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//73
var w = new wall('polygon',[
{
x:60.05256418770159,
y:23.28642482936425,
},
{
x:-72.17653350456027,
y:207.11712162104538,
},
{
x:82.6282637936975,
y:210.3422215647591,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});
//74
var w = new wall('polygon',[
{
x:881.8080298459532,
y:-156.6741520298604,
},
{
x:1313.9714223035896,
y:-185.70005152328378,
},
{
x:1381.6985211215774,
y:149.71034262294148,
},
{
x:1062.4136266939208,
y:156.1605425103689,
},
{
x:1052.7383268627796,
y:46.50714442410296,
},],{
stroke:color(0, 0, 0),
strokeWeight:0,
fill:color(60,74,74),
});},
background:function(){
background(0, 0, 0);
pushMatrix();
noStroke();
fill(128,156,167);
rect(252,318,58,18);
rect(340,318,20,77);
rect(340,370,39,22);
rect(252,404,39,22);
rect(270,404,20,44);
rect(270,433,52,20);
rect(374,410,57,20);
rect(357,318,58,15);
rect(438,333,51,23);
rect(443,365,51,14);
rect(443,347,68,20);
rect(445,365,22,39);
fill(110,105,99);
rect(236,342,13,50);
rect(223,359,35,13);

fill(159,163,148);
noStroke();

beginShape();
vertex(307,300);
vertex(322,289);
vertex(384,289);
vertex(384,345);
vertex(373,356);
vertex(322,356);
vertex(307,345);
endShape();
fill(110,105,99);
beginShape();
vertex(233,305);
vertex(255,305);
vertex(255,350);
vertex(225,350);
vertex(225,310);
endShape();
fill(110,105,99);
rect(223,385,35,50);
fill(134,135,166);
beginShape();
vertex(176,335);
vertex(203,330);
vertex(228,330);
vertex(228,385);
vertex(218,385);
vertex(218,403);
vertex(200,403);
vertex(176,392);
endShape();
fill(60,74,74);
rect(223,342,6,5);
fill(50,100,88);
beginShape();
vertex(255,335);
vertex(276,335);
vertex(276,388);
vertex(255,388);
endShape();
fill(110,133,138);
beginShape();
vertex(276,334);
vertex(308,334);
vertex(308,343);
vertex(320,359);
vertex(320,388);
vertex(276,388);
endShape();
fill(60,74,74);
//fill(255, 0, 0);
noStroke();
beginShape();
vertex(306,345);
//vertex(310,350);
vertex(324,356);
vertex(340,356);
vertex(340,385);
vertex(314,385);
vertex(316,361);
endShape();
fill(90,92,78);
beginShape();
vertex(289,392);
vertex(340,392);
vertex(331,434);
vertex(289,434);
endShape();
fill(91,102,107);
beginShape();
vertex(339,391);
vertex(375,391);
vertex(375,434);
vertex(375,465);
vertex(320,461);
vertex(320,430);
vertex(331,430);
vertex(332,410);
vertex(336,410);
endShape();
fill(121,81,89);
beginShape();
vertex(376,369);
vertex(445,369);
vertex(442,397);
vertex(430,410);
vertex(376,410);
endShape();
fill(86,118,129);
beginShape();
vertex(376,429);
vertex(429,429);
vertex(429,447);
vertex(428,460);
vertex(416,469);
vertex(376,465);
vertex(376,460);
endShape();
fill(196,196,170);
beginShape();
vertex(442,397);
vertex(470,397);
vertex(470,437);
vertex(428,447);
vertex(428,410);
endShape();
fill(196,196,170);
beginShape();
vertex(410,297);
vertex(438,297);
vertex(468,309);
vertex(470,334);
vertex(447,334);
vertex(447,332.5);
vertex(410,332.5);
endShape();
fill(105,130,119);
beginShape();
vertex(385,332.5);
vertex(447,332.5);
vertex(447,371);
vertex(376,371);
vertex(376,360);
endShape();
fill(77,98,111);
beginShape();
vertex(507,332);
vertex(530,332);
vertex(550,350);
vertex(550,370);
vertex(530,378);
vertex(507,378);
endShape();
popMatrix();

bg = get(0,0,600,600);
},
bgCur:function(){
background(0,0,0);
},
bgMid:function(){
graphics.vent(950,440);
graphics.vent(1500,50);
graphics.vent(2700,500);
graphics.vent(2700,850);
graphics.vent(1930,880);
graphics.vent(1850,1680);
graphics.vent(1050,1250);
graphics.vent(-50,1200);
graphics.vent(-200,800);
graphics.vent(-400,970);
graphics.vent(-1100,970);
graphics.vent(-670,100);
graphics.vent(-625,1610);
},
bgTop:function(){
noStroke();
fill(179, 158, 0);
rect(563,288,40,40);
fill(0, 0, 0);
rect(571,288,8,40);
rect(587,288,8,40);
rect(563,296,40,8);
rect(563,312,40,8);
fill(255, 0, 0);
ellipse(583,308,20,20);
fill(0, 247, 255,100);
rect(570,295,26,26,10);
noStroke();
graphics.paper(412,540,12);
graphics.paper(402,495,72);
graphics.paper(769,495,22);
graphics.paper(835,98,82);
graphics.paper(836,95,82);
graphics.paper(837,92,82);
graphics.paper(777,20,60);
noStroke();
fill(81, 196, 177);
graphics.water(421,520);
graphics.water(751,520,10,10,10);
graphics.water(841,100,10,10,10);
graphics.water(851,85,10,10,10);
graphics.water(321,75,10,10,10);

fill(74, 74, 74);
rect(410,100,40,30);
fill(255, 149, 0);
triangle(355,100,345,120,380,130);
},
transBg:{
x:0,
y:0,
scale:1.5,
},
},
];


// for(var i = 0; i < 1; i++){
// var h = new player();
// h.x = 0;
// h.y = 50;
// h.become('ack');
// //h.speed = 1;
// //h.health = 1000;
// h.size = 1;
// h.switchWeapon(5);
// h.switchPowerI(2);
// }
// for(var i = 0; i < players.length; i++){
// players[i].initiate2();
// }
//p.initiate();
//loadChunks();
var trans = {};

var zoom = 1;
// for(var i = 0; i < players.length; i++){
// players[i].initiate();
// }
//newWave();
var startMillis = millis();
var framesYet = 0;
var fr = 0;
var logoCount = 500;
getActualMouse = function(){

return {
x:(-trans.x+(mouseX-300))*zoom+(300),
y:(-trans.y+(mouseY-300))*zoom+(300),
};
};
function loadBit(sMillis,reMar){
loadCount++;
loadCount = round(loadCount);
try{
loadChunksb();
}catch(e){
println(e+': Error with chunk loading!');
}
var eMillis = millis()-startMillis;
if(eMillis-sMillis < reMar){
if(loadCount < toLoad.length-1){
//if(walls[loadCount].data.length < otherLoadCap && walls[loadCount+1] && walls[loadCount+1].data.length < otherLoadCap){
loadBit(sMillis,reMar);
//}
}
}
}


function logoOutline(x,y,s,c){
pushMatrix();
translate(x,y);
scale(s);
scale(1,-1);
// noStroke();
// fill(209, 52, 52);
// pushMatrix();
// translate(0,-160);
// rotate(-6+c/10);
// translate(0,160);
// quadAlt(0,-160,150,160,100,230,-50,-90,c);
// quadAlt(100,230,15,130,104,140,150,160,c);
// popMatrix();
// pushMatrix();
// translate(0,-160);
// rotate(6-c/10);
// translate(0,160);
// quadAlt2(0,-160,-150,160,-100,230,50,-90,c);
// quadAlt2(-100,230,-15,130,-104,140,-150,160,c);
// popMatrix();
stroke(48, 3, 3,c);
strokeWeight(10);
noFill();
beginShape();
vertex(0,-160);
vertex(183,140);
vertex(140,215);
vertex(50,129);
vertex(85,129);
vertex(0,-11);
vertex(-85,129);
vertex(-50,129);
vertex(-140,215);
vertex(-183,140);
vertex(0,-160);
endShape();



popMatrix();
}
var transition = {
stage:0,
init:false,
speed:0.035,
to:false,
side:'left',
};
var demo = {
num:0,
};
gameSet = {
mode:0,
map:0,
curbg: 'none',
players: 5,
modes:['FFA','Team Chaos', 'Two Teams','Duos'],
noAttack: 0,
initCombat:false,
totalPlayers:0,
winCond:false,
highlights:[false,false],
highlightMode:[],
specNum:0,
specP:false,
spectating:false,
};
function transitionTo(page,speed){
logoCount = 0;
transition.stage = 0;
transition.init = true;
transition.speed = speed;
transition.to = page;
transition.side = choice('left','right');
projs = [];
effects = [];
}
function doTransition(speed){
if(transition.init){
if(transition.stage === 0){
    
if(logoCount < 498){
    logoCount = lerp(logoCount,500,speed);
    }else{
    logoCount = 500;
    transition.stage = 1;
    effects = [];
    }
}
if(transition.stage === 1){
transition.init = false;
transition.stage = 0;
scene = transition.to;
}
}else{
if(logoCount > 0.5){
    logoCount = lerp(logoCount,0,speed);
    }else{
    logoCount--;
    }
}
}
function newBots(n){
for(var i = 0; i < n; i++){
var h = new player();
h.x = 300;
h.y = 300;
h.become(people[floor(random(0,people.length))].name);
//h.speed = 1;
//h.health = 1000;
//h.size = 1;
h.switchWeapon(floor(random(0,h.weapons.length)));
h.switchPowerI(floor(random(0,h.powers.length)));
}
}
function initGame(n){
//println(maps[n].load);
gameSet.map = n;
walls = [];
chunks = [];
effects = [];
projs = [];
players = [];
p.enemies = [];
players.push(p);
p.x = 300;
p.y = 300;
p.vx = 0;
p.vy = 0;

gameSet.noAttack = 0;
gameSet.highlights = [false,false];
gameSet.highlightMode = [];

gameSet.spectating = false;

gameSet.specP = false;
//println('b');

switch(gameSet.modes[gameSet.mode]){
    case "FFA":
        {
        newBots(5);
        gameSet.noAttack = 900;
        players = mixUp(players);
        for(var i = 0; i < 6; i++){
        var dir = i*(360/6);
        players[i].vx = cos(dir)*30;
        players[i].vy = sin(dir)*30;
        }
        gameSet.initCombat = function(){
        for(var e = 0; e < players.length; e++){
        players[e].initiate();
        }
        };
        gameSet.winCond = function(shadowSubj){
        if(players.length === 1){
        if(shadowSubj.health > 0){
        return true;
        }
        }
        };
        }
    break;
case "Team Chaos":
        {
        gameSet.noAttack = 900;
        gameSet.highlights = [color(0, 81, 173),color(161, 0, 0)];
        gameSet.highlightMode = [];
        newBots(7);
        players = mixUp(players);
        gameSet.initCombat = function(){
        gameSet.highlightMode = 'friends enemies';
        for(var i = 0; i < 4; i++){
        for(var q = 4; q < 8; q++){
        players[i].initiateI(q);
        players[q].initiateI(i);
        }
        }
        };
        gameSet.winCond = function(shadowSubj){
        if(gameSet.noAttack <= 0){
        if(shadowSubj.enemies.length <= 0){
        if(shadowSubj.health > 0){
        return true;
        }
        }
        }
        };
        }
    break;
    case "Two Teams":
        {
        gameSet.noAttack = 100;
        gameSet.highlights = [color(0, 81, 173),color(161, 0, 0)];
        gameSet.highlightMode = 'friends enemies';
        newBots(7);
        players = mixUp(players);
        for(var i = 0; i < 4; i++){
        players[i].vx = -30;
        for(var q = 4; q < 8; q++){
        players[i].initiateI(q);
        players[q].initiateI(i);
        }
        }
        for(var i = 4; i < 8; i++){
        players[i].vx = 30;
        }
        gameSet.initCombat = function(){
        for(var i = 0; i < 8; i++){
        players[i].vx = 0;
        }
        };
        gameSet.winCond = function(shadowSubj){
        if(gameSet.noAttack <= 0){
        if(shadowSubj.enemies.length <= 0){
        if(shadowSubj.health > 0){
        return true;
        }
        }
        }
        };
        }
    break;
    case "Duos":
        {
        gameSet.noAttack = 800;
        gameSet.highlights = [color(0, 81, 173),color(161, 0, 0)];
        gameSet.highlightMode = 'friends enemies';
        newBots(7);
        players = mixUp(players);
        for(var i = 0; i < 2; i++){
        players[i].vx = -30;
        for(var i2 = 2; i2 < 8; i2++){
        players[i].initiateI(i2);
        }
        
        }
        for(var i = 2; i < 4; i++){
        players[i].vx = 30;
        for(var i2 = 0; i2 < 2; i2++){
        players[i].initiateI(i2);
        }
        for(var i2 = 4; i2 < 8; i2++){
        players[i].initiateI(i2);
        }
        }

        for(var i = 4; i < 6; i++){
        players[i].vy = -30;
        for(var i2 = 0; i2 < 4; i2++){
        players[i].initiateI(i2);
        }
        for(var i2 = 6; i2 < 8; i2++){
        players[i].initiateI(i2);
        }
        }
        for(var i = 6; i < 8; i++){
        players[i].vy = 30;
        for(var i2 = 0; i2 < 6; i2++){
        players[i].initiateI(i2);
        }
        }
        // for(var i = 6; i < 12; i++){
        // players[i].vx = 30;
        // }
        gameSet.initCombat = function(){
        for(var i = 0; i < 8; i++){
        players[i].vx = 0;
        players[i].vy = 0;
        }
        };
        gameSet.winCond = function(shadowSubj){
        if(gameSet.noAttack <= 0){
        if(shadowSubj.enemies.length <= 0){
        if(shadowSubj.health > 0){
        return true;
        }
        }
        }
        };
        }
    break;
}

for(var i = 0; i < players.length; i++){
    players[i].pCooldown = [0,0,0,0,0,0,0,0];
}

//println(maps[0].name);
maps[n].background();

randomSeed(trueRandom);
//println('d');

maps[n].load();

//println('e');
startLoading();
//println('f');
}

var pauseBg = get();
var didPause = false;
randomSeed(trueRandom);
textFont(monospace);
frameRate(60);

// p.become('Worty Frowlg');
// maps[2].background();
// maps[2].load();
// startLoading();
// gameSet.map = 2;

var mousep = false;
var loadbreak = false;
draw = function(){
clicked = false;
if(held === true){
clicked = true;
}
if(mouseIsPressed){
held = true;
}else{
held = false;
}
if(held === false && clicked === true){
clicked = true;
}else{
clicked = false;
}

cursor(ARROW);

if(accessibilityPrompt === true){
accessibilityPage();
}else{
switch(scene){
case 'loading':
{
cursor(WAIT);
background(0, 0, 0);
//if(frameCount/10 === round(frameCount/10)){
var sMillis = millis()-startMillis;
//println(walls[loadCount].data.length);
// !walls[loadCount].data.length|| (walls[loadCount].data.length <= otherOtherLoadCap||loadbreak)
//if(1){
//loadbreak = false;
//loadBit(sMillis,1);
//}
// if(walls[loadCount].data.length > otherOtherLoadCap){
//     loadbreak = true;
// }
loadBit(sMillis,loadRep);
textAlign(CENTER,BASELINE);
fill(255, 255, 255);
textSize(34);
text('Loading',width/2,height/2-150);
text(loadCount+1+'/'+(toLoad.length),width/2,height/2-100);
noStroke();
fill(115, 115, 115);
rect(50,height/2,width-100,50,20);
fill(255, 255, 255);
rect(50,height/2,((width-100)/toLoad.length)*loadCount,50,20);
if(loadCount >= toLoad.length-1){
scene = 'game';
}
}
break;
case 'game':
{
mousep = false;
if(mouseIsPressed){
mousep = true;
}
//p.health -= 10;
if(dist(mouseX,mouseY,width-25,25)<=15){
cursor(HAND);
if(clicked||mouseIsPressed){
    
didPause = 2;
scene = 'pause';
clicked = false;
}
}

if(didPause){
    
clicked = false;
mousep = false;
didPause--;
}
//println(mousep);
//println(fr);
//println(angleDiff(p.rot,0));
//println(p.x+' , '+p.y);
framesYet += 1;
if(millis()-startMillis >= 1000){
fr = framesYet;
startMillis = millis();
framesYet = 0;
}
//smooth();
if(maps[gameSet.map].bgCur){
maps[gameSet.map].bgCur();
}else{
background(255, 255, 255);
}
var shadowSubj = p;
pushMatrix();
if(p.health>0){
trans = {
x:-p.x+(width/2),
y:-p.y+(height/2),
};
}else{
    
var e = false;
if(gameSet.specP){
if(gameSet.specP.health > 0){
e = gameSet.specP;
}else{
if(players[0]){
gameSet.specNum = 0;
e = players[0];
}
}
}
if(tapped(keys[keyBinds.leftDir])){
gameSet.specNum--;
if(gameSet.specNum<0){
gameSet.specNum = players.length-1;
}
if(players[gameSet.specNum]){
e = players[gameSet.specNum];
}else if(players[0]){
gameSet.specNum = 0;
e = players[0];
}
if(e){
gameSet.specP = e;
}
}
if(tapped(keys[keyBinds.rightDir])){
gameSet.specNum++;
if(players[gameSet.specNum]){
e = players[gameSet.specNum];
}else if(players[0]){
gameSet.specNum = 0;
e = players[0];
}
if(e){
gameSet.specP = e;
}
}


if(e){
shadowSubj = e;
trans = {
x:-e.x+(width/2),
y:-e.y+(height/2),
};
}else{
trans = {
x:-p.x+(width/2),
y:-p.y+(height/2),
};
}
}

if(trans){
cam.x = lerp(cam.x,trans.x,0.4);
cam.y = lerp(cam.y,trans.y,0.4);
}

translate(width/2,height/2);
scale(1/zoom);
translate(-width/2,-height/2);
translate(cam.x,cam.y);

pushMatrix();
if(maps[gameSet.map].transBg){
scale(maps[gameSet.map].transBg.scale);
translate(maps[gameSet.map].transBg.x,maps[gameSet.map].transBg.y);
}
image(bg,-2500,-2500,5000,5000);

popMatrix();

if(pressed(keys[keyBinds.attack])||(keyBinds.attack === "click" && mousep)){
p.attack();
}

if(!pressed(keys[keyBinds.autopilot])){
p.dirs = [false,false,false,false];
//var dir = false;
if(pressed(keys[keyBinds.upDir])){
p.dirs[0] = true;
}
if(pressed(keys[keyBinds.leftDir])){
p.dirs[1] = true;
}
if(pressed(keys[keyBinds.downDir])){
p.dirs[2] = true;
}
if(pressed(keys[keyBinds.rightDir])){
p.dirs[3] = true;
}

p.stargDir = atan2((mouseY-trans.y)-p.y,(mouseX-trans.x)-p.x);
p.trot = p.stargDir;
p.move(p.dirs);

// p.path = p.getPath({x:getActualMouse().x,y:getActualMouse().y});
// ellipse(getActualMouse().x,getActualMouse().y,100,100);
// if(p.path){
// for(var i = 0; i < p.path.length; i++){
// strokeWeight(10);
// stroke(255, 0, 0);
// line(p.path[i][0].x,p.path[i][0].y,p.path[i][1].x,p.path[i][1].y);
// }
// }

//println(p.rot);
}
//drawWalls();
if(maps[gameSet.map].bgMid){
maps[gameSet.map].bgMid();
{
// test bg mid layer here



}
}
for(var i = projs.length-1; i > -1; i--){
    //println('e');
projs[i].draw();
}
for(var i = players.length-1; i > -1; i--){
if(players[i] !== p||pressed(keys[keyBinds.autopilot])){
players[i].doAi();
//players[i].attack();

players[i].move(players[i].dirs);
}
players[i].doQue();
players[i].draw();

if(p.enemies.includes(players[i])){
//println(gameSet.highlightMode.includes('enemies'));
if(gameSet.highlightMode.includes('enemies')){
if(gameSet.highlights[1]){
fill(gameSet.highlights[1],100);
noStroke();
ellipse(players[i].x,players[i].y,getSize(players[i].size)+40,getSize(players[i].size)+40);
}
}
}else{
if(gameSet.highlightMode.includes('friends')){
if(gameSet.highlights[0]&&players[i] !== p){
fill(gameSet.highlights[0],100);
noStroke();
ellipse(players[i].x,players[i].y,getSize(players[i].size)+40,getSize(players[i].size)+40);
} 
}
}
players[i].checkForKill();
}

drawEffects();
for(var i = walls.length-1; i > -1; i--){
walls[i].shadow(shadowSubj);
}

// var rend = fatRenderAt(shadowSubj.x,shadowSubj.y,{size:screenDist/15 + 1});
// for(var i = 0; i < rend.length; i++){
// rend[i][1].shadow(shadowSubj);
// }

drawWalls();
for(var i = players.length-1; i > -1; i--){
players[i].collisions();
}
if(maps[gameSet.map].bgTop){
maps[gameSet.map].bgTop();
{
// test bg top layer here


}
}
popMatrix();

if(tapped(keys[keyBinds.togglePowerUp])){
//keyPID[keyBinds.togglePowerUp] = false;
p.switchPower(1);
}
if(tapped(keys[keyBinds.togglePowerDown])){
//keyPID[keyBinds.togglePowerDown] = false;
p.switchPower(-1);
}

p.powerSelect = round(p.powerSelect);
if(((tapped(keys[keyBinds.usePower])||(keyBinds.usePower === "click" && mousep)))){
p.doPower(p.powerSelect);
}
if(p.health > 0){
for(var i = p.powers.length-1; i >-1; i--){

//p.powers[i].use();
pushMatrix();
translate(width-50,(height-120)-i*80);
if(p.powers[i].symbol){
p.powers[i].symbol(p,p.powers[i].cooldown,i);  
}else{
stroke(0, 0, 0);
strokeWeight(6);
fill(92, 92, 92);
ellipse(0,0,70,70);
}
popMatrix();
}
var sideXBase = (width-100)/2-(keyBinds.weapons.length*85)/2+5;
for(var i = 0; i < keyBinds.weapons.length; i++){
if(p.weapons[i]){
if(pressed(keys[keyBinds.weapons[i]])){
p.switchWeapon(i);
}
fill(207, 207, 207);
stroke(64, 64, 64);
if(p.selected === i){
strokeWeight(10);
}else{
strokeWeight(6);
}
//var sideXBase = (width-100)/2-(keyBinds.weapons.length*85)/2+5;
var sideX = sideXBase+i*85;
rect(sideX+3,height-67,85,60);
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(10);
text(i+1,sideX-29,height-55,85,60);
if(p.weapons[i]){
{
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(10);
pushMatrix();
if(getWeaponStats(p.weapons[i]).textDis){
translate(getWeaponStats(p.weapons[i]).textDis.x,getWeaponStats(p.weapons[i]).textDis.y);
}
text(p.weapons[i],sideX,height-25,85,60);
popMatrix();
pushMatrix();
if(getWeaponStats(p.weapons[i]).hbDis.scale){
translate(sideX+getWeaponStats(p.weapons[i]).hbDis.x,height - (600-getWeaponStats(p.weapons[i]).hbDis.y));
scale(getWeaponStats(p.weapons[i]).hbDis.scale);
translate(-(sideX+getWeaponStats(p.weapons[i]).hbDis.x),-(height - (600-getWeaponStats(p.weapons[i]).hbDis.y)));
}
drawWeapon(p.weapons[i],{
x:sideX+getWeaponStats(p.weapons[i]).hbDis.x,
y:height-(600-getWeaponStats(p.weapons[i]).hbDis.y),
rot:getWeaponStats(p.weapons[i]).hbDis.rot,
charge:0,
},100,true);
popMatrix();
}
fill(0, 0, 0,100);
stroke(64, 64, 64);
var down = 60-(60/getWeaponStats(p.weapons[i]).cooldown)*p.cooldown;
if(down < 0){
down = 0;
}
rect(sideX+3,height-63,85,down);
}
}
}
}else{
fill(0, 0, 0,150);
textSize(20);
textAlign(CENTER,BASELINE);
text('Move left/right to toggle \nperspective',width/2,130);
}
stroke(255, 0, 0, 200);
noFill();
strokeWeight(5);
ellipse(width-25,25,30,30);
for(var i = 0; i < 3; i++){
line(width-30,i*6+19,width-20,i*6+19);
}
if(dist(mouseX,mouseY,width-25,25)<=15){
cursor(HAND);
if(didPause){
didPause = false;
pauseBg = get();
clicked = false;
}
}

if(gameSet.noAttack && gameSet.noAttack > 0){
gameSet.noAttack--;
fill(255, 0, 0,150);
textSize(40);
textAlign(CENTER,BASELINE);
text('COMBAT IN: '+ceil(gameSet.noAttack/60),width/2,150);
if(gameSet.noAttack <= 0){
if(gameSet.initCombat){
gameSet.initCombat();
}
}
}
if(p.health <= 0 && gameSet.spectating === false){
pauseBg = get();
scene = 'death';
logoCount = 0;
}
for(var i = 0; i < players.length; i++){
if(gameSet.winCond){
if(gameSet.winCond(players[i])){
fill(255, 157, 0,250);
textSize(40);
textAlign(CENTER,BASELINE);
text('✨--VICTORY--✨',width/2,150+sin(frameCount)*60);
players[i].noWeaponDraw = true;
players[i].hands = [{transX:-10+cos(frameCount*15)*3,transY:-10+sin(frameCount*15)*3},{transX:-10+cos(frameCount*15)*3,transY:10+sin(frameCount*15)*3}];
if(frameCount/40 === round(frameCount/40)){
for(var q = 0; q < 10; q++){
var poof = new effect(players[i].x,players[i].y,random(5,15),color(random(0,255),random(0,255),random(0,255)),random(0,255),random(2,5));
poof.vx = random(-2,2);
poof.vy = random(-2,2);
}
}
if(players[i] === p){
if(mouseX >width/2-140 && mouseX < width/2+140 && mouseY > height/2+175 && mouseY < height/2+205){
cursor(HAND);
textSize(32);
if(clicked){
transitionTo('lobby',0.05);
effects = [];
logoCount = 495;
}
}else{
textSize(30);
}
text('Return to lobby',width/2,height/2+200);
}
}
}
}

fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'home':
{

background(38, 38, 38);
if(!cam.x){
cam = {x:0,y:0};
}
var trans = {
x:0,
y:0,
};
drawEffects();
if(logoCount > 0){
logo(width/2,height/2,1,logoCount);
}
p.x = width/2;
p.y = height/2-100;
p.vx = 0;
p.vy = 0;
p.stargDir = atan2((mouseY-trans.y)-p.y,(mouseX-trans.x)-p.x);
p.trot = p.stargDir;
//p.draw();
//ellipse(200,200,200,200);
if(logoCount <= 0){

cursor(HAND);
if(clicked){
transitionTo("lobby",0.1);
}

pushMatrix();
translate(width/2,height/2);
rotate(sin(logoCount)*5);
translate(-width/2,-height/2);
var num = 1+sin(logoCount/3)*0.05;
logo(width/2,height/2,num,0);
logoOutline(width/2,height/2,num,constrain(-logoCount,0,250));
popMatrix();
for(var f = 0; f < width+width/6; f+=width/6){
var poof = new effect(f,height,random(5,15),choice(color(245, 10, 10),color(66, 38, 6)),random(0,255),random(2,5));
poof.vx = random(-1,1);
var cap = 2+abs((width/2)-f)/50;
poof.vy = random(-cap,-0.1);
var num = 255/cap;
poof.color = color(poof.vy*-num, poof.vy*-num/2, 255-poof.vy*-num);
}

textSize(40);
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
text(('V E R T E X\nL e g e n d s').substring(0,-logoCount/2),width/2,height/2+200);
textSize(20);
text(('Click to continue').substring(0,(-logoCount-48)/2),width/2,height/2+288);
}

fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'lobby':
{
p.resetHands();
background(38, 38, 38);
if(!cam.x){
cam = {x:0,y:0};
}
var trans = {
x:0,
y:0,
};
drawEffects();
if(logoCount > 0){
logo(width/2,height/2-180,0.4,logoCount);
}else{
logo(width/2,height/2-180,0.4,0);
}
noStroke();

for(var q = 0; q < 10; q++){
fill(99, 7, 7,q*10);
ellipse(width/2,height/2+60,100+q*20,50+q*10);
}
pushMatrix();
p.x = width/2;
p.y = height/2+60;
p.vx = 0;
p.vy = 0;
p.noWeaponDraw = true;
translate(p.x,p.y);
scale(1.5);
translate(-p.x,-p.y);
p.stargDir = atan2((mouseY-trans.y)-p.y,(mouseX-trans.x)-p.x);
p.trot = p.stargDir;
p.draw();
popMatrix();
strokeWeight(5);
stroke(0,0,0);
var x = width/2-100;
var y = height/2+120;
if(mouseX > x && mouseX < x+200 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
transitionTo('loadout',0.1);
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
rect(x,y,200,60);
var x = width/2-100;
var y = height/2-90;
if(mouseX > x && mouseX < x+200 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
transitionTo('select',0.1);
}
fill(191, 97, 97);
}else{
fill(173, 48, 48);
}
rect(x,y,200,60);
if(mouseX > width/2-50 && mouseX < width/2+50 && mouseY > height-50 && mouseY < height-10){
cursor(HAND);
if(clicked){
transitionTo('home',0.1);
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
strokeWeight(4);
stroke(0, 0, 0);
rect(width/2-50,height-50,100,40);
//ellipse(200,200,200,200);
if(logoCount <= 0){

for(var f = 0; f < width+width/6; f+=width/6){
var poof = new effect(f,height,random(5,15),choice(color(245, 10, 10),color(66, 38, 6)),random(0,255),random(2,5));
poof.vx = random(-1,1);
var cap = 2+abs((width/2)-f)/50;
poof.vy = random(-cap,-0.1);
var num = 255/cap;
poof.color = color(poof.vy*-num, poof.vy*-num/2, 255-poof.vy*-num);
}



fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(40);
text(('L O B B Y').substring(0,-logoCount/2),width/2,height/2+230);
textSize(20);
text(('Back').substring(0,-logoCount/(2*(9/4))),width/2,height-23);
textSize(25);
text(('Loadout').substring(0,-logoCount/(2*(9/7))),width/2,height/2+159);
text(('Play').substring(0,-logoCount/(2*(9/4))),width/2,height/2-51);
}

fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'select':
{
if(gameSet.curbg !== maps[gameSet.map].name){
    //println(maps[gameSet.map].name);
    maps[gameSet.map].background();
    gameSet.curbg = maps[gameSet.map].name;
}
background(38, 38, 38);
image(bg,width/2-300,height/2-300);
if(!cam.x){
cam = {x:0,y:0};
}
var trans = {
x:0,
y:0,
};
drawEffects();
if(logoCount > 0){
logo(width/2,height/2-180,0.4,logoCount);
}else{
logo(width/2,height/2-180,0.4,0);
}
noStroke();



strokeWeight(5);
stroke(0,0,0);

{
var setChange = 0;
var x = width/2+200;
var y = height/2-90;
if(mouseX > x && mouseX < x+50 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
setChange = 1;
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
rect(x,y,50,60);
var x = width/2-250;
var y = height/2-90;
if(mouseX > x && mouseX < x+50 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
setChange = -1;
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
rect(x,y,50,60);
gameSet.mode += setChange;
gameSet.mode = constrain(gameSet.mode,0,gameSet.modes.length-1);
// if(gameSet.mode >= gameSet.modes.length){
// gameSet.mode = 0;
// }
// if(gameSet.mode < 0){
// gameSet.mode = gameSet.modes.length-1;
// }

}

{
var setChange = 0;
var x = width/2+200;
var y = height/2+15;
if(mouseX > x && mouseX < x+50 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
setChange = 1;
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
rect(x,y,50,60);
var x = width/2-250;
var y = height/2+15;
if(mouseX > x && mouseX < x+50 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
setChange = -1;
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
rect(x,y,50,60);
gameSet.map += setChange;
gameSet.map = constrain(gameSet.map,0,maps.length-1);
// if(gameSet.mode >= gameSet.modes.length){
// gameSet.mode = 0;
// }
// if(gameSet.mode < 0){
// gameSet.mode = gameSet.modes.length-1;
// }

}

var x = width/2-100;
var y = height/2+130;
if(mouseX > x && mouseX < x+200 && mouseY > y && mouseY < y+60){
cursor(HAND);
if(clicked){
initGame(gameSet.map);
}
fill(191, 97, 97);
}else{
fill(173, 48, 48);
}
rect(x,y,200,60);

if(mouseX > width/2-50 && mouseX < width/2+50 && mouseY > height-50 && mouseY < height-10){
cursor(HAND);
if(clicked){
transitionTo('lobby',0.1);
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
strokeWeight(4);
stroke(0, 0, 0);
rect(width/2-50,height-50,100,40);
//ellipse(200,200,200,200);
if(logoCount <= 0){

for(var f = 0; f < width+width/6; f+=width/6){
var poof = new effect(f,height,random(5,15),choice(color(245, 10, 10),color(66, 38, 6)),random(0,255),random(2,5));
poof.vx = random(-1,1);
var cap = 2+abs((width/2)-f)/50;
poof.vy = random(-cap,-0.1);
var num = 255/cap;
poof.color = color(poof.vy*-num, poof.vy*-num/2, 255-poof.vy*-num);
}



fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(40);
text(('DEPLOY').substring(0,-logoCount/(2*(9/6))),width/2,height/2+173);
textSize(20);
text(('Back').substring(0,-logoCount/(2*(9/4))),width/2,height-23);
textSize(30);
//text(('Loadout').substring(0,-logoCount/(2*(9/7))),width/2,height/2+159);
fill(255, 0, 0);
var txt = 'Gamemode: '+gameSet.modes[gameSet.mode];
text((txt).substring(0,-logoCount/(2*(9/txt.length))),width/2,height/2-51);
var txt = 'Map: \n'+maps[gameSet.map].name;
text((txt).substring(0,-logoCount/(2*(9/txt.length))),width/2,height/2+29);
fill(0,0,0);
text('<',width/2-225,height/2-51);
text('>',width/2+225,height/2-51);
text('<',width/2-225,height/2+54);
text('>',width/2+225,height/2+54);
}




fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'loadout':
{
//translate(100,100);
//scale(0.1);
background(38, 38, 38);
noStroke();
fill(166, 166, 166);
rect(20,20-5,(width-(240))-40,160);
if(!cam.x){
cam = {x:0,y:0};
}
var trans = {
x:0,
y:0,
};

drawEffects();
// if(logoCount > 0){
// logo(width/2,height/2-180,0.4,logoCount);
// }else{
// logo(width/2,height/2-180,0.4,0);
// }
noStroke();
var size = 100;
var size2 = 60;
var size2y = 25;
var perLane = floor(((width-10)/(size+10)));
var perLane2 = floor(((((width-(240))-40)-10)/(size2+10)));
var extra = width-(((perLane)*(size+10)+10));
var extra2 = ((width-(240)))-(((perLane2)*(size2+10)+10));
var extraY = (floor(people.length/perLane)*(size+10));

//println(extra);

for(var q = 0; q < people.length; q++){
noStroke();
fill(people[q].looks.color,100);
var x = ((q*(size+10)+10)-floor(q/perLane)*((perLane)*(size+10)))+extra/2;
var y = height/2-(extraY)+180-size+(floor(q/perLane)*(size+10));
if(mouseX > x && mouseX < x+size && mouseY > y && mouseY < y+size){
cursor(HAND);
rect(x-2,y-2,size+4,size+4);
if(clicked){
p.become(people[q].name);
}
}else{
rect(x,y,size,size);
}
doPlayerGraphics({
x:x+size/2,
y:y+size/2,
cooldown:1000,
handMove:'none',
looks:people[q].looks,
size:1,
noWeaponDraw:true,
use:false,
},1);
fill(0,0,0);
textSize(11);
//println(height);
textAlign(CENTER,BASELINE);
text((people[q].name).substring(0,-logoCount/(2*(13/people[q].name.length))),x+size/2,y+size-10);
}

//var extra2Y = (floor(p.weapons.length/perLane2)*(size2+10));
var sideXBase = (width-100)/2-(keyBinds.weapons.length*85)/2+5;
var show = false;
var whatClicked = false;
for(var q = 0; q < p.weapons.length; q++){

var x = ((q*(size2+10)+10)-floor(q/perLane2)*((perLane2)*(size2+10)))+extra2/2;
var y = 30+(floor(q/perLane2)*(size2y+10));

if(mouseX > x && mouseX < x+size2 && mouseY > y && mouseY < y+size2y){
cursor(HAND);
show = q;
if(clicked){
whatClicked = q;
}
fill(222, 222, 222);
}else{
fill(199, 199, 199);
}
strokeWeight(4);
stroke(0,0,0);
rect(x,y,size2,size2y);

{
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(7);
text(p.weapons[q],x+5,y+size2y/4,size2-10,size2y);
}




}
for(var m = 0; m < p.powers.length; m++){
var q = (m+p.weapons.length);
var x = ((q*(size2+10)+10)-floor(q/perLane2)*((perLane2)*(size2+10)))+extra2/2;
var y = 30+(floor(q/perLane2)*(size2y+10));

if(mouseX > x && mouseX < x+size2 && mouseY > y && mouseY < y+size2y){
cursor(HAND);
show = q;
if(clicked){
whatClicked = q;
}
fill(222, 222, 222);
}else{
fill(199, 199, 199);
}
strokeWeight(4);
stroke(0,0,0);
rect(x,y,size2,size2y);

{
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(7);
text(p.powerNames[m],x+5,y+size2y/4,size2-10,size2y);
}




}
if(show || show === 0){
pushMatrix();
if(show < p.weapons.length){
drawWeapon(p.weapons[show],{
x:mouseX-20,
y:mouseY,
charge:0,
},100,true);
}else{
pushMatrix();
translate(mouseX,mouseY);
scale(0.5);
p.powers[show-p.weapons.length].symbol(p,10000,100);
popMatrix();
}
popMatrix();
}
if(whatClicked||whatClicked === 0){
transitionTo('demo',0.25);
demo.num=whatClicked;
}

strokeWeight(10);
stroke(92, 92, 92);
fill(209, 209, 209);
rect(width-240,20,220,150);
pushMatrix();
p.x = width - 240+110;
p.y = 20+75;
p.resetHands();
p.noWeaponDraw = true;
translate(p.x,p.y);
scale(1.5);
translate(-p.x,-p.y);
if(logoCount < 0){
p.stargDir = logoCount*1.1;
}else{
p.stargDir = 0;
}
p.trot = p.stargDir;
p.draw();
popMatrix();


strokeWeight(5);
stroke(0,0,0);
// var x = width/2-100;
// var y = height/2+120;
// if(mouseX > x && mouseX < x+200 && mouseY > y && mouseY < y+60){
// cursor(HAND);
// if(clicked){
// transitionTo('loadout',0.1);
// }
// fill(181, 181, 181);
// }else{
// fill(130, 130, 130);
// }
// rect(x,y,200,60);
if(mouseX > width/2-50 && mouseX < width/2+50 && mouseY > height-50 && mouseY < height-10){
cursor(HAND);
if(clicked){
transitionTo('lobby',0.1);
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
strokeWeight(4);
stroke(0, 0, 0);
rect(width/2-50,height-50,100,40);

//ellipse(200,200,200,200);
if(logoCount <= 0){

fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(40);
text(('L O A D O U T').substring(0,-logoCount/2),width/2,height-70);
textSize(20);
//println(height);
text(('Back').substring(0,-logoCount/(2*(13/4))),width/2,height-23);
textSize(13);
text(('Selected Legend:\n'+p.name).substring(0,-logoCount/(2*(13/(17+p.name.length)))),width-130,140);
textSize(25);
//text(('Loadout').substring(0,-logoCount/(2*(13/4))),width/2,height/2+159);
}

fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'demo':
{
//println(people.length);
//println(p.cooldown);
//translate(100,100);
//scale(0.1);
background(38, 38, 38);
pushMatrix();
{
//p.noWeaponDraw = true;
p.trot = p.rot;
if(!p.weapons[p.selected]){
p.selected = 0;
}
if(demo.num < p.weapons.length){
if(p.selected !== demo.num){
p.switchWeapon(demo.num);
if(!p.weapons[demo.num]){
p.selected = 0;
}
}else{
//p.target = {health:10,name:'ack',x:p.x+cos(p.rot)*10,y:p.y+sin(p.rot)*10,size:1,vx:0,vy:0,tvx:0,tvy:0};
//p.doAi(true);
//println(p.charge + ' , ' +(abs(p.vx)+abs(p.vy)));
if(p.charge < 15 && (abs(p.vx)+abs(p.vy) <= 0)){
p.attack();


}else{
}
}
}else{
if(p.powerSelect !== demo.num-p.weapons.length){
p.switchPowerI(demo.num-p.weapons.length);
}else{
//p.target = {health:10,name:'ack',x:p.x+cos(p.rot)*10,y:p.y+sin(p.rot)*10,size:1,vx:0,vy:0,tvx:0,tvy:0};
//p.doAi(true);
if(p.pCharge < 15){
p.doPower();

}else{
}
}
}

p.x = width/2;
p.y = (height-150)/2+150; 

translate(p.x,p.y);
//scale(1.5);
translate(-p.x,-p.y);
if(logoCount < 0){
p.stargDir = logoCount*1.1;
}else{
p.stargDir = 0;
}
p.health = p.maxHealth;
p.trot = p.stargDir;
p.move([false,false,false,false]);
p.doQue();
for(var i = projs.length-1; i > -1; i--){
    //println('e');
projs[i].draw();
}
p.draw();
drawEffects();
}
popMatrix();
noStroke();
fill(166, 166, 166);
rect(20,20-5,(width-(240))-40,160);
if(!cam.x){
cam = {x:0,y:0};
}
var trans = {
x:0,
y:0,
};

// if(logoCount > 0){
// logo(width/2,height/2-180,0.4,logoCount);
// }else{
// logo(width/2,height/2-180,0.4,0);
// }
noStroke();
var size = 80;
var size2 = 60;
var size2y = 25;
var perLane = floor(((width-10)/(size+10)));
var perLane2 = floor(((((width-(240))-40)-10)/(size2+10)));
var extra = width-(((perLane)*(size+10)+10));
var extra2 = ((width-(240)))-(((perLane2)*(size2+10)+10));
var extraY = (floor(people.length/perLane)*(size+10));

//println(extra);
// for(var q = 0; q < people.length; q++){
// noStroke();
// fill(people[q].looks.color,100);
// var x = ((q*(size+10)+10)-floor(q/perLane)*((perLane)*(size+10)))+extra/2;
// var y = height/2-(extraY)+100+(floor(q/perLane)*(size+10));
// if(mouseX > x && mouseX < x+size && mouseY > y && mouseY < y+size){
// cursor(HAND);
// rect(x-2,y-2,size+4,size+4);
// if(clicked){
// p.become(people[q].name);
// }
// }else{
// rect(x,y,size,size);
// }
// doPlayerGraphics({
// x:x+size/2,
// y:y+size/2,
// cooldown:1000,
// handMove:'none',
// looks:people[q].looks,
// size:1,
// noWeaponDraw:true,
// use:false,
// },1);
// fill(0,0,0);
// textAlign(CENTER,BASELINE);
// textSize(15);
// //println(height);
// text((people[q].name).substring(0,-logoCount/(2*(7/people[q].name.length))),x+size/2,y+size-10);
// }
//var extra2Y = (floor(p.weapons.length/perLane2)*(size2+10));
var sideXBase = (width-100)/2-(keyBinds.weapons.length*85)/2+5;
var show = false;
var whatClicked = false;
for(var q = 0; q < p.weapons.length; q++){

var x = ((q*(size2+10)+10)-floor(q/perLane2)*((perLane2)*(size2+10)))+extra2/2;
var y = 30+(floor(q/perLane2)*(size2y+10));

if(mouseX > x && mouseX < x+size2 && mouseY > y && mouseY < y+size2y){
cursor(HAND);
show = q;
if(clicked){
whatClicked = q;
}
fill(222, 222, 222);
}else{
fill(199, 199, 199);
}
strokeWeight(4);
stroke(0,0,0);
rect(x,y,size2,size2y);

{
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(7);
text(p.weapons[q],x+5,y+size2y/4,size2-10,size2y);
}




}
for(var m = 0; m < p.powers.length; m++){
var q = (m+p.weapons.length);
var x = ((q*(size2+10)+10)-floor(q/perLane2)*((perLane2)*(size2+10)))+extra2/2;
var y = 30+(floor(q/perLane2)*(size2y+10));

if(mouseX > x && mouseX < x+size2 && mouseY > y && mouseY < y+size2y){
cursor(HAND);
show = q;
if(clicked){
whatClicked = q;
}
fill(222, 222, 222);
}else{
fill(199, 199, 199);
}
strokeWeight(4);
stroke(0,0,0);
rect(x,y,size2,size2y);

{
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(7);
text(p.powerNames[m],x+5,y+size2y/4,size2-10,size2y);
}




}
if(show || show === 0){
pushMatrix();
if(show < p.weapons.length){
drawWeapon(p.weapons[show],{
x:mouseX-20,
y:mouseY,
charge:0,
},100,true);
}else{
pushMatrix();
translate(mouseX,mouseY);
scale(0.5);
p.powers[show-p.weapons.length].symbol(p,10000,100);
popMatrix();
}
popMatrix();
}
if(whatClicked||whatClicked === 0){
transitionTo('demo',0.25);
demo.num=whatClicked;
}

strokeWeight(10);
stroke(92, 92, 92);
fill(209, 209, 209);
rect(width-240,20,220,150);



strokeWeight(5);
stroke(0,0,0);
// var x = width/2-100;
// var y = height/2+120;
// if(mouseX > x && mouseX < x+200 && mouseY > y && mouseY < y+60){
// cursor(HAND);
// if(clicked){
// transitionTo('loadout',0.1);
// }
// fill(181, 181, 181);
// }else{
// fill(130, 130, 130);
// }
// rect(x,y,200,60);
if(mouseX > width/2-50 && mouseX < width/2+50 && mouseY > height-50 && mouseY < height-10){
cursor(HAND);
if(clicked){
transitionTo('loadout',0.1);
}
fill(181, 181, 181);
}else{
fill(130, 130, 130);
}
strokeWeight(4);
stroke(0, 0, 0);
rect(width/2-50,height-50,100,40);

//ellipse(200,200,200,200);
if(logoCount <= 0){

fill(0, 0, 0);
textAlign(CENTER,BASELINE);
textSize(40);
text(('D E M O').substring(0,-logoCount/2),width/2,height-70);
textSize(20);
//println(height);
text(('Back').substring(0,-logoCount/(2*(7/4))),width/2,height-23);
textSize(10);
var e = false;
//println(demo.num);
var txt = '';
if(demo.num < p.weapons.length){
e = p.weapons[demo.num];
{
if(p.use.damage){
txt += '\nDamage: '+p.use.damage;
}
if(p.use.cooldown){
txt += '\nCooldown: '+p.use.cooldown;
}
if(p.use.frequency){
txt += '\nProjectile Frequency: '+p.use.frequency;
}
if(p.use.reach){
txt += '\nReach: '+p.use.reach;
}
if(p.use.sweep){
txt += '\nSweep: '+p.use.sweep;
}
if(p.use.knockback){
txt += '\nKnockback: '+p.use.knockback;
}
if(p.use.delay){
txt += '\nDelay: '+p.use.delay[0];
}
if(p.use.chargeSpeed){
txt += '\nCharge Speed: '+p.use.chargeSpeed;
}
if(p.use.projSpeed){
txt += '\nProjectile Speed: '+p.use.projSpeed;
}
if(p.use.size){
txt += '\nProjectile Size: '+p.use.size;
}
if(p.use.windResistance||p.use.windResistance === 0){
txt += '\nProjectile Drag: '+p.use.windResistance;
}
}
}else{
e = p.powerNames[demo.num-p.weapons.length];
//println(p.powers[demo.num-p.weapons.length].descript);
if(p.powers[demo.num-p.weapons.length].descript){
txt += '\n\n'+p.powers[demo.num-p.weapons.length].descript;
}
if(p.powers[demo.num-p.weapons.length].cooldown){
txt += '\n\nCooldown: '+p.powers[demo.num-p.weapons.length].cooldown;
}
}

text(('Selected Demo: '+e+txt).substring(0,-logoCount/(2*(7/(15+e.length+txt.length)))),width-230,40,200,130);
textSize(25);
//text(('Loadout').substring(0,-logoCount/(2*(13/4))),width/2,height/2+159);
}else{
p.x = width/2;
p.y = (height-150)/2+150; 
}

fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'pause':
{
image(pauseBg,0,0);
fill(0,0,0,150);
noStroke();
rect(0,0,width,height);
textAlign(CENTER,BASELINE);
fill(217, 217, 217);
textSize(50);
text('P A U S E D',width/2,height/2-150);
if(mouseX >width/2-50 && mouseX < width/2+50 && mouseY > height/2-75 && mouseY < height/2-45){
cursor(HAND);
textSize(32);
if(clicked){
scene = 'game';
didPause = 2;
clicked = false;
}
}else{
textSize(30);
}
text('Resume',width/2,height/2-50);
if(mouseX >width/2-50 && mouseX < width/2+50 && mouseY > height/2+25 && mouseY < height/2+55){
cursor(HAND);
textSize(32);
if(clicked){
transitionTo('home',0.05);
}
}else{
textSize(30);
}
text('Quit',width/2,height/2+50);
fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
case 'death':
{
image(pauseBg,0,0);
fill(0,0,0,150);
noStroke();
rect(0,0,width,height);
textAlign(CENTER,BASELINE);
fill(171, 0, 0);
textSize(50);
if(!transition.init){
logoCount--;
}
text(('D E A T H').substring(0,-logoCount/(10)),width/2,height/2-150);
fill(217, 217, 217);
if(mouseX >width/2-100 && mouseX < width/2+100 && mouseY > height/2-75 && mouseY < height/2-45){
cursor(HAND);
textSize(32);
if(clicked){
logoCount = 0;
transitionTo('select',0.05);
}
}else{
textSize(30);
}
text('New Game',width/2,height/2-50);
if(mouseX >width/2-50 && mouseX < width/2+50 && mouseY > height/2+25 && mouseY < height/2+55){
cursor(HAND);
textSize(32);
if(clicked){
transitionTo('home',0.05);
}
}else{
textSize(30);
}
text('Quit',width/2,height/2+50);
if(mouseX >width/2-100 && mouseX < width/2+100 && mouseY > height/2+125 && mouseY < height/2+155){
cursor(HAND);
textSize(32);
if(clicked){
scene = 'game';
gameSet.spectating = true;
}
}else{
textSize(30);
}
text('Spectate',width/2,height/2+150);
fill(255, 0, 0);
textSize(20);
textAlign(LEFT,BASELINE);
//text('Framerate: '+fr,10,20);
text('Framerate: '+round(this.__frameRate*10)/10,10,20);
clicked = false;
}
break;
}
//println(transition);
doTransition(transition.speed);
if(scene !== 'game' && scene !== 'loading'){
if(scene !== 'death' && scene !== 'pause'){
players = [];
p.enemies = [];
p.health = p.maxHealth;
p.buffs.stun = false;
p.buffs.phaseOut = false;
walls = [];
chunks = [];
if(scene !== 'demo'){
p.vx = 0;
p.vy = 0;
p.que = [];
}
}
noStroke();
fill(0,0,0,logoCount);
if(transition.side === 'left'){

}
rect(-10,-10,width+20,height+20);

}
}
manageKeys();
};




var r = random();
}

			</script>
	
	<script src="https://cdn.jsdelivr.net/gh/vExcess/library_files@main/runPJS_onKA.js"></script>
	<script>
	</script>
</body>

</html>
